<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>使用MicroApp重构旧项目 | Vivien&#39;s Notebook</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/vivien-blog/logo.jpg">
    <meta name="description" content="Vivien个人博客">
    
    <link rel="preload" href="/vivien-blog/assets/css/0.styles.4edee94f.css" as="style"><link rel="preload" href="/vivien-blog/assets/js/app.99027f6f.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/7.ec60f3e8.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/2.6744b811.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/1.4a3363c7.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/24.f74a3560.js" as="script"><link rel="prefetch" href="/vivien-blog/assets/js/10.4c4f923d.js"><link rel="prefetch" href="/vivien-blog/assets/js/100.23f6ee21.js"><link rel="prefetch" href="/vivien-blog/assets/js/101.27280ff0.js"><link rel="prefetch" href="/vivien-blog/assets/js/102.eccf17ff.js"><link rel="prefetch" href="/vivien-blog/assets/js/103.fead0127.js"><link rel="prefetch" href="/vivien-blog/assets/js/104.9f0fb22f.js"><link rel="prefetch" href="/vivien-blog/assets/js/105.4fa50f5b.js"><link rel="prefetch" href="/vivien-blog/assets/js/106.601985f8.js"><link rel="prefetch" href="/vivien-blog/assets/js/107.9ba60431.js"><link rel="prefetch" href="/vivien-blog/assets/js/108.8b7cf753.js"><link rel="prefetch" href="/vivien-blog/assets/js/109.363d2316.js"><link rel="prefetch" href="/vivien-blog/assets/js/11.c96b7ce6.js"><link rel="prefetch" href="/vivien-blog/assets/js/110.cac5d5ac.js"><link rel="prefetch" href="/vivien-blog/assets/js/111.2c304996.js"><link rel="prefetch" href="/vivien-blog/assets/js/112.175b1533.js"><link rel="prefetch" href="/vivien-blog/assets/js/113.7c8ad5fd.js"><link rel="prefetch" href="/vivien-blog/assets/js/114.2919ddce.js"><link rel="prefetch" href="/vivien-blog/assets/js/115.9492e6b7.js"><link rel="prefetch" href="/vivien-blog/assets/js/116.e44be688.js"><link rel="prefetch" href="/vivien-blog/assets/js/117.64b0ae65.js"><link rel="prefetch" href="/vivien-blog/assets/js/118.c2eae998.js"><link rel="prefetch" href="/vivien-blog/assets/js/119.9609a05a.js"><link rel="prefetch" href="/vivien-blog/assets/js/120.88ab75a5.js"><link rel="prefetch" href="/vivien-blog/assets/js/121.285f3ea5.js"><link rel="prefetch" href="/vivien-blog/assets/js/122.2f9265f3.js"><link rel="prefetch" href="/vivien-blog/assets/js/123.b06ae0cb.js"><link rel="prefetch" href="/vivien-blog/assets/js/124.aae0876b.js"><link rel="prefetch" href="/vivien-blog/assets/js/125.e4ce0029.js"><link rel="prefetch" href="/vivien-blog/assets/js/126.9e0257d6.js"><link rel="prefetch" href="/vivien-blog/assets/js/127.258e05ea.js"><link rel="prefetch" href="/vivien-blog/assets/js/128.19174f18.js"><link rel="prefetch" href="/vivien-blog/assets/js/129.a953a1b8.js"><link rel="prefetch" href="/vivien-blog/assets/js/130.eb2cbae9.js"><link rel="prefetch" href="/vivien-blog/assets/js/131.c39fe5fc.js"><link rel="prefetch" href="/vivien-blog/assets/js/132.f6ddde7f.js"><link rel="prefetch" href="/vivien-blog/assets/js/14.4a6f37f5.js"><link rel="prefetch" href="/vivien-blog/assets/js/15.30ff7af8.js"><link rel="prefetch" href="/vivien-blog/assets/js/16.f5bca61b.js"><link rel="prefetch" href="/vivien-blog/assets/js/17.7fea8ba1.js"><link rel="prefetch" href="/vivien-blog/assets/js/18.8a66241c.js"><link rel="prefetch" href="/vivien-blog/assets/js/19.3ba696d4.js"><link rel="prefetch" href="/vivien-blog/assets/js/20.0760a78e.js"><link rel="prefetch" href="/vivien-blog/assets/js/21.53d462a3.js"><link rel="prefetch" href="/vivien-blog/assets/js/22.de88dfed.js"><link rel="prefetch" href="/vivien-blog/assets/js/23.f2b02a6d.js"><link rel="prefetch" href="/vivien-blog/assets/js/25.16232f0b.js"><link rel="prefetch" href="/vivien-blog/assets/js/26.bf9dc0fe.js"><link rel="prefetch" href="/vivien-blog/assets/js/27.3362af75.js"><link rel="prefetch" href="/vivien-blog/assets/js/28.42a6ae8d.js"><link rel="prefetch" href="/vivien-blog/assets/js/29.1dc4d3b7.js"><link rel="prefetch" href="/vivien-blog/assets/js/3.7a6d346e.js"><link rel="prefetch" href="/vivien-blog/assets/js/30.777ec403.js"><link rel="prefetch" href="/vivien-blog/assets/js/31.a10b30c7.js"><link rel="prefetch" href="/vivien-blog/assets/js/32.4c227bf7.js"><link rel="prefetch" href="/vivien-blog/assets/js/33.9873b2e4.js"><link rel="prefetch" href="/vivien-blog/assets/js/34.661b84b0.js"><link rel="prefetch" href="/vivien-blog/assets/js/35.e6dccfdc.js"><link rel="prefetch" href="/vivien-blog/assets/js/36.5b56d9d8.js"><link rel="prefetch" href="/vivien-blog/assets/js/37.1ad4e39f.js"><link rel="prefetch" href="/vivien-blog/assets/js/38.dc9c4a51.js"><link rel="prefetch" href="/vivien-blog/assets/js/39.be23166d.js"><link rel="prefetch" href="/vivien-blog/assets/js/4.6d6477a3.js"><link rel="prefetch" href="/vivien-blog/assets/js/40.e5f670f0.js"><link rel="prefetch" href="/vivien-blog/assets/js/41.236d900a.js"><link rel="prefetch" href="/vivien-blog/assets/js/42.67482f69.js"><link rel="prefetch" href="/vivien-blog/assets/js/43.1de2024a.js"><link rel="prefetch" href="/vivien-blog/assets/js/44.7ddd9470.js"><link rel="prefetch" href="/vivien-blog/assets/js/45.31587bf5.js"><link rel="prefetch" href="/vivien-blog/assets/js/46.f1560a94.js"><link rel="prefetch" href="/vivien-blog/assets/js/47.d3d247b3.js"><link rel="prefetch" href="/vivien-blog/assets/js/48.927b0f38.js"><link rel="prefetch" href="/vivien-blog/assets/js/49.c29054c9.js"><link rel="prefetch" href="/vivien-blog/assets/js/5.8f70aa2d.js"><link rel="prefetch" href="/vivien-blog/assets/js/50.e8d25d24.js"><link rel="prefetch" href="/vivien-blog/assets/js/51.44c4ad27.js"><link rel="prefetch" href="/vivien-blog/assets/js/52.fbef7aa0.js"><link rel="prefetch" href="/vivien-blog/assets/js/53.2b707def.js"><link rel="prefetch" href="/vivien-blog/assets/js/54.b5188815.js"><link rel="prefetch" href="/vivien-blog/assets/js/55.edb5bc12.js"><link rel="prefetch" href="/vivien-blog/assets/js/56.ff6f8345.js"><link rel="prefetch" href="/vivien-blog/assets/js/57.86f43962.js"><link rel="prefetch" href="/vivien-blog/assets/js/58.b4c57804.js"><link rel="prefetch" href="/vivien-blog/assets/js/59.a035b4e8.js"><link rel="prefetch" href="/vivien-blog/assets/js/6.892ce6e5.js"><link rel="prefetch" href="/vivien-blog/assets/js/60.b8bfb276.js"><link rel="prefetch" href="/vivien-blog/assets/js/61.843f60af.js"><link rel="prefetch" href="/vivien-blog/assets/js/62.51cffd1c.js"><link rel="prefetch" href="/vivien-blog/assets/js/63.6925d975.js"><link rel="prefetch" href="/vivien-blog/assets/js/64.48a3a79a.js"><link rel="prefetch" href="/vivien-blog/assets/js/65.b673175b.js"><link rel="prefetch" href="/vivien-blog/assets/js/66.8e9ea32a.js"><link rel="prefetch" href="/vivien-blog/assets/js/67.18095c46.js"><link rel="prefetch" href="/vivien-blog/assets/js/68.f74a0870.js"><link rel="prefetch" href="/vivien-blog/assets/js/69.4e844f29.js"><link rel="prefetch" href="/vivien-blog/assets/js/70.41013b20.js"><link rel="prefetch" href="/vivien-blog/assets/js/71.ec07d484.js"><link rel="prefetch" href="/vivien-blog/assets/js/72.4c1d9149.js"><link rel="prefetch" href="/vivien-blog/assets/js/73.7c820b22.js"><link rel="prefetch" href="/vivien-blog/assets/js/74.776061cd.js"><link rel="prefetch" href="/vivien-blog/assets/js/75.fa80747b.js"><link rel="prefetch" href="/vivien-blog/assets/js/76.a6941a36.js"><link rel="prefetch" href="/vivien-blog/assets/js/77.7a8e0bfc.js"><link rel="prefetch" href="/vivien-blog/assets/js/78.984bfca1.js"><link rel="prefetch" href="/vivien-blog/assets/js/79.ff61e0ac.js"><link rel="prefetch" href="/vivien-blog/assets/js/8.b0ba342b.js"><link rel="prefetch" href="/vivien-blog/assets/js/80.dfa3f211.js"><link rel="prefetch" href="/vivien-blog/assets/js/81.285bac2c.js"><link rel="prefetch" href="/vivien-blog/assets/js/82.f50cbf20.js"><link rel="prefetch" href="/vivien-blog/assets/js/83.b196ace7.js"><link rel="prefetch" href="/vivien-blog/assets/js/84.bfd378d6.js"><link rel="prefetch" href="/vivien-blog/assets/js/85.b9ac818d.js"><link rel="prefetch" href="/vivien-blog/assets/js/86.2ee8cc6a.js"><link rel="prefetch" href="/vivien-blog/assets/js/87.56fa5a36.js"><link rel="prefetch" href="/vivien-blog/assets/js/88.be00769d.js"><link rel="prefetch" href="/vivien-blog/assets/js/89.e1d81528.js"><link rel="prefetch" href="/vivien-blog/assets/js/9.524cff04.js"><link rel="prefetch" href="/vivien-blog/assets/js/90.e5cb233a.js"><link rel="prefetch" href="/vivien-blog/assets/js/91.15feaa5b.js"><link rel="prefetch" href="/vivien-blog/assets/js/92.44aad763.js"><link rel="prefetch" href="/vivien-blog/assets/js/93.45a553ea.js"><link rel="prefetch" href="/vivien-blog/assets/js/94.74a76eb1.js"><link rel="prefetch" href="/vivien-blog/assets/js/95.6314d68a.js"><link rel="prefetch" href="/vivien-blog/assets/js/96.0def9066.js"><link rel="prefetch" href="/vivien-blog/assets/js/97.1010a1a2.js"><link rel="prefetch" href="/vivien-blog/assets/js/98.5dd57b30.js"><link rel="prefetch" href="/vivien-blog/assets/js/99.b01b0c86.js"><link rel="prefetch" href="/vivien-blog/assets/js/vendors~docsearch.da1394aa.js">
    <link rel="stylesheet" href="/vivien-blog/assets/css/0.styles.4edee94f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-222e0b9d><div data-v-222e0b9d><div class="password-shadow password-wrapper-out" style="display:none;" data-v-15719524 data-v-222e0b9d data-v-222e0b9d><h3 class="title" data-v-15719524>Vivien's Notebook</h3> <p class="description" data-v-15719524>Vivien个人博客</p> <label id="box" class="inputBox" data-v-15719524><input type="password" value="" data-v-15719524> <span data-v-15719524>Konck! Knock!</span> <button data-v-15719524>OK</button></label> <div class="footer" data-v-15719524><span data-v-15719524><i class="iconfont reco-theme" data-v-15719524></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-15719524>vuePress-theme-reco</a></span> <span data-v-15719524><i class="iconfont reco-copyright" data-v-15719524></i> <a data-v-15719524><!---->
          
        <!---->
        2025
      </a></span></div></div> <div class="hide" data-v-222e0b9d><header class="navbar" data-v-222e0b9d><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vivien-blog/" class="home-link router-link-active"><img src="/vivien-blog/logo.jpg" alt="Vivien's Notebook" class="logo"> <span class="site-name">Vivien's Notebook</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vivien-blog/base/browser/输入URL到页面展示发生了什么/" class="nav-link"><i class="undefined"></i>
  前端基础
</a></div><div class="nav-item"><a href="/vivien-blog/Vue/Vue3学习笔记/Vue3与Vue2对比/" class="nav-link"><i class="undefined"></i>
  Vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      微前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端基础知识/" class="nav-link"><i class="undefined"></i>
  微前端基础知识
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端解决方案/" class="nav-link"><i class="undefined"></i>
  微前端解决方案
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/使用MicroApp重构旧项目/" class="nav-link"><i class="undefined"></i>
  使用MicroApp重构旧项目
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      前端工程化
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/代码规范/概述/" class="nav-link"><i class="undefined"></i>
  代码规范
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/webpack/webpack执行流程/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/CICD/半自动化部署/" class="nav-link"><i class="undefined"></i>
  CICD
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/渲染架构/前端渲染模式/" class="nav-link"><i class="undefined"></i>
  架构&amp;方案
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      书籍
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/books/深入浅出webpack/为什么要使用webpack/" class="nav-link"><i class="undefined"></i>
  深入浅出webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/ES6入门教程/ES6与JavaScript/" class="nav-link"><i class="undefined"></i>
  ES6入门教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/TypeScript教程/简介和基本用法/" class="nav-link"><i class="undefined"></i>
  TypeScript教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/Vue.js设计与实现/1.权衡的艺术/" class="nav-link"><i class="undefined"></i>
  Vue.js设计与实现
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      项目实践
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/project/权限控制/权限控制基础知识/" class="nav-link"><i class="undefined"></i>
  权限控制
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/project/项目搭建/搭建一个组件库/" class="nav-link"><i class="undefined"></i>
  项目搭建
</a></li></ul></div></div><div class="nav-item"><a href="/vivien-blog/React/React基础知识/" class="nav-link"><i class="undefined"></i>
  React
</a></div><div class="nav-item"><a href="/vivien-blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/vivien-blog/messageBoard/messageBoard.html" class="nav-link"><i class="iconfont reco-message"></i>
  留言板
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      contact Vivien
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/yoguoer" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Vivien_CC" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-222e0b9d></div> <aside class="sidebar" data-v-222e0b9d><div class="personal-info-wrapper" data-v-2710484f data-v-222e0b9d><img src="/vivien-blog/avator.jpg" alt="author-avatar" class="personal-img" data-v-2710484f> <!----> <div class="num" data-v-2710484f><div data-v-2710484f><h3 data-v-2710484f>92</h3> <h6 data-v-2710484f>文章</h6></div> <div data-v-2710484f><h3 data-v-2710484f>11</h3> <h6 data-v-2710484f>标签</h6></div></div> <ul class="social-links" data-v-2710484f><li class="social-item" data-v-2710484f><i class="iconfont reco-github" style="color:#849b87;" data-v-2710484f></i></li></ul> <hr data-v-2710484f></div> <nav class="nav-links"><div class="nav-item"><a href="/vivien-blog/base/browser/输入URL到页面展示发生了什么/" class="nav-link"><i class="undefined"></i>
  前端基础
</a></div><div class="nav-item"><a href="/vivien-blog/Vue/Vue3学习笔记/Vue3与Vue2对比/" class="nav-link"><i class="undefined"></i>
  Vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      微前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端基础知识/" class="nav-link"><i class="undefined"></i>
  微前端基础知识
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端解决方案/" class="nav-link"><i class="undefined"></i>
  微前端解决方案
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/使用MicroApp重构旧项目/" class="nav-link"><i class="undefined"></i>
  使用MicroApp重构旧项目
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      前端工程化
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/代码规范/概述/" class="nav-link"><i class="undefined"></i>
  代码规范
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/webpack/webpack执行流程/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/CICD/半自动化部署/" class="nav-link"><i class="undefined"></i>
  CICD
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/渲染架构/前端渲染模式/" class="nav-link"><i class="undefined"></i>
  架构&amp;方案
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      书籍
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/books/深入浅出webpack/为什么要使用webpack/" class="nav-link"><i class="undefined"></i>
  深入浅出webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/ES6入门教程/ES6与JavaScript/" class="nav-link"><i class="undefined"></i>
  ES6入门教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/TypeScript教程/简介和基本用法/" class="nav-link"><i class="undefined"></i>
  TypeScript教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/Vue.js设计与实现/1.权衡的艺术/" class="nav-link"><i class="undefined"></i>
  Vue.js设计与实现
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      项目实践
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/project/权限控制/权限控制基础知识/" class="nav-link"><i class="undefined"></i>
  权限控制
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/project/项目搭建/搭建一个组件库/" class="nav-link"><i class="undefined"></i>
  项目搭建
</a></li></ul></div></div><div class="nav-item"><a href="/vivien-blog/React/React基础知识/" class="nav-link"><i class="undefined"></i>
  React
</a></div><div class="nav-item"><a href="/vivien-blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/vivien-blog/messageBoard/messageBoard.html" class="nav-link"><i class="iconfont reco-message"></i>
  留言板
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      contact Vivien
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/yoguoer" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Vivien_CC" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>微前端</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vivien-blog/MicroFrontends/微前端基础知识.html" class="sidebar-link">微前端基础知识</a></li><li><a href="/vivien-blog/MicroFrontends/微前端解决方案.html" class="sidebar-link">微前端解决方案</a></li><li><a href="/vivien-blog/MicroFrontends/使用MicroApp重构旧项目.html" class="active sidebar-link">使用MicroApp重构旧项目</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-15719524 data-v-222e0b9d><h3 class="title" data-v-15719524>使用MicroApp重构旧项目</h3> <!----> <label id="box" class="inputBox" data-v-15719524><input type="password" value="" data-v-15719524> <span data-v-15719524>Konck! Knock!</span> <button data-v-15719524>OK</button></label> <div class="footer" data-v-15719524><span data-v-15719524><i class="iconfont reco-theme" data-v-15719524></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-15719524>vuePress-theme-reco</a></span> <span data-v-15719524><i class="iconfont reco-copyright" data-v-15719524></i> <a data-v-15719524><!---->
          
        <!---->
        2025
      </a></span></div></div> <div data-v-222e0b9d><div data-v-222e0b9d><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">使用MicroApp重构旧项目</h1> <div data-v-f31d237c><i class="iconfont reco-account" data-v-f31d237c><span data-v-f31d237c>vivien</span></i> <i class="iconfont reco-date" data-v-f31d237c><span data-v-f31d237c>2024/8/15</span></i> <i class="iconfont reco-eye" data-v-f31d237c><span id="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-f31d237c><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-f31d237c><span class="tag-item" data-v-f31d237c>MicroFrontends</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>​	随着技术的飞速发展，我们公司内部一个基于“上古神器”  jQuery + PHP 构建的十年历史老项目已显力不从心，技术非常老旧且维护成本高昂，其实已经无数次想要重构，但是苦于历史遗留原因以及业务的稳定性而一直难以下手，而且一时半会又不能全部重构。本次新页面较多且后续将持续迭代新模块，而老页面的改动较少且代码库错综复杂，牵一发而动全身。</p> <p>​	经过几番思考，我们发现<strong>微前端是一种非常实用的去实施渐进式重构的架构</strong>，很适合用微前端技术来完成本次需求，最终决定<strong>利用 Vue3 + Vite 搭建一个全新的基座（主应用），作为新旧系统融合的桥梁，将原来的老项目接入到基座，后面的新需求都在新项目里面开发就行，不用再动老项目</strong>。此举不仅实现了新页面用 Vue3 开发，而且老项目也能和新项目融合在一起，既保持了旧系统的稳定运行，又引入了新技术栈的活力。</p> <p>​	同时，鉴于我们另一个 Vue2 + webpack 项目也同样面临技术过时和项目规模庞大的问题，每次开发时运行起来非常卡顿，打包很慢，后期难以维护，也需要用微前端来进行一些拆分，不可能一直往该项目上堆代码。所以，我们决定一步到位，<strong>设计了一套微前端项目模板，将微前端的核心配置抽象为可复用的插件，并结合自研组件库、HTTP请求、权限控制等插件，构建了一个全面的项目脚手架</strong>，旨在简化未来项目的搭建流程，提升开发效率，确保技术栈的先进性与可持续性。</p> <h2 id="微前端框架选型-microapp"><a href="#微前端框架选型-microapp" class="header-anchor">#</a> <strong>微前端框架选型（MicroApp）</strong></h2> <p>​	从对⽐图可以看出，⽬前开源的微前端框架中有的功能 Micro App都有，并提供了⼀些它们不具备的功能，⽐如静态资源地址补全，元素隔离，插件系统等。</p> <p><img src="/vivien-blog/assets/img/51fccedf3ade09b90f53d8e131c42370.052954f2.png" alt="51fccedf3ade09b90f53d8e131c42370"></p> <p>​	我们本次项目使用的是 Vue3+Vite+TypeScript 的技术栈，在综合对比了各个框架之后，认为MicroApp是最适合我们当前现实情况的。原因有下：</p> <ol><li>使用简单，将所有功能都封装到一个类WebComponent组件内，从而实现在基座应用中嵌入一行代码即可渲染一个微前端应用。</li> <li>不需要像 single-spa 和 qiankun 一样要求子应用修改渲染逻辑并暴露出方法，也不需要修改webpack配置，是目前市面上接入微前端成本最低的方案。</li> <li>功能丰富，提供了 js沙箱、样式隔离、元素隔离、预加载、数据通信、静态资源补全等一系列完善的功能。</li> <li>零依赖，这赋予它小巧的体积和更高的扩展性。</li> <li>兼容所有框架，为了保证各个业务之间独立开发、独立部署的能力，micro-app做了诸多兼容，在任何技术框架中都可以正常运行。</li> <li>侵入性低：对原代码几乎没有影响。</li> <li>组件化：基于webComponents思想实现微前端。</li></ol> <h2 id="微前端架构设计-pnpm-monorepo"><a href="#微前端架构设计-pnpm-monorepo" class="header-anchor">#</a> <strong>微前端架构设计</strong>（pnpm+monorepo）</h2> <p>​	使用 pnpm 和 monorepo 管理项目依赖和代码结构，确保所有子应用和基座应用都位于同一仓库的不同目录下，便于集中管理和版本控制。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">/</span>root  
<span class="token operator">|</span><span class="token operator">--</span> <span class="token operator">/</span>packages  
    <span class="token operator">|</span><span class="token operator">--</span> <span class="token operator">/</span>main<span class="token operator">-</span>app        # 基座应用  
    <span class="token operator">|</span><span class="token operator">--</span> <span class="token operator">/</span>old<span class="token operator">-</span>app<span class="token operator">-</span>wrapper # 老项目接入容器  
    <span class="token operator">|</span><span class="token operator">--</span> <span class="token operator">/</span><span class="token keyword">new</span><span class="token operator">-</span>module<span class="token operator">-</span>a    # 新应用<span class="token constant">A</span>  
    <span class="token operator">|</span><span class="token operator">--</span> <span class="token operator">/</span><span class="token keyword">new</span><span class="token operator">-</span>module<span class="token operator">-</span>b    # 新应用<span class="token constant">B</span>  
    <span class="token operator">...</span>  
<span class="token operator">|</span><span class="token operator">--</span> <span class="token operator">/</span>pnpm<span class="token operator">-</span>workspace<span class="token punctuation">.</span>yaml  
<span class="token operator">|</span><span class="token operator">--</span> <span class="token operator">/</span><span class="token keyword">package</span><span class="token punctuation">.</span>json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li><strong>基座应用（Main App）</strong> <ul><li>使用Vue 3 + Vite搭建的基座应用将成为整个系统的核心，负责路由管理、权限验证、资源加载等基础设施功能。基座应用应保持轻量级，避免过度耦合，并提供必要的API和事件系统供子应用使用。</li></ul></li> <li><strong>子应用（Micro Apps）</strong> <ul><li><strong>老项目接入（旧应用容器）</strong>：将老项目（PHP+jQuery）作为一个子应用，确保与基座应用的隔离和独立运行。新建一个项目，用于专门展示老项目页面，先在路由表中给所有路由都添加一个 iframeUrl参数(存的是旧页面的地址)，并封装一个 iframe 组件，在组件中监听路由变化，动态更新Iframe的src，每一次切换路由，就将页面的地址传入 iframe 组件，从而加载出对应的老页面。</li> <li><strong>新模块开发（新应用容器）</strong>：新页面和模块直接在Vue 3项目中开发，利用Vue 3的Composition API、响应式系统等优势，提高开发效率和代码质量。当旧系统中有某个部分要重构时，则将旧项目中的路由下线，并将重构后的模块进行上线，实现无缝替换。</li></ul></li> <li><strong>通信机制</strong> <ul><li><strong>建立基座应用与子应用之间的有效通信机制</strong>，如使用自定义事件、全局状态管理（如Vuex或Zustand）或专门的通信库。</li> <li>自定义事件：基座应用可以监听来自子应用的自定义事件，并作出相应处理。子应用同样可以监听基座应用的事件。</li> <li>全局状态管理：使用Vuex或Zustand等状态管理库，在基座应用中维护全局状态，子应用可以通过API访问或修改这些状态（如果允许）。</li> <li>专门的通信库：如使用single-spa、qiankun等微前端框架提供的API进行通信。</li></ul></li></ul> <h2 id="项目模板与脚手架"><a href="#项目模板与脚手架" class="header-anchor">#</a> <strong>项目模板与脚手架</strong></h2> <ul><li>模板设计：
<ul><li><strong>核心配置插件化</strong>：将微前端的核心配置（如子应用注册、加载策略、生命周期管理等）封装成可复用的插件，便于在不同项目中快速集成。</li> <li><strong>自研组件库</strong>：整合并封装常用的UI组件，提高开发效率和界面一致性。</li> <li><strong>HTTP请求插件</strong>：封装统一的HTTP请求处理逻辑，包括请求拦截、响应处理、错误重试等，简化API调用。</li> <li><strong>权限控制插件</strong>：基于角色或权限的动态路由控制，确保系统的安全性。</li></ul></li> <li>脚手架构建：
<ul><li>使用Vite作为构建工具，利用其快速冷启动和热模块替换特性，提升开发体验。</li> <li>集成ESLint、Prettier等代码质量工具，确保代码风格统一和减少错误。</li> <li>提供一键生成项目结构的脚本，包括基础目录、配置文件、基础路由和页面模板等。</li></ul></li> <li>CICD：
<ul><li>统一的CICD流程为各个子应用和主应用提供统一的构建/部署流程</li></ul></li></ul> <h2 id="微前端设计思路"><a href="#微前端设计思路" class="header-anchor">#</a> 微前端设计思路</h2> <ol><li><p>拆分功能模块：首先，我们需要将整个后台管理系统拆分为多个独立的功能模块，如用户管理模块、专项管理模块、订单管理模块等。每个模块都可以作为一个独立的微应用进行开发和维护。</p></li> <li><p>设计通信协议：为了实现各个微应用之间的通信和资源共享，我们需要设计一套统一的通信协议和API。例如，我们可以定义一个emit方法来触发自定义事件，以及一个on方法来监听自定义事件；我们还可以使用Webpack的CommonsChunkPlugin插件来实现公共资源的提取和共享。</p></li> <li><p>开发主应用：主应用是整个后台管理系统的入口，它负责加载和管理各个微应用。主应用需要提供一个容器元素来承载各个微应用的内容，并提供一些基础设施服务，如路由管理、状态管理等。此外，主应用还需要实现与各个微应用的通信和资源共享。</p></li> <li><p>开发微应用：每个微应用都是一个独立的功能模块，它可以独立开发、部署和运行。每个微应用都需要提供一个容器元素来承载该应用的内容，并提供一些与主应用交互的接口，如共享资源、通信等。此外，微应用还需要实现自身的业务逻辑和界面展示。</p></li> <li><p>集成测试：在完成各个微应用的开发后，我们需要对整个系统进行集成测试，确保各个微应用之间的通信和资源共享正常工作。此外，我们还需要对整个系统的性能、稳定性等进行测试和优化。</p></li></ol> <h2 id="v-micro-app-plugin"><a href="#v-micro-app-plugin" class="header-anchor">#</a> v-micro-app-plugin</h2> <p>​	本文中的微前端项目，使用的是 <code>v-micro-app-plugin</code>插件 ，它是一款基于京东MicroApp框架的微前端插件，旨在帮助开发者快速地将微应用集成到不同的系统中，实现高效、灵活的前端模块化开发。以下是详细的使用指南，希望能够帮助你快速上手。</p> <div class="custom-block danger"><p class="title">资源地址</p><p>​	微前端插件 v-micro-app-plugin 源码地址：[<a href="https://github.com/yoguoer/v-micro-app-plugin" target="_blank" rel="noopener noreferrer">yoguoer/v-micro-app-plugin: v-micro-app-plugin 是一款基于 MicroApp 的微前端插件，实现快速安装使用，无痛搭建微前端项目。 (github.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>](https://github.com/yoguoer/v-micro-app-plugin.git)</p> <p>​	用该插件搭建的的示例项目 vMicroVerseHub 源码地址：[<a href="https://github.com/yoguoer/vMicroVerseHub" target="_blank" rel="noopener noreferrer">yoguoer/vMicroVerseHub: vMicroversehub 是一个使用 v-micro-app-plugin搭建的 monorepo 微前端项目框架，主要用于给出案例，更好地展示插件的功能和用法。 (github.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>](https://github.com/yoguoer/vMicroVerseHub.git)</p> <p>​	npm 包地址：<a href="https://www.npmjs.com/package/v-micro-app-plugin" target="_blank" rel="noopener noreferrer">v-micro-app-plugin - npm (npmjs.com)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div><p>​	该插件暂时放在私有 npm 包中，外部无法获取，但是可以直接将项目中打包后生成的dist文件夹复制下来，放到需要使用的项目中的 node_modules 文件夹下即可。（虽然这并不是一个推荐的做法，因为它绕过了 npm 的包管理和版本控制功能，可能会导致一系列问题，包括版本冲突、难以维护和更新等。）</p> <h2 id="项目实践"><a href="#项目实践" class="header-anchor">#</a> 项目实践</h2> <blockquote><p>​	<strong>技术栈：</strong></p> <ul><li>主应用：Vue3+Vite+TypeScript</li> <li>子应用1（老项目）：用 iframe 挨个嵌入</li> <li>子应用2（新模块）：react / Vue3 ...</li></ul></blockquote> <p>​	本次重构的是一个后台管理系统，最外层是基座，基座不仅是微前端应用集成的一个关键平台，还承载着维护公共资源、管理依赖项以及确立开发规范的重要使命。具体而言，其职责可概括为以下几点：</p> <ol><li>子应用集成，给子应用提供渲染容器</li> <li>权限管理</li> <li>会话管理</li> <li>路由、菜单管理</li> <li>主题管理</li> <li>共享依赖</li> <li>多语言管理（important）</li></ol> <p><img src="/vivien-blog/assets/img/image-20240710185946565.702809e0.png" alt="image-20240710185946565"></p> <p>​	因为micro-app对主应用和子应用的技术栈没有任何要求，所以，我们新建三个项目，my-app（Vue3）、my-app1（React）、my-app2（Vue2）。my-app是整体项目的主应用，也就是基座，my-app1和my-app2都是平级的子应用。</p> <h3 id="搭建微前端基座"><a href="#搭建微前端基座" class="header-anchor">#</a> 搭建微前端基座</h3> <p>1、创建一个项目作为主应用，这个步骤就不赘述了。</p> <blockquote><p>笔者创建了一个主应用叫 main-app，提供一个框架给子应用。</p></blockquote> <p>2、安装 v-micro-app-plugin 微前端插件</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">pnpm</span> i v-micro-app-plugin <span class="token parameter variable">--save</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3、配置并使用</p> <p>​	为了便于后续复用该配置信息（配置路由、菜单、名称等等），我们将 options 参数独立出来，放在 settings 文件夹下的 microAppSetting.ts 文件中。</p> <ul><li>microAppSetting.ts：</li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> env <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">MODE</span>

<span class="token keyword">const</span> microAppUrl <span class="token operator">=</span> <span class="token punctuation">{</span>  
    appFirst<span class="token operator">:</span> <span class="token punctuation">{</span>  
      development<span class="token operator">:</span> <span class="token string">'http://localhost:3000/#/'</span><span class="token punctuation">,</span>  
      test<span class="token operator">:</span> <span class="token string">'https://test.example.com/vivien/appFirst/'</span><span class="token punctuation">,</span>  
      production<span class="token operator">:</span> <span class="token string">'https://www.example.com/vivien/appFirst/'</span>  
    <span class="token punctuation">}</span><span class="token punctuation">,</span>  
    appSecond<span class="token operator">:</span> <span class="token punctuation">{</span>  
      development<span class="token operator">:</span> <span class="token string">'http://localhost:4000/#/'</span><span class="token punctuation">,</span>  
      test<span class="token operator">:</span> <span class="token string">'https://test.example.com/vivien/appSecond/'</span><span class="token punctuation">,</span>  
      production<span class="token operator">:</span> <span class="token string">'https://www.example.com/vivien/appSecond/'</span>  
    <span class="token punctuation">}</span><span class="token punctuation">,</span>  
  <span class="token punctuation">}</span><span class="token punctuation">;</span>  

<span class="token keyword">const</span> microAppSetting <span class="token operator">=</span> <span class="token punctuation">{</span>
    projectName<span class="token operator">:</span> <span class="token string">'mainApp'</span><span class="token punctuation">,</span>
    subAppConfigs<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'appFirst'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'appFirst'</span><span class="token punctuation">,</span>
            url<span class="token operator">:</span> microAppUrl<span class="token punctuation">[</span><span class="token string">'appFirst'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>env<span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string-property property">'appSecond'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'appSecond'</span><span class="token punctuation">,</span>
            url<span class="token operator">:</span> microAppUrl<span class="token punctuation">[</span><span class="token string">'appSecond'</span><span class="token punctuation">]</span><span class="token punctuation">[</span>env<span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    isBaseApp<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 标记当前应用为主应用</span>
    basePath<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token comment">// 打包路径或其他基础路径 </span>
    disableSandbox<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否禁用沙箱</span>
    iframe<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否使用 iframe</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> microAppSetting
<span class="token keyword">export</span> <span class="token punctuation">{</span> microAppUrl <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><ul><li>main.js：</li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> microAppSetting <span class="token keyword">from</span> <span class="token string">'@/settings/microAppSetting'</span>

<span class="token keyword">const</span> options <span class="token operator">=</span> microAppSetting

<span class="token comment">// 初始化微前端插件  </span>
<span class="token keyword">await</span> <span class="token function">initMyMicroApp</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> options<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>**⚠注意：**一定要在 router 和 store 初始化后，才可以使用 initMyMicroApp 进行初始化！！！举个简单的例子：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> <span class="token string">'./style.css'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>y
<span class="token keyword">import</span> <span class="token punctuation">{</span> createPinia <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'pinia'</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router/index'</span>
<span class="token keyword">import</span> ElementPlus <span class="token keyword">from</span> <span class="token string">'element-plus'</span>
<span class="token keyword">import</span> <span class="token string">'element-plus/theme-chalk/index.css'</span>
<span class="token keyword">import</span> initMyMicroApp <span class="token keyword">from</span> <span class="token string">'v-micro-app-plugin'</span>
<span class="token keyword">import</span> microAppSetting <span class="token keyword">from</span> <span class="token string">'@/settings/microAppSetting'</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createPinia</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>ElementPlus<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>

<span class="token comment">// 初始化微前端插件  </span>
<span class="token keyword">const</span> options <span class="token operator">=</span> microAppSetting
<span class="token keyword">await</span> <span class="token function">initMyMicroApp</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> options<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></blockquote> <h3 id="构建子应用"><a href="#构建子应用" class="header-anchor">#</a> 构建子应用</h3> <p>1、创建任意多个项目作为子应用，这个步骤就不赘述了。</p> <blockquote><p>笔者创建了两个子应用，一个叫 sub-app-first，一个叫 sub-app-second。</p></blockquote> <p>2、安装 v-micro-app-plugin 微前端插件</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">pnpm</span> i v-micro-app-plugin <span class="token parameter variable">--save</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3、配置并使用</p> <ul><li>sub-app-first:</li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  projectName<span class="token operator">:</span> <span class="token string">'appFirst'</span><span class="token punctuation">,</span>
  subAppConfigs<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  isBaseApp<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 标记当前应用不为主应用</span>
  basePath<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token comment">// 打包路径或其他基础路径 </span>
  disableSandbox<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否禁用沙箱</span>
  iframe<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否使用 iframe</span>
<span class="token punctuation">}</span>

<span class="token comment">// 初始化微前端插件  </span>
<span class="token keyword">await</span> <span class="token function">initMyMicroApp</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> options<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>sub-app-second:</li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  projectName<span class="token operator">:</span> <span class="token string">'appSecond'</span><span class="token punctuation">,</span>
  subAppConfigs<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  isBaseApp<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 标记当前应用不为主应用</span>
  basePath<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token comment">// 打包路径或其他基础路径 </span>
  disableSandbox<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否禁用沙箱</span>
  iframe<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否使用 iframe</span>
<span class="token punctuation">}</span>

<span class="token comment">// 初始化微前端插件  </span>
<span class="token keyword">await</span> <span class="token function">initMyMicroApp</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> options<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="配置路由信息"><a href="#配置路由信息" class="header-anchor">#</a> 配置路由信息</h3> <p>​	有了主子应用之后，我们就需要<strong>在主应用中</strong>给子应用配置路由信息，这里一共有 2 个子应用，我们为它们分别进行配置。</p> <ul><li>appFirst：</li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> microAppSetting <span class="token keyword">from</span> <span class="token string">'@/settings/microAppSetting'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token string">'/appFirst'</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">'appFirst'</span><span class="token punctuation">,</span>
  component<span class="token operator">:</span> Layout<span class="token punctuation">,</span>
  order<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  hidden<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  meta<span class="token operator">:</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">'appFirst'</span><span class="token punctuation">,</span>
    hideBreadcrumb<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    icon<span class="token operator">:</span> Document<span class="token punctuation">,</span>
    microAppOptions<span class="token operator">:</span> microAppSetting<span class="token punctuation">.</span>subAppConfigs<span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">'appFirst'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>appSecond：</li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> microAppSetting <span class="token keyword">from</span> <span class="token string">'@/settings/microAppSetting'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  path<span class="token operator">:</span> <span class="token string">'/appSecond'</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">'appSecond'</span><span class="token punctuation">,</span>
  component<span class="token operator">:</span> Layout<span class="token punctuation">,</span>
  order<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  hidden<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  
  meta<span class="token operator">:</span> <span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">'appSecond'</span><span class="token punctuation">,</span>
    hideBreadcrumb<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    icon<span class="token operator">:</span> Document<span class="token punctuation">,</span>
    microAppOptions<span class="token operator">:</span> microAppSetting<span class="token punctuation">.</span>subAppConfigs<span class="token operator">!</span><span class="token punctuation">[</span><span class="token string">'appSecond'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="封装-microappcontainer"><a href="#封装-microappcontainer" class="header-anchor">#</a> 封装 MicroAppContainer</h3> <p>​	众所周知，路由切换时，可以给<code>&lt;router-view /&gt;</code>填充上对应路径的内容，同理，microApp中的<code>&lt;micro-app&gt;&lt;/micro-app&gt;</code>也有同样的功能。我们可以对其进行二次封装，结合<code>v-if</code>，以便于根据是路由指向的是子应用，还是本系统自由模块，来判断究竟是渲染微应用视图，还是渲染普通视图。</p> <p>​	为了达到这个目的，我们可以新建一个 MicroAppContainer 文件夹，在其中创建一个<code>index.vue</code>，然后键入以下内容：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div <span class="token operator">:</span><span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;[`${prefixCls}-container`]&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> name：应用名称<span class="token punctuation">,</span> url：应用地址 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>micro<span class="token operator">-</span>app v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;options&quot;</span> <span class="token operator">:</span>name<span class="token operator">=</span><span class="token string">&quot;options.name&quot;</span> keep<span class="token operator">-</span>alive<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>micro<span class="token operator">-</span>app<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">&quot;ts&quot;</span><span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> watch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> props <span class="token operator">=</span> <span class="token generic-function"><span class="token function">defineProps</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token punctuation">{</span>
  options<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> prefixCls <span class="token operator">=</span> props<span class="token punctuation">.</span>options<span class="token punctuation">.</span>name

<span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> props<span class="token punctuation">.</span>options<span class="token punctuation">,</span>
  <span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    prefixCls <span class="token operator">=</span> newValue<span class="token punctuation">.</span>name
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> immediate<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> deep<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>style<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><blockquote><p><strong>⚠注意：</strong></p> <p>keep-alive 属性可根据需要决定是否设置。</p> <p><img src="/vivien-blog/assets/img/image-20240815100055906.94376f96.png" alt="image-20240815100055906"></p></blockquote> <h3 id="区分是否微应用视图"><a href="#区分是否微应用视图" class="header-anchor">#</a> 区分是否微应用视图</h3> <ul><li>在你需要加载子应用页面的地方：</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[`${prefixCls}-viewer-microapp`]<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isMicroAppView<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>MicroAppContainer</span> <span class="token attr-name">:options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>microAppOptions<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>一些必要的逻辑语句：</li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> watchEffect<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRoute <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token keyword">const</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> isMicroAppView<span class="token operator">:</span> Ref <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> microAppOptions<span class="token operator">:</span> Ref <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  microAppOptions<span class="token punctuation">.</span>value <span class="token operator">=</span> route<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>microAppOptions
  isMicroAppView<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">isNullOrUnDef</span><span class="token punctuation">(</span>microAppOptions<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>microAppOptions<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="运行项目"><a href="#运行项目" class="header-anchor">#</a> 运行项目</h3> <p>​	我们可以看到，sub-app-first 和 sub-app-second 均能独立作为一个系统去运行，并且在 main-app 下也能作为一个模块存在。</p> <ul><li>sub-app-first：</li></ul> <p><img src="/vivien-blog/assets/img/image-20240815094842667.a3920f1a.png" alt="image-20240815094842667"></p> <p><img src="/vivien-blog/assets/img/image-20240815095027847.5af0e751.png" alt="image-20240815095027847"></p> <ul><li>sub-app-second：</li></ul> <p><img src="/vivien-blog/assets/img/image-20240815095110589.60a40db0.png" alt="image-20240815095110589"></p> <p><img src="/vivien-blog/assets/img/image-20240815095123085.d9afa0a2.png" alt="image-20240815095123085"></p> <ul><li>main-app：</li></ul> <p><img src="/vivien-blog/assets/img/image-20240815095043447.eb8c297a.png" alt="image-20240815095043447"></p> <p><img src="/vivien-blog/assets/img/image-20240815095249792.c40e340f.png" alt="image-20240815095249792"></p> <ul><li>控制台输出信息：</li></ul> <p><img src="/vivien-blog/assets/img/image-20240815095554572.cf738604.png" alt="image-20240815095554572"></p> <p><img src="/vivien-blog/assets/img/image-20240815095726163.7859c2ec.png" alt="image-20240815095726163"></p> <h3 id="封装-iframe-组件"><a href="#封装-iframe-组件" class="header-anchor">#</a> 封装 Iframe 组件</h3> <p>​	前文已经提到，老页面不需要做任何修改，且牵一发而动全身，只适合直接用 iframe 搬过来，相当于换个皮肤展示就好。但又因页面数量庞大，所以我们选择直接封装一个 iframe 组件，配合路由动态设置其 src 值，实现页面的动态切换。</p> <p>​	在这里，我们专门创建了一个子应用，用于独立地展示该老系统，起到新旧隔离的作用，具体操作步骤如下：</p> <p>1、首先，在 views 中新建一个 iframeViews 文件夹，然后创建 index.vue</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token string">&quot;iframeContainers&quot;</span> v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;loading&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>iframe
      <span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;name&quot;</span>
      <span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">&quot;url&quot;</span>
      height<span class="token operator">=</span><span class="token string">&quot;100%&quot;</span>
      width<span class="token operator">=</span><span class="token string">&quot;100%&quot;</span>
      sandbox<span class="token operator">=</span><span class="token string">&quot;allow-scripts allow-same-origin&quot;</span>
      frameborder<span class="token operator">=</span><span class="token string">&quot;0&quot;</span>
    <span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script setup<span class="token operator">&gt;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> onUnmounted <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useRoute <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>

<span class="token keyword">let</span> route <span class="token operator">=</span> <span class="token function">useRoute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 获取当前路由信息</span>

<span class="token keyword">const</span> iframeContainers <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> name <span class="token operator">=</span>  <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> loading <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>

<span class="token function">onMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">onUnmounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">watch</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> route<span class="token punctuation">,</span>
  <span class="token punctuation">(</span>newRoute<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
    url<span class="token punctuation">.</span>value <span class="token operator">=</span> newRoute<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>iframeUrl
    name<span class="token punctuation">.</span>value <span class="token operator">=</span> newRoute<span class="token punctuation">.</span>name
    <span class="token comment">// console.log('🚀 ~ watch ~ newPath:', newRoute, url.value, name.value)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> immediate<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> deep<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>style scoped<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><p>2、配置路由表</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 用户管理</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Layout <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/router/layout'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> $t <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/plugins/locales/setupLocale&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> User <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@element-plus/icons-vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getIframeUrl <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@/settings/iframeUrlSetting&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">&quot;/user&quot;</span><span class="token punctuation">,</span>
    name<span class="token operator">:</span> <span class="token string">'user'</span><span class="token punctuation">,</span>
    component<span class="token operator">:</span> Layout<span class="token punctuation">,</span>
    order<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    hidden<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    redirect<span class="token operator">:</span> <span class="token string">&quot;userList&quot;</span><span class="token punctuation">,</span>
    meta<span class="token operator">:</span> <span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token function">$t</span><span class="token punctuation">(</span><span class="token string">'用户管理'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        hideBreadcrumb<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        icon<span class="token operator">:</span> User
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    children<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            path<span class="token operator">:</span> <span class="token string">'/userList'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/views/iframeViews/index.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token string">'userList'</span><span class="token punctuation">,</span>
            hidden<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                title<span class="token operator">:</span> <span class="token function">$t</span><span class="token punctuation">(</span><span class="token string">'用户列表'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                iframeUrl<span class="token operator">:</span> <span class="token function">getIframeUrl</span><span class="token punctuation">(</span><span class="token string">'userList'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            path<span class="token operator">:</span> <span class="token string">'/auth'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;@/views/iframeViews/index.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token string">'auth'</span><span class="token punctuation">,</span>
            hidden<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            meta<span class="token operator">:</span> <span class="token punctuation">{</span>
                title<span class="token operator">:</span> <span class="token function">$t</span><span class="token punctuation">(</span><span class="token string">'权限列表'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                iframeUrl<span class="token operator">:</span> <span class="token function">getIframeUrl</span><span class="token punctuation">(</span><span class="token string">'auth'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>3、为了能够在开发、测试、部署环境下都能正常运行，避免跨域问题，我们还需要通过灵活的方式来动态获取 iframeUrl</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> env <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VITE_NODE_ENV</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token punctuation">{</span>
    development<span class="token operator">:</span> <span class="token string">&quot;https://example.com/vivien_test/&quot;</span><span class="token punctuation">,</span>
    production<span class="token operator">:</span> <span class="token string">&quot;https://example.com/vivien_prod/&quot;</span><span class="token punctuation">,</span>
    test<span class="token operator">:</span> <span class="token string">&quot;https://example.tcl.com/vivien_test/&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> iframeUrl <span class="token operator">=</span> <span class="token punctuation">{</span>
    development<span class="token operator">:</span> <span class="token punctuation">{</span>
    	userList<span class="token operator">:</span> <span class="token string">'/vivien/user/index.html'</span><span class="token punctuation">,</span>
        auth<span class="token operator">:</span> <span class="token string">'/vivien/auth/index.html'</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
    production<span class="token operator">:</span> <span class="token punctuation">{</span>
        userList<span class="token operator">:</span> <span class="token string">'/prod/user/index.html'</span><span class="token punctuation">,</span>
        auth<span class="token operator">:</span> <span class="token string">'/prod/auth/index.html'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    test<span class="token operator">:</span> <span class="token punctuation">{</span>
        userList<span class="token operator">:</span> <span class="token string">'/test/user/index.html'</span><span class="token punctuation">,</span>
        auth<span class="token operator">:</span> <span class="token string">'/test/auth/index.html'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 获取iframeUrl</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getIframeUrl</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> url<span class="token punctuation">[</span>env<span class="token punctuation">]</span> <span class="token operator">+</span> iframeUrl<span class="token punctuation">[</span>env<span class="token punctuation">]</span><span class="token punctuation">[</span>name<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h3 id="完成基本功能"><a href="#完成基本功能" class="header-anchor">#</a> 完成基本功能</h3> <p>​	经过这番操作，我们的旧系统就全部都嵌入进来啦！至于新系统，我们就和平常的开发一样，常规操作就可以了。主应用打开的视图如下：</p> <p><img src="/vivien-blog/assets/img/image-20240814190942577.0a78ea45.png" alt="image-20240814190942577"></p> <p>​	不管我们拆分成了多少个项目来开发然后拼接成一个页面，对于用户来说，这完完全全就是一个系统，只是对于开发者来说有区别而已。</p> <h3 id="通信功能"><a href="#通信功能" class="header-anchor">#</a> 通信功能</h3> <p>​	完成了基础功能之后，我们还需要确保应用之间能够相互通信，由于主应用和子应用的通信 API 有一点差别，用的时候容易混淆，不够简便，所以我们对其进行了二次封装，提供了统一的通信 API。</p> <p>​	对于具体的使用方法，我们通过几个简单的例子来说明：</p> <div class="custom-block tip"><p class="title">准备工作</p><p>​	首先，要引入我们的 getMicroAppMessage() 方法，获取一个通信对象</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> getMicroAppMessage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;v-micro-app-plugin&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> microAppMessage <span class="token operator">=</span> <span class="token function">getMicroAppMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div><ul><li>发出全局信息：<code>用法一致</code></li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>  microAppMessage<span class="token punctuation">.</span><span class="token function">sendGlobal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token operator">:</span> <span class="token punctuation">{</span> fun<span class="token operator">:</span> <span class="token string">&quot;sendGlobal&quot;</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">&quot;给全局发送数据~sendGlobal&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;使用sendGlobal发送数据成功，执行回调！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>子应用给主应用发出信息：<code>无需 appName 参数</code></li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>  microAppMessage<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token operator">:</span> <span class="token punctuation">{</span> app<span class="token operator">:</span> <span class="token string">&quot;appSecond&quot;</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token string">&quot;子应用给主应用发送数据~sendMessage&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;子应用使用sendMessage发送数据成功，执行回调！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>主应用给子应用发出信息：<code>需要 appName 参数</code></li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>  microAppMessage<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token operator">:</span> <span class="token punctuation">{</span> app<span class="token operator">:</span> <span class="token string">&quot;mainApp&quot;</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token string">&quot;主应用给appFirst发送数据~sendMessage&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    appName<span class="token operator">:</span> <span class="token string">&quot;appFirst&quot;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;主应用使用sendMessage发送数据成功，执行回调！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>接收全局信息： <code>用法一致</code></li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;接收到的全局信息getGlobalMessage：&quot;</span><span class="token punctuation">,</span> microAppMessage<span class="token punctuation">.</span><span class="token function">getGlobalMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>子应用接收主应用发来的信息：<code>无需 appName 参数</code></li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
      <span class="token string">&quot;子应用接收到主应用发来的非全局信息getMessage：&quot;</span><span class="token punctuation">,</span>
      microAppMessage<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>主应用接收子应用发来的信息：<code>需要 appName 参数</code></li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
      <span class="token string">&quot;主应用收到appFirst发来的信息getMessage：&quot;</span><span class="token punctuation">,</span> microAppMessage<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token string">'appFirst'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token string">&quot;主应用收到appSecond发来的信息getMessage：&quot;</span><span class="token punctuation">,</span> microAppMessage<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token string">'appSecond'</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>控制台信息：</li></ul> <p><img src="/vivien-blog/assets/img/image-20240815101949378.e49fc63c.png" alt="image-20240815101949378"></p> <p><img src="/vivien-blog/assets/img/image-20240815102734720.a5a405b6.png" alt="image-20240815102734720"></p></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2024/9/4 02:14:52</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/vivien-blog/MicroFrontends/微前端解决方案.html" class="prev">
          微前端解决方案
        </a></span> <!----></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-9f22dc18 data-v-222e0b9d><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#前言" class="sidebar-link reco-side-前言" data-v-9f22dc18>前言</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#微前端框架选型-microapp" class="sidebar-link reco-side-微前端框架选型-microapp" data-v-9f22dc18>微前端框架选型（MicroApp）</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#微前端架构设计-pnpm-monorepo" class="sidebar-link reco-side-微前端架构设计-pnpm-monorepo" data-v-9f22dc18>微前端架构设计（pnpm+monorepo）</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#项目模板与脚手架" class="sidebar-link reco-side-项目模板与脚手架" data-v-9f22dc18>项目模板与脚手架</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#微前端设计思路" class="sidebar-link reco-side-微前端设计思路" data-v-9f22dc18>微前端设计思路</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#v-micro-app-plugin" class="sidebar-link reco-side-v-micro-app-plugin" data-v-9f22dc18>v-micro-app-plugin</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#项目实践" class="sidebar-link reco-side-项目实践" data-v-9f22dc18>项目实践</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#搭建微前端基座" class="sidebar-link reco-side-搭建微前端基座" data-v-9f22dc18>搭建微前端基座</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#构建子应用" class="sidebar-link reco-side-构建子应用" data-v-9f22dc18>构建子应用</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#配置路由信息" class="sidebar-link reco-side-配置路由信息" data-v-9f22dc18>配置路由信息</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#封装-microappcontainer" class="sidebar-link reco-side-封装-microappcontainer" data-v-9f22dc18>封装 MicroAppContainer</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#区分是否微应用视图" class="sidebar-link reco-side-区分是否微应用视图" data-v-9f22dc18>区分是否微应用视图</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#运行项目" class="sidebar-link reco-side-运行项目" data-v-9f22dc18>运行项目</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#封装-iframe-组件" class="sidebar-link reco-side-封装-iframe-组件" data-v-9f22dc18>封装 Iframe 组件</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#完成基本功能" class="sidebar-link reco-side-完成基本功能" data-v-9f22dc18>完成基本功能</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/MicroFrontends/%E4%BD%BF%E7%94%A8MicroApp%E9%87%8D%E6%9E%84%E6%97%A7%E9%A1%B9%E7%9B%AE.html#通信功能" class="sidebar-link reco-side-通信功能" data-v-9f22dc18>通信功能</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-2a01419c data-v-2a01419c><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-2a01419c><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-2a01419c></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-2a01419c></path></svg></div></div></div>
    <script src="/vivien-blog/assets/js/app.99027f6f.js" defer></script><script src="/vivien-blog/assets/js/7.ec60f3e8.js" defer></script><script src="/vivien-blog/assets/js/2.6744b811.js" defer></script><script src="/vivien-blog/assets/js/1.4a3363c7.js" defer></script><script src="/vivien-blog/assets/js/24.f74a3560.js" defer></script>
  </body>
</html>
