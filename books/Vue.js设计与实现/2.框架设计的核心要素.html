<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2.框架设计的核心要素 | Vivien&#39;s Notebook</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/vivien-blog/logo.jpg">
    <script src="/vivien-blog/watermark.js"></script>
    <meta name="description" content="Vivien个人博客">
    
    <link rel="preload" href="/vivien-blog/assets/css/0.styles.4edee94f.css" as="style"><link rel="preload" href="/vivien-blog/assets/js/app.6cea8693.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/7.ec60f3e8.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/2.6744b811.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/1.4a3363c7.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/72.be7cf2c3.js" as="script"><link rel="prefetch" href="/vivien-blog/assets/js/10.4c4f923d.js"><link rel="prefetch" href="/vivien-blog/assets/js/100.23f6ee21.js"><link rel="prefetch" href="/vivien-blog/assets/js/101.27280ff0.js"><link rel="prefetch" href="/vivien-blog/assets/js/102.036dcfc2.js"><link rel="prefetch" href="/vivien-blog/assets/js/103.dd57924a.js"><link rel="prefetch" href="/vivien-blog/assets/js/104.c64926ce.js"><link rel="prefetch" href="/vivien-blog/assets/js/105.ae22082c.js"><link rel="prefetch" href="/vivien-blog/assets/js/106.407a6b6f.js"><link rel="prefetch" href="/vivien-blog/assets/js/107.c8a4dfa2.js"><link rel="prefetch" href="/vivien-blog/assets/js/108.9c61cc83.js"><link rel="prefetch" href="/vivien-blog/assets/js/109.c1172022.js"><link rel="prefetch" href="/vivien-blog/assets/js/11.c96b7ce6.js"><link rel="prefetch" href="/vivien-blog/assets/js/110.a8a43b83.js"><link rel="prefetch" href="/vivien-blog/assets/js/111.4c5d72c5.js"><link rel="prefetch" href="/vivien-blog/assets/js/112.31c468c6.js"><link rel="prefetch" href="/vivien-blog/assets/js/113.7c8ad5fd.js"><link rel="prefetch" href="/vivien-blog/assets/js/114.2919ddce.js"><link rel="prefetch" href="/vivien-blog/assets/js/115.9492e6b7.js"><link rel="prefetch" href="/vivien-blog/assets/js/116.da465a8b.js"><link rel="prefetch" href="/vivien-blog/assets/js/117.d5a69554.js"><link rel="prefetch" href="/vivien-blog/assets/js/118.4dae8780.js"><link rel="prefetch" href="/vivien-blog/assets/js/119.e61066ef.js"><link rel="prefetch" href="/vivien-blog/assets/js/120.95523cfb.js"><link rel="prefetch" href="/vivien-blog/assets/js/121.7279e08a.js"><link rel="prefetch" href="/vivien-blog/assets/js/122.1946f5d1.js"><link rel="prefetch" href="/vivien-blog/assets/js/123.1d46e7f2.js"><link rel="prefetch" href="/vivien-blog/assets/js/124.0e99b17d.js"><link rel="prefetch" href="/vivien-blog/assets/js/125.e4ce0029.js"><link rel="prefetch" href="/vivien-blog/assets/js/126.9e0257d6.js"><link rel="prefetch" href="/vivien-blog/assets/js/127.258e05ea.js"><link rel="prefetch" href="/vivien-blog/assets/js/128.19174f18.js"><link rel="prefetch" href="/vivien-blog/assets/js/129.a953a1b8.js"><link rel="prefetch" href="/vivien-blog/assets/js/130.cd9ca58a.js"><link rel="prefetch" href="/vivien-blog/assets/js/131.bf7582dc.js"><link rel="prefetch" href="/vivien-blog/assets/js/132.60d3ae71.js"><link rel="prefetch" href="/vivien-blog/assets/js/14.dac78458.js"><link rel="prefetch" href="/vivien-blog/assets/js/15.30ff7af8.js"><link rel="prefetch" href="/vivien-blog/assets/js/16.f5bca61b.js"><link rel="prefetch" href="/vivien-blog/assets/js/17.7fea8ba1.js"><link rel="prefetch" href="/vivien-blog/assets/js/18.8a66241c.js"><link rel="prefetch" href="/vivien-blog/assets/js/19.9f2773f4.js"><link rel="prefetch" href="/vivien-blog/assets/js/20.7b40b439.js"><link rel="prefetch" href="/vivien-blog/assets/js/21.53d462a3.js"><link rel="prefetch" href="/vivien-blog/assets/js/22.de88dfed.js"><link rel="prefetch" href="/vivien-blog/assets/js/23.f2b02a6d.js"><link rel="prefetch" href="/vivien-blog/assets/js/24.e9a7a488.js"><link rel="prefetch" href="/vivien-blog/assets/js/25.9f932c51.js"><link rel="prefetch" href="/vivien-blog/assets/js/26.bf9dc0fe.js"><link rel="prefetch" href="/vivien-blog/assets/js/27.806995a3.js"><link rel="prefetch" href="/vivien-blog/assets/js/28.42a6ae8d.js"><link rel="prefetch" href="/vivien-blog/assets/js/29.f3069a68.js"><link rel="prefetch" href="/vivien-blog/assets/js/3.7a6d346e.js"><link rel="prefetch" href="/vivien-blog/assets/js/30.a0c45895.js"><link rel="prefetch" href="/vivien-blog/assets/js/31.a10b30c7.js"><link rel="prefetch" href="/vivien-blog/assets/js/32.4c227bf7.js"><link rel="prefetch" href="/vivien-blog/assets/js/33.9873b2e4.js"><link rel="prefetch" href="/vivien-blog/assets/js/34.661b84b0.js"><link rel="prefetch" href="/vivien-blog/assets/js/35.e6dccfdc.js"><link rel="prefetch" href="/vivien-blog/assets/js/36.98205037.js"><link rel="prefetch" href="/vivien-blog/assets/js/37.4a9dc5bf.js"><link rel="prefetch" href="/vivien-blog/assets/js/38.dc9c4a51.js"><link rel="prefetch" href="/vivien-blog/assets/js/39.be23166d.js"><link rel="prefetch" href="/vivien-blog/assets/js/4.6d6477a3.js"><link rel="prefetch" href="/vivien-blog/assets/js/40.e5f670f0.js"><link rel="prefetch" href="/vivien-blog/assets/js/41.236d900a.js"><link rel="prefetch" href="/vivien-blog/assets/js/42.67482f69.js"><link rel="prefetch" href="/vivien-blog/assets/js/43.1de2024a.js"><link rel="prefetch" href="/vivien-blog/assets/js/44.7ddd9470.js"><link rel="prefetch" href="/vivien-blog/assets/js/45.31587bf5.js"><link rel="prefetch" href="/vivien-blog/assets/js/46.8616ff54.js"><link rel="prefetch" href="/vivien-blog/assets/js/47.d3d247b3.js"><link rel="prefetch" href="/vivien-blog/assets/js/48.927b0f38.js"><link rel="prefetch" href="/vivien-blog/assets/js/49.8e7e832e.js"><link rel="prefetch" href="/vivien-blog/assets/js/5.8f70aa2d.js"><link rel="prefetch" href="/vivien-blog/assets/js/50.e8d25d24.js"><link rel="prefetch" href="/vivien-blog/assets/js/51.e8251262.js"><link rel="prefetch" href="/vivien-blog/assets/js/52.fbef7aa0.js"><link rel="prefetch" href="/vivien-blog/assets/js/53.2b707def.js"><link rel="prefetch" href="/vivien-blog/assets/js/54.b5188815.js"><link rel="prefetch" href="/vivien-blog/assets/js/55.8b80c528.js"><link rel="prefetch" href="/vivien-blog/assets/js/56.ff6f8345.js"><link rel="prefetch" href="/vivien-blog/assets/js/57.ddbebf8b.js"><link rel="prefetch" href="/vivien-blog/assets/js/58.b4c57804.js"><link rel="prefetch" href="/vivien-blog/assets/js/59.a035b4e8.js"><link rel="prefetch" href="/vivien-blog/assets/js/6.892ce6e5.js"><link rel="prefetch" href="/vivien-blog/assets/js/60.b8bfb276.js"><link rel="prefetch" href="/vivien-blog/assets/js/61.843f60af.js"><link rel="prefetch" href="/vivien-blog/assets/js/62.51cffd1c.js"><link rel="prefetch" href="/vivien-blog/assets/js/63.91b00a61.js"><link rel="prefetch" href="/vivien-blog/assets/js/64.48a3a79a.js"><link rel="prefetch" href="/vivien-blog/assets/js/65.6c36e44e.js"><link rel="prefetch" href="/vivien-blog/assets/js/66.8e9ea32a.js"><link rel="prefetch" href="/vivien-blog/assets/js/67.18095c46.js"><link rel="prefetch" href="/vivien-blog/assets/js/68.f74a0870.js"><link rel="prefetch" href="/vivien-blog/assets/js/69.4e844f29.js"><link rel="prefetch" href="/vivien-blog/assets/js/70.41013b20.js"><link rel="prefetch" href="/vivien-blog/assets/js/71.26e44e39.js"><link rel="prefetch" href="/vivien-blog/assets/js/73.1808562e.js"><link rel="prefetch" href="/vivien-blog/assets/js/74.d3cdb9ff.js"><link rel="prefetch" href="/vivien-blog/assets/js/75.56b600ce.js"><link rel="prefetch" href="/vivien-blog/assets/js/76.7bc9c5d1.js"><link rel="prefetch" href="/vivien-blog/assets/js/77.7a8e0bfc.js"><link rel="prefetch" href="/vivien-blog/assets/js/78.51f45190.js"><link rel="prefetch" href="/vivien-blog/assets/js/79.ff61e0ac.js"><link rel="prefetch" href="/vivien-blog/assets/js/8.b0ba342b.js"><link rel="prefetch" href="/vivien-blog/assets/js/80.baa5d407.js"><link rel="prefetch" href="/vivien-blog/assets/js/81.285bac2c.js"><link rel="prefetch" href="/vivien-blog/assets/js/82.f50cbf20.js"><link rel="prefetch" href="/vivien-blog/assets/js/83.6440b662.js"><link rel="prefetch" href="/vivien-blog/assets/js/84.bfd378d6.js"><link rel="prefetch" href="/vivien-blog/assets/js/85.563bf7c2.js"><link rel="prefetch" href="/vivien-blog/assets/js/86.3eab528c.js"><link rel="prefetch" href="/vivien-blog/assets/js/87.cc2933f4.js"><link rel="prefetch" href="/vivien-blog/assets/js/88.5ed12de4.js"><link rel="prefetch" href="/vivien-blog/assets/js/89.12e1a1e4.js"><link rel="prefetch" href="/vivien-blog/assets/js/9.524cff04.js"><link rel="prefetch" href="/vivien-blog/assets/js/90.e4e40c40.js"><link rel="prefetch" href="/vivien-blog/assets/js/91.d28d824d.js"><link rel="prefetch" href="/vivien-blog/assets/js/92.88c3e050.js"><link rel="prefetch" href="/vivien-blog/assets/js/93.45a553ea.js"><link rel="prefetch" href="/vivien-blog/assets/js/94.74a76eb1.js"><link rel="prefetch" href="/vivien-blog/assets/js/95.6314d68a.js"><link rel="prefetch" href="/vivien-blog/assets/js/96.0def9066.js"><link rel="prefetch" href="/vivien-blog/assets/js/97.1010a1a2.js"><link rel="prefetch" href="/vivien-blog/assets/js/98.5dd57b30.js"><link rel="prefetch" href="/vivien-blog/assets/js/99.b01b0c86.js"><link rel="prefetch" href="/vivien-blog/assets/js/vendors~docsearch.da1394aa.js">
    <link rel="stylesheet" href="/vivien-blog/assets/css/0.styles.4edee94f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-222e0b9d><div data-v-222e0b9d><div class="password-shadow password-wrapper-out" style="display:none;" data-v-15719524 data-v-222e0b9d data-v-222e0b9d><h3 class="title" data-v-15719524>Vivien's Notebook</h3> <p class="description" data-v-15719524>Vivien个人博客</p> <label id="box" class="inputBox" data-v-15719524><input type="password" value="" data-v-15719524> <span data-v-15719524>Konck! Knock!</span> <button data-v-15719524>OK</button></label> <div class="footer" data-v-15719524><span data-v-15719524><i class="iconfont reco-theme" data-v-15719524></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-15719524>vuePress-theme-reco</a></span> <span data-v-15719524><i class="iconfont reco-copyright" data-v-15719524></i> <a data-v-15719524><!---->
          
        <!---->
        2025
      </a></span></div></div> <div class="hide" data-v-222e0b9d><header class="navbar" data-v-222e0b9d><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vivien-blog/" class="home-link router-link-active"><img src="/vivien-blog/logo.jpg" alt="Vivien's Notebook" class="logo"> <span class="site-name">Vivien's Notebook</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vivien-blog/base/browser/输入URL到页面展示发生了什么/" class="nav-link"><i class="undefined"></i>
  前端基础
</a></div><div class="nav-item"><a href="/vivien-blog/Vue/Vue3学习笔记/Vue3与Vue2对比/" class="nav-link"><i class="undefined"></i>
  Vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      微前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端基础知识/" class="nav-link"><i class="undefined"></i>
  微前端基础知识
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端解决方案/" class="nav-link"><i class="undefined"></i>
  微前端解决方案
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/使用MicroApp重构旧项目/" class="nav-link"><i class="undefined"></i>
  使用MicroApp重构旧项目
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      前端工程化
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/代码规范/概述/" class="nav-link"><i class="undefined"></i>
  代码规范
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/webpack/webpack执行流程/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/CICD/半自动化部署/" class="nav-link"><i class="undefined"></i>
  CICD
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/渲染架构/前端渲染模式/" class="nav-link"><i class="undefined"></i>
  架构&amp;方案
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      书籍
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/books/深入浅出webpack/为什么要使用webpack/" class="nav-link"><i class="undefined"></i>
  深入浅出webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/ES6入门教程/ES6与JavaScript/" class="nav-link"><i class="undefined"></i>
  ES6入门教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/TypeScript教程/简介和基本用法/" class="nav-link"><i class="undefined"></i>
  TypeScript教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/Vue.js设计与实现/1.权衡的艺术/" class="nav-link"><i class="undefined"></i>
  Vue.js设计与实现
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      项目实践
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/project/权限控制/权限控制基础知识/" class="nav-link"><i class="undefined"></i>
  权限控制
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/project/项目搭建/搭建一个组件库/" class="nav-link"><i class="undefined"></i>
  项目搭建
</a></li></ul></div></div><div class="nav-item"><a href="/vivien-blog/React/React基础知识/" class="nav-link"><i class="undefined"></i>
  React
</a></div><div class="nav-item"><a href="/vivien-blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/vivien-blog/messageBoard/messageBoard.html" class="nav-link"><i class="iconfont reco-message"></i>
  留言板
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      contact Vivien
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/yoguoer" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Vivien_CC" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-222e0b9d></div> <aside class="sidebar" data-v-222e0b9d><div class="personal-info-wrapper" data-v-2710484f data-v-222e0b9d><img src="/vivien-blog/avator.jpg" alt="author-avatar" class="personal-img" data-v-2710484f> <!----> <div class="num" data-v-2710484f><div data-v-2710484f><h3 data-v-2710484f>92</h3> <h6 data-v-2710484f>文章</h6></div> <div data-v-2710484f><h3 data-v-2710484f>11</h3> <h6 data-v-2710484f>标签</h6></div></div> <ul class="social-links" data-v-2710484f><li class="social-item" data-v-2710484f><i class="iconfont reco-github" style="color:#f26d6d;" data-v-2710484f></i></li></ul> <hr data-v-2710484f></div> <nav class="nav-links"><div class="nav-item"><a href="/vivien-blog/base/browser/输入URL到页面展示发生了什么/" class="nav-link"><i class="undefined"></i>
  前端基础
</a></div><div class="nav-item"><a href="/vivien-blog/Vue/Vue3学习笔记/Vue3与Vue2对比/" class="nav-link"><i class="undefined"></i>
  Vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      微前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端基础知识/" class="nav-link"><i class="undefined"></i>
  微前端基础知识
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端解决方案/" class="nav-link"><i class="undefined"></i>
  微前端解决方案
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/使用MicroApp重构旧项目/" class="nav-link"><i class="undefined"></i>
  使用MicroApp重构旧项目
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      前端工程化
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/代码规范/概述/" class="nav-link"><i class="undefined"></i>
  代码规范
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/webpack/webpack执行流程/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/CICD/半自动化部署/" class="nav-link"><i class="undefined"></i>
  CICD
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/渲染架构/前端渲染模式/" class="nav-link"><i class="undefined"></i>
  架构&amp;方案
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      书籍
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/books/深入浅出webpack/为什么要使用webpack/" class="nav-link"><i class="undefined"></i>
  深入浅出webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/ES6入门教程/ES6与JavaScript/" class="nav-link"><i class="undefined"></i>
  ES6入门教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/TypeScript教程/简介和基本用法/" class="nav-link"><i class="undefined"></i>
  TypeScript教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/Vue.js设计与实现/1.权衡的艺术/" class="nav-link"><i class="undefined"></i>
  Vue.js设计与实现
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      项目实践
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/project/权限控制/权限控制基础知识/" class="nav-link"><i class="undefined"></i>
  权限控制
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/project/项目搭建/搭建一个组件库/" class="nav-link"><i class="undefined"></i>
  项目搭建
</a></li></ul></div></div><div class="nav-item"><a href="/vivien-blog/React/React基础知识/" class="nav-link"><i class="undefined"></i>
  React
</a></div><div class="nav-item"><a href="/vivien-blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/vivien-blog/messageBoard/messageBoard.html" class="nav-link"><i class="iconfont reco-message"></i>
  留言板
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      contact Vivien
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/yoguoer" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Vivien_CC" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>深入浅出webpack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ES6入门教程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript教程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Vue.js设计与实现</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vivien-blog/books/Vue.js设计与实现/1.权衡的艺术.html" class="sidebar-link">1.权衡的艺术</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/2.框架设计的核心要素.html" class="active sidebar-link">2.框架设计的核心要素</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/3.Vue.js3的设计思路.html" class="sidebar-link">3.Vue.js3的设计思路</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/4.响应系统的作用与实现.html" class="sidebar-link">4.响应系统的作用与实现</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/5.非原始值的响应式方案.html" class="sidebar-link">5.非原始值的响应式方案</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/6.原始值的响应式方案.html" class="sidebar-link">6.原始值的响应式方案</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/7.渲染器的设计.html" class="sidebar-link">7.渲染器的设计</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/8.挂载与更新.html" class="sidebar-link">8.挂载与更新</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/9.简单的Diff算法.html" class="sidebar-link">9.简单的Diff算法</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/10.双端Diff算法.html" class="sidebar-link">10.双端Diff算法</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/11.快速Diff算法.html" class="sidebar-link">11.快速Diff算法</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/12.组件的实现原理.html" class="sidebar-link">12.组件的实现原理</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/13.异步组件和函数式组件.html" class="sidebar-link">13.异步组件和函数式组件</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/14.内建组件和模块.html" class="sidebar-link">14.内建组件和模块</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/15.编译器核心技术概览.html" class="sidebar-link">15.编译器核心技术概览</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/16.解析器.html" class="sidebar-link">16.解析器</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/17.编译优化.html" class="sidebar-link">17.编译优化</a></li><li><a href="/vivien-blog/books/Vue.js设计与实现/18.同构渲染.html" class="sidebar-link">18.同构渲染</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-15719524 data-v-222e0b9d><h3 class="title" data-v-15719524>2.框架设计的核心要素</h3> <!----> <label id="box" class="inputBox" data-v-15719524><input type="password" value="" data-v-15719524> <span data-v-15719524>Konck! Knock!</span> <button data-v-15719524>OK</button></label> <div class="footer" data-v-15719524><span data-v-15719524><i class="iconfont reco-theme" data-v-15719524></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-15719524>vuePress-theme-reco</a></span> <span data-v-15719524><i class="iconfont reco-copyright" data-v-15719524></i> <a data-v-15719524><!---->
          
        <!---->
        2025
      </a></span></div></div> <div data-v-222e0b9d><div data-v-222e0b9d><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">2.框架设计的核心要素</h1> <div data-v-f31d237c><i class="iconfont reco-account" data-v-f31d237c><span data-v-f31d237c>vivien</span></i> <i class="iconfont reco-date" data-v-f31d237c><span data-v-f31d237c>2024/8/20</span></i> <i class="iconfont reco-eye" data-v-f31d237c><span id="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-f31d237c><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-f31d237c><span class="tag-item" data-v-f31d237c>Vue</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="提升用户的开发体验"><a href="#提升用户的开发体验" class="header-anchor">#</a> 提升用户的开发体验</h2> <h3 id="必要的警告信息"><a href="#必要的警告信息" class="header-anchor">#</a> 必要的警告信息</h3> <p>​	在框架设计和开发过程中，<strong>提供友好的警告信息至关重要</strong>。始终提供友好的警告信息不仅能够帮助用户更清晰且快速地定位问题，节省用户的时间，还能够让框架收获良好的口碑，让用户认可框架的专业性。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token function-variable function">mount</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">'Hello world.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#not-exists'</span><span class="token punctuation">)</span> <span class="token comment">// Uncaught TypeError: Cannot read properties of null (reading 'appendChild')</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>根据此信息，我们可能很难去定位问题出在哪里。所以在设计框架时，需要提供更为有用的信息来帮助用户定位问题。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token function-variable function">mount</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>container<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Target selector &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>el<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; returned null.</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  container<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">'Hello world.'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#not-exists'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="直观的输出内容"><a href="#直观的输出内容" class="header-anchor">#</a> 直观的输出内容</h3> <p>在 Vue.js 3 中，当我们在控制台打印一个 Ref 数据时：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> count <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token comment">// RefImpl {__v_isShallow: false, dep: undefined, __v_isRef: true, _rawValue: 0, _value: 0}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这样的数据阅读起来是不友好的。</p> <p>所以在 Vue.js 3 的源码中提供了 <code>initCustomFormatter</code> 的函数用于在开发环境初始化自定义的 formatter。</p> <p>在 Chrome 浏览器中可以通过 <code>设置 -&gt; 控制台 -&gt; 启用自定义格式设置工具</code> 来开启。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> count <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span> <span class="token comment">// Ref&lt;0&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="控制框架代码的体积"><a href="#控制框架代码的体积" class="header-anchor">#</a> 控制框架代码的体积</h2> <p>​	Vue.js 在输出资源的时候，会为开发环境和生产环境输出不同的包，例如<code>vue.global.js</code> 用于开发环境，它包含必要的警告信息，而 <code>vue.global.prod.js</code> 用于生产环境，不包含警告信息。</p> <p>​	在 Vue.js 3 的源码中，通过一些环境常量来决定某些代码只会在特定的环境中生效：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token keyword">if</span> <span class="token punctuation">(</span>__DEV__ <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">warn</span><span class="token punctuation">(</span>
     <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Failed to mount app: mount target selector &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>container<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; returned null.</span><span class="token template-punctuation string">`</span></span>
   <span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>以上代码中， <code>__DEV__</code> 常量实际上是通过 rollup.js 的插件配置来预定义的。</p> <ul><li>当 Vue.js 构建用于<strong>开发</strong>环境的资源时，会把 <code>__DEV__</code> 常量设置为 <code>true</code>，所以，这段代码在开发环境中是<strong>肯定存在</strong>的。</li> <li>当 Vue.js 用于构建<strong>生产</strong>环境的资源时，会把 <code>__DEV__</code> 常量设置为 <code>false</code>，所以，这段代码<strong>永远不会执行</strong>（称为 dead code），在构建资源时会被移除。</li></ul> <p>这样，我们就做到了<strong>在开发环境中为用户提供友好的警告信息的同时，不会增加生产环境代码的体积</strong>。</p> <h2 id="做到良好的-tree-shaking"><a href="#做到良好的-tree-shaking" class="header-anchor">#</a> 做到良好的 Tree-Shaking</h2> <blockquote><p>仅仅通过环境常量的形式来排除 dead code 是不够的，我们还需要 Tree-Shaking。</p></blockquote> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// utils.js</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">foo</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  obj <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span>foo
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">bar</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  obj <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span>bar
<span class="token punctuation">}</span>

<span class="token comment">// input.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'utils'</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><blockquote><p>像上面的这种情况，bar() 并未被使用到，那么它就不应该出现在打包后的代码中。要做到这一点，我们就需要 Tree-Shaking。</p></blockquote> <p>​	Tree-Shaking 指的就是<strong>消除那些永远不会被执行的代码</strong>，也就是排除 dead code，现在无论是 rollup.js 还是 webpack，都支持 Tree-Shaking。</p> <p>​	想要实现 Tree-Shaking，必须满足一个条件，即模块必须是 ESM（ESModule），因为 Tree-Shaking 依赖 ESM 的静态结构。</p> <p>​	<strong>如果一个函数调用会产生副作用</strong>（即调用时会对外部产生影响，例如修改了全局变量），<strong>那么就不能将其移除</strong>。会不会产生副作用，我们只有在代码运行的时候才会知道。JavaScript 本身是动态语言，因此想要静态地分析哪些代码是 dead code 是非常困难的。因此，像 rollup.js 这类工具提供了一个机制，即通过 <code>/*#__PURE__*/</code> 注释，让我们开发明确地告诉构建工具某些代码是不会产生副作用，你可以放心地移除它。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./utils'</span>

<span class="token comment">/*#__PURE__*/</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>在编写框架的时候需要合理<strong>使用 <code>/*#__PURE__*/</code>注释</strong>。注意注释代码 <code>/*#__PURE__*/</code>，其作用就是告诉 rollup.js，对于该代码的调用不会产生副作用，你可以<strong>放心地对其进行 Tree-Shaking</strong>。</p> <p>通常产生副作用的代码都是模块内函数的<strong>顶级调用</strong>，在Vue.js 3 的源码中，基本都是在一些顶级调用的函数上使用 <code>/*#__PURE__*/</code> 注释。</p></blockquote> <h2 id="输出怎样的构建产物"><a href="#输出怎样的构建产物" class="header-anchor">#</a> 输出怎样的构建产物</h2> <p>​	Vue.js 的构建产物除了有环境上的区分之外，还会根据使用场景的不同而输出其他形式的产物。我们需要针对不同的运行环境提供不同的构建产物，通过在 rollup.config.js 中配置。</p> <table><thead><tr><th>类型</th> <th>格式</th> <th>设置</th></tr></thead> <tbody><tr><td>用于<code>&lt;script&gt;</code>标签直接引用</td> <td>IIFE、ESM（<code>-browser</code>）</td> <td><code>format: 'iife'</code></td></tr> <tr><td><code>&lt;script type=&quot;module&quot;&gt;</code><br>提供给打包工具</td> <td>ESM（<code>-bundler</code>）</td> <td><code>format: 'esm'</code></td></tr> <tr><td>用于Node.js中</td> <td>CommonJS</td> <td><code>format: 'cjs'</code></td></tr></tbody></table> <h3 id="用于-script-标签的-esm-资源"><a href="#用于-script-标签的-esm-资源" class="header-anchor">#</a> 用于<code>&lt;script&gt;</code>标签的 ESM 资源</h3> <p>​	不同类型的产物一定有对应的需求背景，因此我们从需求讲起。首先我们希望用户可以直接在 HTML 页面中使用 <code>&lt;script&gt;</code> 标签引入框架并使用：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/path/to/vue.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
   <span class="token keyword">const</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token operator">=</span> Vue
   <span class="token comment">// ...</span>
   </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>​	为了实现这个需求，我们需要输出一种叫作 <strong>IIFE</strong>（Immediately Invoked Function Expression） 格式的资源，即“<strong>立即调用的函数表达式</strong>”：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// ...</span>
 <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>​	实际上，vue.global.js 文件就是 IIFE 形式的资源，它的代码结构如下所示：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token keyword">var</span> Vue <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>exports<span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token comment">// ...</span>
   exports<span class="token punctuation">.</span>createApp <span class="token operator">=</span> createApp<span class="token punctuation">;</span>
   <span class="token comment">// ...</span>
   <span class="token keyword">return</span> exports
 <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>​	这样当我们使用 <code>&lt;script&gt;</code> 标签直接引入 <code>vue.global.js</code> 文件后，全局变量 Vue 就是可用的了。</p> <p>​	在 rollup.js 中，我们可以通过配置 <code>format: 'iife'</code> 来输出这种形式的资源：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token comment">// rollup.config.js</span>
 <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
   input<span class="token operator">:</span> <span class="token string">'input.js'</span><span class="token punctuation">,</span>
   output<span class="token operator">:</span> <span class="token punctuation">{</span>
     file<span class="token operator">:</span> <span class="token string">'output.js'</span><span class="token punctuation">,</span>
     format<span class="token operator">:</span> <span class="token string">'iife'</span> <span class="token comment">// 指定模块形式</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">export</span> <span class="token keyword">default</span> config
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-block tip"><p class="title"></p><p>当构建用于 <code>&lt;script&gt;</code> 标签的 ESM 资源时，如果是用于开发环境，那么 <code>__DEV__</code> 会设置为 true；如果是用于生产环境，那么 <code>__DEV__</code> 常量会设置为 false，从而被 Tree-Shaking 移除。</p></div><h3 id="提供给打包工具的-esm-资源"><a href="#提供给打包工具的-esm-资源" class="header-anchor">#</a> 提供给打包工具的 ESM 资源</h3> <p>​	现在主流浏览器对原生 ESM 的支持都不错，所以用户不仅可以使用 <code>&lt;script&gt;</code> 标签引用 IIFE 格式的资源，还可以直接引入 ESM 格式的资源。为了输出 ESM 格式的资源，<code>rollup.js</code> 的输出格式需要配置为：<code>format: 'esm'</code>。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/path/to/vue.esm-browser.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>无论是 rollup.js 还是 webpack，在寻找资源时，如果 package.json 中存在 module 字段，那么会<strong>优先使用 module 字段指向的资源</strong>来代替 main 字段指向的资源。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 如果项目是使用 webpack 构建的，那么你使用的 Vue.js 资源就是 vue.runtime.esm-bundler.js</span>
<span class="token punctuation">{</span>
   <span class="token string-property property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
   <span class="token string-property property">&quot;module&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dist/vue.runtime.esm-bundler.js&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>也就是说，</p> <p><strong>带有 <code>-bundler</code> 字样</strong>的 ESM 资源是<strong>给 rollup.js 或webpack 等打包工具使用</strong>的，</p> <p>而<strong>带有 <code>-browser</code> 字样</strong>的 ESM 资源是<strong>直接给<code>&lt;script type=&quot;module&quot;&gt;</code> 使用</strong>的。</p></blockquote> <div class="custom-block tip"><p class="title"></p><p>当我们构建提供给打包工具的 ESM格式的资源时，不能直接把 <code>__DEV__</code> 设置为 true 或 false，而要使用<code>(process.env.NODE_ENV !== 'production')</code> 替换 <code>__DEV__</code> 常量。例如下面的源码：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token keyword">if</span> <span class="token punctuation">(</span>__DEV__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">useCssModule() is not supported in the global build.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>在带有 -bundler 字样的资源中会变成：</li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">useCssModule() is not supported in the global build.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>好处：<strong>用户可以通过 webpack 配置自行决定构建资源的目标环境</strong>，但是最终效果其实一样，这段代码也只会出现在开发环境中。</p></div><h3 id="用于node中通过require引用的资源"><a href="#用于node中通过require引用的资源" class="header-anchor">#</a> 用于Node中通过require引用的资源</h3> <div class="language- extra-class"><pre><code>用户除了可以直接使用 `&lt;script&gt;` 标签引入资源外，我们还希望用户可以在Node.js 中通过 require 语句引用资源，例如：	
</code></pre></div><div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token keyword">const</span> Vue <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'vue'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>​	为什么会有这种需求呢？答案是“服务端渲染”。当进行<strong>服务端渲染</strong>时，Vue.js的代码是在 Node.js 环境中运行的，而非浏览器环境。在 Node.js 环境中，资源的模块格式应该是 CommonJS，简称 cjs。为了能够输出 cjs 模块的资源，我们可以通过修改 <code>rollup.config.js</code> 的配置 <code>format: 'cjs'</code> 来实现。</p> <h2 id="特性开关"><a href="#特性开关" class="header-anchor">#</a> 特性开关</h2> <blockquote><p>一个特性对应一个开关，通过开关的形式来决定是否需要某些代码，从而减小资源的体积。</p></blockquote> <ul><li>框架会给用户提供诸多特性（或功能），并<strong>提供对应的开关</strong>，用户可以通过设置 true 或 false 来代表开启或关闭对应的特性（或功能）</li> <li>对于用户<strong>关闭的特性</strong>，我们可以利用 Tree-Shaking 机制让其<strong>不包含</strong>在最终的资源中。</li> <li>可以通过特性开关<strong>任意为框架添加新的特性</strong>，而<strong>不用担心资源体积变大</strong>。当框架升级时，也可以通过特性开关来<strong>支持遗留</strong> API，这样，新用户可以<strong>选择不使用</strong>遗留 API，从而使最终打包的资源体积最小化。</li></ul> <p>​	那怎么实现特性开关呢？原理和上文提到的 <code>__DEV__</code> 常量一样，本质上是利用 rollup.js 的预定义常量插件来实现。例如：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token comment">// support for 2.x options</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span>__FEATURE_OPTIONS_API__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   currentInstance <span class="token operator">=</span> instance
   <span class="token function">pauseTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token function">applyOptions</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> Component<span class="token punctuation">)</span>
   <span class="token function">resetTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   currentInstance <span class="token operator">=</span> <span class="token keyword">null</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>​	当 Vue.js 构建资源时，如果构建的资源是供打包工具使用的（即带有 <code>-bundler</code>字样的资源），那么上面的代码在资源中会变成：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token comment">// support for 2.x options</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span>__VUE_OPTIONS_API__<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 注意这里</span>
   currentInstance <span class="token operator">=</span> instance
   <span class="token function">pauseTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token function">applyOptions</span><span class="token punctuation">(</span>instance<span class="token punctuation">,</span> Component<span class="token punctuation">)</span>
   <span class="token function">resetTracking</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   currentInstance <span class="token operator">=</span> <span class="token keyword">null</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>​	其中 <code>__VUE_OPTIONS_API__</code> 是一个特性开关（是否使用选项 API），用户可以通过设置<code>__VUE_OPTIONS_API__</code> 预定义常量的值来控制是否要包含这段代码。通常用户可以使用 webpack.DefinePlugin 插件来实现：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token comment">// webpack.DefinePlugin 插件配置</span>
 <span class="token keyword">new</span> <span class="token class-name">webpack</span><span class="token punctuation">.</span><span class="token function">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   __VUE_OPTIONS_API__<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// 开启特性，为了兼容Vue.js2，在Vue.js3中仍然可以使用选项API的方式编写代码</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="错误处理"><a href="#错误处理" class="header-anchor">#</a> 错误处理</h2> <blockquote><p>提供统一的错误处理接口，并且让用户可以自行注册错误处理函数来处理错误。</p></blockquote> <p>​	提供了 registerErrorHandler 函数，用户可以使用它注册错误处理程序，然后在 callWithErrorHandling 函数内部捕获错误后，把错误传递给用户注册的错误处理程序。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token comment">// utils.js</span>
 <span class="token keyword">let</span> handleError <span class="token operator">=</span> <span class="token keyword">null</span>
 <span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
   <span class="token function">foo</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token function">callWithErrorHandling</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token comment">// 用户可以调用该函数注册统一的错误处理函数</span>
   <span class="token function">registerErrorHandler</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     handleError <span class="token operator">=</span> fn
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
 <span class="token keyword">function</span> <span class="token function">callWithErrorHandling</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">try</span> <span class="token punctuation">{</span>
     fn <span class="token operator">&amp;&amp;</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token comment">// 将捕获到的错误传递给用户的错误处理程序</span>
     <span class="token function">handleError</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>这样用户侧的代码就会非常简洁且健壮，这时错误处理的能力完全由用户控制，用户既可以选择忽略错误，也可以调用上报程序将错误上报给监控系统。</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token keyword">import</span> utils <span class="token keyword">from</span> <span class="token string">'utils.js'</span>
 <span class="token comment">// 注册错误处理程序</span>
 utils<span class="token punctuation">.</span><span class="token function">registerErrorHandler</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">)</span>
 utils<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
 utils<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/*...*/</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>实际上，这就是 Vue.js 错误处理的原理，我们可以在源码中搜索到callWithErrorHandling 函数。在 Vue.js 中，我们也可以注册统一的错误处理函数：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code> <span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'App.vue'</span>
 <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
 app<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function-variable function">errorHandler</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
   <span class="token comment">// 错误处理程序</span>
 <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="良好的-typescript-类型支持"><a href="#良好的-typescript-类型支持" class="header-anchor">#</a> 良好的 TypeScript 类型支持</h2> <p>​	TypeScript 是 JavaScript 的超集，使用 TS 的好处有很多，如代码即文档、编辑器自动提示、一定程度上能够避免低级 bug、代码的可维护性更强等。</p> <p>​	使用 TS 编写代码与对 TS 类型支持友好是两码事。并不是说使用 TS 编写框架，就等价于对 TS 类型支持友好。</p> <ul><li>使用 TS 编写的函数：<code>推导不出，依然是 any</code></li></ul> <p><img src="/vivien-blog/assets/img/image-20240820203512482.fb5d5479.png" alt="使用TS编写的函数"></p> <ul><li>TS 类型支持友好：<code>能够推导出返回值类型</code></li></ul> <p><img src="/vivien-blog/assets/img/image-20240820204055250.6f1ae5fa.png" alt="TS类型支持友好"></p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <ul><li><p>提供友好的警告信息至关重要，这有助于开发者快速定位问题，因为大多数情况下“框架”要比开发者更清楚问题出在哪里，因此在框架层面抛出有意义的警告信息是非常必要的。</p></li> <li><p>但提供的警告信息越详细，就意味着框架体积越大。我们需要利用 Tree-Shaking 机制，配合构建工具预定义常量的能力，例如预定义 <code>__DEV__</code> 常量，从而实现仅在开发环境中打印警告信息，而生产环境中则不包含这些用于提升开发体验的代码，从而实现线上代码体积的可控性。</p></li> <li><p>对于用户可能用不到的能力，我们可以利用 Tree-Shaking 机制使最终打包的代码体积最小化。但Tree-Shaking 本身基于 ESM，并且 JavaScript 是一门动态语言，通过纯静态分析的手段进行 Tree-Shaking 难度较大，因此大部分工具能够识别<code>/*#__PURE__*/</code> 注释，通过可以利用它来辅助构建工具进行 Tree-Shaking。</p></li> <li><p>不同类型的产物是为了满足不同的需求。</p> <p>①为了让用户能够通过 <code>&lt;script&gt;</code> 标签直接引用并使用，我们需要输出 IIFE 格式的资源，即立即调用的函数表达式。</p> <p>②为了让用户能够通过<code>&lt;script type=&quot;module&quot;&gt;</code> 引用并使用，我们需要输出 ESM 格式的资源。</p> <blockquote><p>ESM 格式的资源有两种：用于浏览器的 esm-browser.js 和用于打包工具的 esm-bundler.js。它们的区别在于对预定义常量 <code>__DEV__</code> 的处理，前者直接将 <code>__DEV__</code> 常量替换为字面量 true或 false，后者则将 <code>__DEV__</code> 常量替换为 <code>process.env.NODE_ENV !=='production'</code> 语句。</p></blockquote> <p>③为了支持服务端渲染，我们需要输出 CommonJS 格式的资源。</p></li> <li><p>框架会提供多种能力或功能。有时出于灵活性和兼容性的考虑，对于同样的任务，框架提供了两种解决方案，用户可以通过特性开关关闭对应的特性，这样在打包的时候，用于实现关闭功能的代码将会被 Tree-Shaking 机制排除。</p></li> <li><p>框架需要为用户提供统一的错误处理接口，这样用户可以通过注册自定义的错误处理函数来处理全部的框架异常。</p></li> <li><p>使用 TS 编写框架和框架对 TS 类型支持友好是两件完全不同的事。有时候为了让框架提供更加友好的类型支持，甚至要花费比实现框架功能本身更多的时间和精力。</p></li></ul></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2024/9/10 02:14:23</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/vivien-blog/books/Vue.js设计与实现/1.权衡的艺术.html" class="prev">
          1.权衡的艺术
        </a></span> <span class="next"><a href="/vivien-blog/books/Vue.js设计与实现/3.Vue.js3的设计思路.html">
          3.Vue.js3的设计思路
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-9f22dc18 data-v-222e0b9d><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#提升用户的开发体验" class="sidebar-link reco-side-提升用户的开发体验" data-v-9f22dc18>提升用户的开发体验</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#必要的警告信息" class="sidebar-link reco-side-必要的警告信息" data-v-9f22dc18>必要的警告信息</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#直观的输出内容" class="sidebar-link reco-side-直观的输出内容" data-v-9f22dc18>直观的输出内容</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#控制框架代码的体积" class="sidebar-link reco-side-控制框架代码的体积" data-v-9f22dc18>控制框架代码的体积</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#做到良好的-tree-shaking" class="sidebar-link reco-side-做到良好的-tree-shaking" data-v-9f22dc18>做到良好的 Tree-Shaking</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#输出怎样的构建产物" class="sidebar-link reco-side-输出怎样的构建产物" data-v-9f22dc18>输出怎样的构建产物</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#用于-script-标签的-esm-资源" class="sidebar-link reco-side-用于-script-标签的-esm-资源" data-v-9f22dc18>用于&lt;script&gt;标签的 ESM 资源</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#提供给打包工具的-esm-资源" class="sidebar-link reco-side-提供给打包工具的-esm-资源" data-v-9f22dc18>提供给打包工具的 ESM 资源</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#用于node中通过require引用的资源" class="sidebar-link reco-side-用于node中通过require引用的资源" data-v-9f22dc18>用于Node中通过require引用的资源</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#特性开关" class="sidebar-link reco-side-特性开关" data-v-9f22dc18>特性开关</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#错误处理" class="sidebar-link reco-side-错误处理" data-v-9f22dc18>错误处理</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#良好的-typescript-类型支持" class="sidebar-link reco-side-良好的-typescript-类型支持" data-v-9f22dc18>良好的 TypeScript 类型支持</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/Vue.js%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/2.%E6%A1%86%E6%9E%B6%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0.html#总结" class="sidebar-link reco-side-总结" data-v-9f22dc18>总结</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-2a01419c data-v-2a01419c><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-2a01419c><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-2a01419c></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-2a01419c></path></svg></div></div></div>
    <script src="/vivien-blog/assets/js/app.6cea8693.js" defer></script><script src="/vivien-blog/assets/js/7.ec60f3e8.js" defer></script><script src="/vivien-blog/assets/js/2.6744b811.js" defer></script><script src="/vivien-blog/assets/js/1.4a3363c7.js" defer></script><script src="/vivien-blog/assets/js/72.be7cf2c3.js" defer></script>
  </body>
</html>
