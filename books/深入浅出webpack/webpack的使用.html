<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack的使用 | Vivien&#39;s Notebook</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/vivien-blog/logo.jpg">
    <meta name="description" content="Vivien个人博客">
    
    <link rel="preload" href="/vivien-blog/assets/css/0.styles.4edee94f.css" as="style"><link rel="preload" href="/vivien-blog/assets/js/app.53ebd2d0.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/7.210383a7.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/2.00d63d32.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/1.96251043.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/64.edfb07df.js" as="script"><link rel="prefetch" href="/vivien-blog/assets/js/10.fa80c4ef.js"><link rel="prefetch" href="/vivien-blog/assets/js/100.41032ce5.js"><link rel="prefetch" href="/vivien-blog/assets/js/101.9c916a3d.js"><link rel="prefetch" href="/vivien-blog/assets/js/102.e062560e.js"><link rel="prefetch" href="/vivien-blog/assets/js/103.465d6c9c.js"><link rel="prefetch" href="/vivien-blog/assets/js/104.a5064b11.js"><link rel="prefetch" href="/vivien-blog/assets/js/105.3f268d1b.js"><link rel="prefetch" href="/vivien-blog/assets/js/106.74c9dc75.js"><link rel="prefetch" href="/vivien-blog/assets/js/107.e79c5082.js"><link rel="prefetch" href="/vivien-blog/assets/js/108.10f05d28.js"><link rel="prefetch" href="/vivien-blog/assets/js/109.21199ecd.js"><link rel="prefetch" href="/vivien-blog/assets/js/11.45f08108.js"><link rel="prefetch" href="/vivien-blog/assets/js/110.924d7e6b.js"><link rel="prefetch" href="/vivien-blog/assets/js/111.faf99e7a.js"><link rel="prefetch" href="/vivien-blog/assets/js/112.1dffe959.js"><link rel="prefetch" href="/vivien-blog/assets/js/113.8947f368.js"><link rel="prefetch" href="/vivien-blog/assets/js/114.5575b028.js"><link rel="prefetch" href="/vivien-blog/assets/js/115.46fe5f3e.js"><link rel="prefetch" href="/vivien-blog/assets/js/116.3cc1d943.js"><link rel="prefetch" href="/vivien-blog/assets/js/117.bfcf9a4a.js"><link rel="prefetch" href="/vivien-blog/assets/js/118.cdb5838e.js"><link rel="prefetch" href="/vivien-blog/assets/js/119.3ca060db.js"><link rel="prefetch" href="/vivien-blog/assets/js/120.603b179b.js"><link rel="prefetch" href="/vivien-blog/assets/js/121.4a65b3a4.js"><link rel="prefetch" href="/vivien-blog/assets/js/122.dc7c1a3a.js"><link rel="prefetch" href="/vivien-blog/assets/js/123.6fbbae70.js"><link rel="prefetch" href="/vivien-blog/assets/js/124.85f8573c.js"><link rel="prefetch" href="/vivien-blog/assets/js/125.3f4470f9.js"><link rel="prefetch" href="/vivien-blog/assets/js/126.da2804d5.js"><link rel="prefetch" href="/vivien-blog/assets/js/127.4ea0fc68.js"><link rel="prefetch" href="/vivien-blog/assets/js/128.472c6d70.js"><link rel="prefetch" href="/vivien-blog/assets/js/129.1161b953.js"><link rel="prefetch" href="/vivien-blog/assets/js/130.e3ebac62.js"><link rel="prefetch" href="/vivien-blog/assets/js/131.5751da2d.js"><link rel="prefetch" href="/vivien-blog/assets/js/132.4990bc90.js"><link rel="prefetch" href="/vivien-blog/assets/js/14.8fe85da8.js"><link rel="prefetch" href="/vivien-blog/assets/js/15.3131a535.js"><link rel="prefetch" href="/vivien-blog/assets/js/16.0070499d.js"><link rel="prefetch" href="/vivien-blog/assets/js/17.c4515dab.js"><link rel="prefetch" href="/vivien-blog/assets/js/18.257845bf.js"><link rel="prefetch" href="/vivien-blog/assets/js/19.80c102ef.js"><link rel="prefetch" href="/vivien-blog/assets/js/20.2b78d1e7.js"><link rel="prefetch" href="/vivien-blog/assets/js/21.34780a5f.js"><link rel="prefetch" href="/vivien-blog/assets/js/22.54e6219c.js"><link rel="prefetch" href="/vivien-blog/assets/js/23.409fd3e4.js"><link rel="prefetch" href="/vivien-blog/assets/js/24.218f744c.js"><link rel="prefetch" href="/vivien-blog/assets/js/25.21fac10f.js"><link rel="prefetch" href="/vivien-blog/assets/js/26.c590614b.js"><link rel="prefetch" href="/vivien-blog/assets/js/27.09d3b30a.js"><link rel="prefetch" href="/vivien-blog/assets/js/28.cafe5f37.js"><link rel="prefetch" href="/vivien-blog/assets/js/29.89bdb3ca.js"><link rel="prefetch" href="/vivien-blog/assets/js/3.934f6b75.js"><link rel="prefetch" href="/vivien-blog/assets/js/30.4db2e018.js"><link rel="prefetch" href="/vivien-blog/assets/js/31.e6e61ee0.js"><link rel="prefetch" href="/vivien-blog/assets/js/32.c193bc49.js"><link rel="prefetch" href="/vivien-blog/assets/js/33.03974196.js"><link rel="prefetch" href="/vivien-blog/assets/js/34.7e51c94f.js"><link rel="prefetch" href="/vivien-blog/assets/js/35.1da6c0eb.js"><link rel="prefetch" href="/vivien-blog/assets/js/36.534ed05f.js"><link rel="prefetch" href="/vivien-blog/assets/js/37.1ab994fa.js"><link rel="prefetch" href="/vivien-blog/assets/js/38.20dcb46a.js"><link rel="prefetch" href="/vivien-blog/assets/js/39.ab72969e.js"><link rel="prefetch" href="/vivien-blog/assets/js/4.35261d9d.js"><link rel="prefetch" href="/vivien-blog/assets/js/40.d1f877b5.js"><link rel="prefetch" href="/vivien-blog/assets/js/41.58cf6028.js"><link rel="prefetch" href="/vivien-blog/assets/js/42.1056cd44.js"><link rel="prefetch" href="/vivien-blog/assets/js/43.d32266a5.js"><link rel="prefetch" href="/vivien-blog/assets/js/44.652b8114.js"><link rel="prefetch" href="/vivien-blog/assets/js/45.1deb9d35.js"><link rel="prefetch" href="/vivien-blog/assets/js/46.e4990ff5.js"><link rel="prefetch" href="/vivien-blog/assets/js/47.0b0a59ff.js"><link rel="prefetch" href="/vivien-blog/assets/js/48.b394b7e1.js"><link rel="prefetch" href="/vivien-blog/assets/js/49.98ce64cd.js"><link rel="prefetch" href="/vivien-blog/assets/js/5.fa969ab7.js"><link rel="prefetch" href="/vivien-blog/assets/js/50.3676a039.js"><link rel="prefetch" href="/vivien-blog/assets/js/51.7d5007eb.js"><link rel="prefetch" href="/vivien-blog/assets/js/52.367c13c1.js"><link rel="prefetch" href="/vivien-blog/assets/js/53.6ba2484d.js"><link rel="prefetch" href="/vivien-blog/assets/js/54.79c13815.js"><link rel="prefetch" href="/vivien-blog/assets/js/55.f3f3c0c9.js"><link rel="prefetch" href="/vivien-blog/assets/js/56.be28d23f.js"><link rel="prefetch" href="/vivien-blog/assets/js/57.fed4f4eb.js"><link rel="prefetch" href="/vivien-blog/assets/js/58.1adffeaa.js"><link rel="prefetch" href="/vivien-blog/assets/js/59.76b72040.js"><link rel="prefetch" href="/vivien-blog/assets/js/6.28daaf49.js"><link rel="prefetch" href="/vivien-blog/assets/js/60.7333cd13.js"><link rel="prefetch" href="/vivien-blog/assets/js/61.c0ec386a.js"><link rel="prefetch" href="/vivien-blog/assets/js/62.47dd6986.js"><link rel="prefetch" href="/vivien-blog/assets/js/63.e9d992b8.js"><link rel="prefetch" href="/vivien-blog/assets/js/65.defded04.js"><link rel="prefetch" href="/vivien-blog/assets/js/66.f8cbb551.js"><link rel="prefetch" href="/vivien-blog/assets/js/67.6cc4496a.js"><link rel="prefetch" href="/vivien-blog/assets/js/68.91f8578c.js"><link rel="prefetch" href="/vivien-blog/assets/js/69.2a8f1cef.js"><link rel="prefetch" href="/vivien-blog/assets/js/70.505daec4.js"><link rel="prefetch" href="/vivien-blog/assets/js/71.4e44c1e8.js"><link rel="prefetch" href="/vivien-blog/assets/js/72.beb08369.js"><link rel="prefetch" href="/vivien-blog/assets/js/73.dd326c8d.js"><link rel="prefetch" href="/vivien-blog/assets/js/74.b0ffe6f1.js"><link rel="prefetch" href="/vivien-blog/assets/js/75.3ac318cb.js"><link rel="prefetch" href="/vivien-blog/assets/js/76.6038c49d.js"><link rel="prefetch" href="/vivien-blog/assets/js/77.c915f3b7.js"><link rel="prefetch" href="/vivien-blog/assets/js/78.de800dca.js"><link rel="prefetch" href="/vivien-blog/assets/js/79.6ac0d041.js"><link rel="prefetch" href="/vivien-blog/assets/js/8.cbde96fb.js"><link rel="prefetch" href="/vivien-blog/assets/js/80.ec48168c.js"><link rel="prefetch" href="/vivien-blog/assets/js/81.e08c5684.js"><link rel="prefetch" href="/vivien-blog/assets/js/82.63f5d182.js"><link rel="prefetch" href="/vivien-blog/assets/js/83.21e0a711.js"><link rel="prefetch" href="/vivien-blog/assets/js/84.b5c1d497.js"><link rel="prefetch" href="/vivien-blog/assets/js/85.a2ceb179.js"><link rel="prefetch" href="/vivien-blog/assets/js/86.e78513ee.js"><link rel="prefetch" href="/vivien-blog/assets/js/87.c9727cdd.js"><link rel="prefetch" href="/vivien-blog/assets/js/88.c196b5da.js"><link rel="prefetch" href="/vivien-blog/assets/js/89.16f98fea.js"><link rel="prefetch" href="/vivien-blog/assets/js/9.09f385e1.js"><link rel="prefetch" href="/vivien-blog/assets/js/90.985bae34.js"><link rel="prefetch" href="/vivien-blog/assets/js/91.d50d4f70.js"><link rel="prefetch" href="/vivien-blog/assets/js/92.fac1f370.js"><link rel="prefetch" href="/vivien-blog/assets/js/93.60d98023.js"><link rel="prefetch" href="/vivien-blog/assets/js/94.48a74e5c.js"><link rel="prefetch" href="/vivien-blog/assets/js/95.dffc87ad.js"><link rel="prefetch" href="/vivien-blog/assets/js/96.f7fa7750.js"><link rel="prefetch" href="/vivien-blog/assets/js/97.ae7a0b65.js"><link rel="prefetch" href="/vivien-blog/assets/js/98.4b671af5.js"><link rel="prefetch" href="/vivien-blog/assets/js/99.3f6c0dd2.js"><link rel="prefetch" href="/vivien-blog/assets/js/vendors~docsearch.36c01082.js">
    <link rel="stylesheet" href="/vivien-blog/assets/css/0.styles.4edee94f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-222e0b9d><div data-v-222e0b9d><div class="password-shadow password-wrapper-out" style="display:none;" data-v-15719524 data-v-222e0b9d data-v-222e0b9d><h3 class="title" data-v-15719524>Vivien's Notebook</h3> <p class="description" data-v-15719524>Vivien个人博客</p> <label id="box" class="inputBox" data-v-15719524><input type="password" value="" data-v-15719524> <span data-v-15719524>Konck! Knock!</span> <button data-v-15719524>OK</button></label> <div class="footer" data-v-15719524><span data-v-15719524><i class="iconfont reco-theme" data-v-15719524></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-15719524>vuePress-theme-reco</a></span> <span data-v-15719524><i class="iconfont reco-copyright" data-v-15719524></i> <a data-v-15719524><!---->
          
        <!---->
        2025
      </a></span></div></div> <div class="hide" data-v-222e0b9d><header class="navbar" data-v-222e0b9d><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vivien-blog/" class="home-link router-link-active"><img src="/vivien-blog/logo.jpg" alt="Vivien's Notebook" class="logo"> <span class="site-name">Vivien's Notebook</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vivien-blog/base/browser/输入URL到页面展示发生了什么/" class="nav-link"><i class="undefined"></i>
  前端基础
</a></div><div class="nav-item"><a href="/vivien-blog/Vue/Vue3学习笔记/Vue3与Vue2对比/" class="nav-link"><i class="undefined"></i>
  Vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      微前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端基础知识/" class="nav-link"><i class="undefined"></i>
  微前端基础知识
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端解决方案/" class="nav-link"><i class="undefined"></i>
  微前端解决方案
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/使用MicroApp重构旧项目/" class="nav-link"><i class="undefined"></i>
  使用MicroApp重构旧项目
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      前端工程化
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/代码规范/概述/" class="nav-link"><i class="undefined"></i>
  代码规范
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/webpack/webpack执行流程/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/CICD/半自动化部署/" class="nav-link"><i class="undefined"></i>
  CICD
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/渲染架构/前端渲染模式/" class="nav-link"><i class="undefined"></i>
  架构&amp;方案
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      书籍
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/books/深入浅出webpack/为什么要使用webpack/" class="nav-link"><i class="undefined"></i>
  深入浅出webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/ES6入门教程/ES6与JavaScript/" class="nav-link"><i class="undefined"></i>
  ES6入门教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/TypeScript教程/简介和基本用法/" class="nav-link"><i class="undefined"></i>
  TypeScript教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/Vue.js设计与实现/1.权衡的艺术/" class="nav-link"><i class="undefined"></i>
  Vue.js设计与实现
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      项目实践
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/project/权限控制/权限控制基础知识/" class="nav-link"><i class="undefined"></i>
  权限控制
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/project/项目搭建/搭建一个组件库/" class="nav-link"><i class="undefined"></i>
  项目搭建
</a></li></ul></div></div><div class="nav-item"><a href="/vivien-blog/React/React基础知识/" class="nav-link"><i class="undefined"></i>
  React
</a></div><div class="nav-item"><a href="/vivien-blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/vivien-blog/messageBoard/messageBoard.html" class="nav-link"><i class="iconfont reco-message"></i>
  留言板
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      contact Vivien
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/yoguoer" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Vivien_CC" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-222e0b9d></div> <aside class="sidebar" data-v-222e0b9d><div class="personal-info-wrapper" data-v-2710484f data-v-222e0b9d><img src="/vivien-blog/avator.jpg" alt="author-avatar" class="personal-img" data-v-2710484f> <!----> <div class="num" data-v-2710484f><div data-v-2710484f><h3 data-v-2710484f>92</h3> <h6 data-v-2710484f>文章</h6></div> <div data-v-2710484f><h3 data-v-2710484f>11</h3> <h6 data-v-2710484f>标签</h6></div></div> <ul class="social-links" data-v-2710484f><li class="social-item" data-v-2710484f><i class="iconfont reco-github" style="color:#e15b64;" data-v-2710484f></i></li></ul> <hr data-v-2710484f></div> <nav class="nav-links"><div class="nav-item"><a href="/vivien-blog/base/browser/输入URL到页面展示发生了什么/" class="nav-link"><i class="undefined"></i>
  前端基础
</a></div><div class="nav-item"><a href="/vivien-blog/Vue/Vue3学习笔记/Vue3与Vue2对比/" class="nav-link"><i class="undefined"></i>
  Vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      微前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端基础知识/" class="nav-link"><i class="undefined"></i>
  微前端基础知识
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端解决方案/" class="nav-link"><i class="undefined"></i>
  微前端解决方案
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/使用MicroApp重构旧项目/" class="nav-link"><i class="undefined"></i>
  使用MicroApp重构旧项目
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      前端工程化
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/代码规范/概述/" class="nav-link"><i class="undefined"></i>
  代码规范
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/webpack/webpack执行流程/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/CICD/半自动化部署/" class="nav-link"><i class="undefined"></i>
  CICD
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/渲染架构/前端渲染模式/" class="nav-link"><i class="undefined"></i>
  架构&amp;方案
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      书籍
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/books/深入浅出webpack/为什么要使用webpack/" class="nav-link"><i class="undefined"></i>
  深入浅出webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/ES6入门教程/ES6与JavaScript/" class="nav-link"><i class="undefined"></i>
  ES6入门教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/TypeScript教程/简介和基本用法/" class="nav-link"><i class="undefined"></i>
  TypeScript教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/Vue.js设计与实现/1.权衡的艺术/" class="nav-link"><i class="undefined"></i>
  Vue.js设计与实现
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      项目实践
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/project/权限控制/权限控制基础知识/" class="nav-link"><i class="undefined"></i>
  权限控制
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/project/项目搭建/搭建一个组件库/" class="nav-link"><i class="undefined"></i>
  项目搭建
</a></li></ul></div></div><div class="nav-item"><a href="/vivien-blog/React/React基础知识/" class="nav-link"><i class="undefined"></i>
  React
</a></div><div class="nav-item"><a href="/vivien-blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/vivien-blog/messageBoard/messageBoard.html" class="nav-link"><i class="iconfont reco-message"></i>
  留言板
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      contact Vivien
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/yoguoer" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Vivien_CC" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>深入浅出webpack</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vivien-blog/books/深入浅出webpack/为什么要使用webpack.html" class="sidebar-link">为什么要使用webpack</a></li><li><a href="/vivien-blog/books/深入浅出webpack/webpack的使用.html" class="active sidebar-link">Webpack的使用</a></li><li><a href="/vivien-blog/books/深入浅出webpack/手动使用webpack.html" class="sidebar-link">手动使用webpack</a></li><li><a href="/vivien-blog/books/深入浅出webpack/更深入的一些知识.html" class="sidebar-link">手动使用webpack</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ES6入门教程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TypeScript教程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue.js设计与实现</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-15719524 data-v-222e0b9d><h3 class="title" data-v-15719524>Webpack的使用</h3> <!----> <label id="box" class="inputBox" data-v-15719524><input type="password" value="" data-v-15719524> <span data-v-15719524>Konck! Knock!</span> <button data-v-15719524>OK</button></label> <div class="footer" data-v-15719524><span data-v-15719524><i class="iconfont reco-theme" data-v-15719524></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-15719524>vuePress-theme-reco</a></span> <span data-v-15719524><i class="iconfont reco-copyright" data-v-15719524></i> <a data-v-15719524><!---->
          
        <!---->
        2025
      </a></span></div></div> <div data-v-222e0b9d><div data-v-222e0b9d><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">Webpack的使用</h1> <div data-v-f31d237c><i class="iconfont reco-account" data-v-f31d237c><span data-v-f31d237c>vivien</span></i> <i class="iconfont reco-date" data-v-f31d237c><span data-v-f31d237c>2024/2/21</span></i> <i class="iconfont reco-eye" data-v-f31d237c><span id="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-f31d237c><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-f31d237c><span class="tag-item" data-v-f31d237c>webpack</span></i></div></div> <div class="theme-reco-content content__default"><h2 id="webpack-配置文件与核心概念"><a href="#webpack-配置文件与核心概念" class="header-anchor">#</a> Webpack 配置文件与核心概念</h2> <ul><li>webpack.config.js : 用于存储webpack配置信息，用于控制Webpack的行为。常规的配置如下：</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Node.js的核心模块，专门用来处理文件路径</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// JavaScript 执行入口文件，相对路径和绝对路径都行， 类型可以是string|object|array </span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&quot;./src/main.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 只有1个入口，入口只有1个文件</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./app/entry1'</span><span class="token punctuation">,</span> <span class="token string">'./app/entry2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 只有1个入口，入口有2个文件</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 有2个入口</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token string">'./app/entry-a'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./app/entry-b1'</span><span class="token punctuation">,</span> <span class="token string">'./app/entry-b2'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 输出，在 Webpack 经过一系列处理后，如何输出最终想要的代码</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 打包前清理 dist 文件夹</span>
    <span class="token literal-property property">clean</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// path: 输出文件存放的目录，必须是 string 类型的绝对路径。</span>
    <span class="token comment">// path.resolve()方法返回一个绝对路径</span>
    <span class="token comment">// __dirname 当前文件的文件夹绝对路径</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 输出文件都放到 dist 目录下</span>

    <span class="token comment">// filename: 输出文件的名称</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span> <span class="token comment">// 完整的名称</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span> <span class="token comment">// 当配置了多个 entry 时，通过名称模版为不同的 entry 生成不同的文件名称</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'[chunkhash].js'</span><span class="token punctuation">,</span> <span class="token comment">// 根据文件内容 hash 值生成文件名称，用于浏览器长时间缓存文件</span>

    <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 指定在运行过程中生成的 Chunk 在输出时的文件名称</span>

    <span class="token comment">// 发布到线上的所有资源的 URL 前缀，string 类型</span>
    <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">'/assets/'</span><span class="token punctuation">,</span> <span class="token comment">// 放到指定目录下</span>
    <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 放到根目录下</span>
    <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">'https://cdn.example.com/'</span><span class="token punctuation">,</span> <span class="token comment">// 放到 CDN 上去</span>

    <span class="token literal-property property">libraryTarget</span><span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 配置以何种方式导出库</span>
    <span class="token literal-property property">library</span><span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 配置导出库的名称</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">//在Webpack中，你可以直接使用outputDir选项来指定输出目录，而不必使用output属性。</span>
  <span class="token comment">//outputDir: 'dist',</span>
  <span class="token comment">//默认情况下，assetsDir为空字符串，表示与outputDir相同。如果想将静态资源放在一个子目录中，可设置assetsDir为想要的目录名称。</span>
  <span class="token comment">//assetsDir: 'assets',</span>

  <span class="token comment">// 加载器</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// 插件</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 模式</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>

  <span class="token comment">// 优化配置</span>
  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 代码分割配置</span>
    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对所有模块都进行分割</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 用于启用或禁用压缩。。</span>
    <span class="token literal-property property">minimizer</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 开发工具</span>
  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>

  <span class="token comment">//devServer指的是用webpack开发服务器环境，需要注意，devServer的配置只能在开发环境中。</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><p>Webpack 是基于 Node.js 运行的，所以采用 Common.js 模块化规范</p> <ul><li>核心概念
<ul><li>Entry（入口）：指示Webpack从哪个文件开始打包，并分析构建内部依赖图。</li> <li>Output（出口）：指示webpack打包后的资源bundles在哪里输出文件，以及如何命名。</li> <li>Mode（模式）：指定构建模式，指示webpack使用相应模式的配置，配置分为development（开发模式）和production（生产模式）。</li> <li>Loader（加载器）：让webpack能够去处理那些非JavaScript文件，因为webpack自身只能解析JavaScript和json，字体、图片、css等都要交给loader和plugins处理。</li> <li>Plugin（插件）：指定要使用的插件，可以用于执行范围更广的任务，插件的范围包括，从打包到优化和压缩，一直到重新定义环境中的变量等。在Webpack构建流程中的特定时机注入扩展逻辑来改变构建结果或做你想要的事情。</li> <li>Module（模块）：指定加载器规则，用于处理不同类型的文件。在Webpack里一切皆模块，一个模块对应着一个文件。Webpack会从配置的Entry开始递归找出所有依赖的模块。</li> <li>Chunk（代码块）：一个Chunk由多个模块组合而成，用于代码合并与分割。这些模块是从入口模块通过依赖分析得来的。</li></ul></li> <li>Webpack配置文件中的其他常见属性：
<ul><li>devtool：指定开发工具，可以用来在开发过程中进行源码映射。</li> <li>resolve：指定模块解析规则，可以设置别名、扩展等。</li></ul></li></ul> <h2 id="webpack的使用步骤"><a href="#webpack的使用步骤" class="header-anchor">#</a> webpack的使用步骤</h2> <p>​        Webpack是一个用于现代JavaScript应用程序的静态模块打包器（module bundler）。它处理应用程序时，会递归地构建一个依赖关系图（dependency graph），其中包含应用程序需要的每个模块，然后将所有这些模块打包成一个或多个bundle。使用Webpack的基本步骤：</p> <ul><li>①在项目中安装和配置Webpack。可以通过运行npm install webpack webpack-cli -D命令，安装Webpack相关的包。</li> <li>②在项目根目录中，创建名为webpack.config.js的Webpack配置文件。在这个配置文件中，可以初始化一些基本的配置，例如指定构建模式等。</li> <li>③在package.json配置文件中的scripts节点下，新增一个脚本。例如，可以添加一个build脚本，命令为webpack，这样就可以通过运行npm run build命令来启动Webpack进行项目打包。</li> <li>④运行npm run build命令，启动Webpack进行项目打包。</li> <li>⑤还可以通过运行Webpack命令npx webpack --config webpack.config.js来完成。</li></ul> <h2 id="loader"><a href="#loader" class="header-anchor">#</a> loader</h2> <p><img src="/vivien-blog/assets/img/WebpackBook-5.eb2b6760.png" alt="img"></p> <ul><li>条件匹配：通过 test 、 include 、 exclude 三个配置项来命中Loader要应用规则的文件。
<ul><li>test 属性，识别出哪些文件会被转换。</li> <li>use 属性，定义出在进行转换时，应该使用哪个 loader。</li></ul></li> <li>应用规则：对选中后的文件通过 use 配置项来应用 Loader，可以只应用一个 Loader 或者按照从后往前的顺序应用一组 Loader，同时还可以分别给 Loader 传入参数。</li> <li>重置顺序：一组 Loader 的执行顺序默认是从右到左执行，通过enforce选项可以让其中一个Loader 的执行顺序放到最前或者最后，pre代表在所有正常loader之前执行，post是所有之后执行。</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  
  <span class="token comment">// ...其他配置项...  </span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 命中 JavaScript 文件</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span><span class="token comment">// 正则匹配命中要使用 Loader 的文件</span>
        <span class="token literal-property property">include</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 只会命中这里面的文件</span>
          path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'app'</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 忽略这里面的文件</span>
          path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'app/demo-files'</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'eslint-webpack-plugin'</span><span class="token punctuation">,</span>
        <span class="token comment">//在 Loader 需要传入很多参数时，你还可以通过一个 Object 来描述</span>
        <span class="token punctuation">{</span>
          <span class="token comment">// 用 babel-loader 转换 JavaScript 文件</span>
          <span class="token comment">// ?cacheDirectory 表示传给 babel-loader 的参数，用于缓存 babel 编译结果加快重新编译速度</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token string">'babel-loader?cacheDirectory'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span><span class="token punctuation">{</span>
             <span class="token literal-property property">cacheDirectory</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
           <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token comment">// enforce:'post' 的含义是把该 Loader 的执行顺序放到最后</span>
          <span class="token comment">// enforce 的值还可以是 pre，代表把 Loader 的执行顺序放到最前面</span>
          <span class="token literal-property property">enforce</span><span class="token operator">:</span><span class="token string">'post'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">// 省略其它 Loader</span>
       <span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token comment">// 只命中src目录里的js文件，加快 Webpack 搜索速度</span>
       <span class="token literal-property property">include</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 命中 SCSS 文件</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.scss$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span><span class="token comment">// 正则匹配命中要使用 Loader 的文件</span>
        <span class="token comment">// 使用一组 Loader 去处理 SCSS 文件。</span>
        <span class="token comment">// 处理顺序为从后到前，即先交给 sass-loader 处理，再把结果交给 css-loader 最后再给 style-loader。</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'sass-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token comment">// 排除 node_modules 目录下的文件</span>
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'node_modules'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 对非文本文件采用 file-loader 加载</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(gif|png|jpe?g|eot|woff|ttf|svg|pdf)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span><span class="token comment">// 正则匹配命中要使用 Loader 的文件</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'file-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><h3 id="file-loader-和url-loader"><a href="#file-loader-和url-loader" class="header-anchor">#</a> file-loader 和url-loader</h3> <ul><li>file-loader 可以把 JavaScript 和 CSS 中导入图片的语句替换成正确的地址，并同时把文件输出到对应的位置。把文件输出到⼀个文件夹中，在代码中通过相对 URL 去引用输出的文件。</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'file-loader'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>url-loader 可以在文件很小的情况下，把文件的内容经过 base64 编码后注入到 JavaScript 或者 CSS 中去。url-loader 会把根据图片内容计算出的 base64 编码的字符串直接注入到代码中，由于一般的图片数据量巨大，这会导致 JavaScript、CSS 文件也跟着变大。所以在使用 url-loader 时一定要注意图片体积不能太大，不然会导致 JavaScript、CSS 文件过大而带来的网页加载缓慢问题。
<ul><li>一般利用 url-loader 把网页需要用到的小图片资源注入到代码中去，以减少加载次数。</li> <li>url-loader 考虑到了以上问题，并提供了一个方便的选择 limit，该选项用于控制当文件大小小于 limit 时才使用 url-loader，否则使用 fallback 选项中配置的 loader。</li></ul></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.png$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'url-loader'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// 30KB 以下的文件采用 url-loader</span>
            <span class="token literal-property property">limit</span><span class="token operator">:</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">,</span>
            <span class="token comment">// 否则采用 file-loader，默认值就是 file-loader </span>
            <span class="token literal-property property">fallback</span><span class="token operator">:</span> <span class="token string">'file-loader'</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="parser和noparse"><a href="#parser和noparse" class="header-anchor">#</a> parser和noParse</h3> <ul><li>noParse 配置项可以让 Webpack 忽略对部分没采用模块化的文件的递归解析和处理，这样做的好处是能提高构建性能。 原因是一些库例如 jQuery 、ChartJS 它们庞大又没有采用模块化标准，让 Webpack 去解析这些文件耗时又没有意义。</li> <li>parser 属性可以更细粒度的配置哪些模块语法要解析哪些不解析，和 noParse 配置项的区别在于 parser 可以精确到语法层面， 而 noParse 只能控制哪些文件不被解析。</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token operator">...</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">test</span><span class="token operator">:</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jpg$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'asset'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">parser</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token literal-property property">dataUrlCondition</span><span class="token operator">:</span><span class="token punctuation">{</span>
              <span class="token literal-property property">maxSize</span><span class="token operator">:</span><span class="token number">4</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token comment">//当图片大小大于4M时生成资源文件，否则为base64 url</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="oneof"><a href="#oneof" class="header-anchor">#</a> OneOf</h3> <p>​        打包时每个文件都会经过所有 loader 处理，虽然因为 test 正则原因实际没有处理上，但是都要过一遍。比较慢。OneOf顾名思义就是只能匹配上一个 loader, 剩下的就不匹配了。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">oneOf</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{</span>
            <span class="token comment">// 用来匹配 .css 结尾的文件</span>
            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token comment">// use 数组里面 Loader 执行顺序是从右到左</span>
            <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;style-loader&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token comment">// exclude: /node_modules/, // 排除node_modules代码不编译</span>
            <span class="token literal-property property">include</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../src&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 也可以用包含</span>
            <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">cacheDirectory</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 开启babel编译缓存</span>
              <span class="token literal-property property">cacheCompression</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 缓存文件不要压缩</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span>
            <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(png|jpe?g|gif|webp)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;asset&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">parser</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token literal-property property">dataUrlCondition</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">maxSize</span><span class="token operator">:</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token comment">// 小于10kb的图片会被base64处理</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">generator</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token comment">// 将图片文件输出到 static/imgs 目录中</span>
              <span class="token comment">// 将图片文件命名 [hash:8][ext][query]</span>
              <span class="token comment">// [hash:8]: hash值取8位</span>
              <span class="token comment">// [ext]: 使用之前的文件扩展名</span>
              <span class="token comment">// [query]: 添加之前的query参数</span>
              <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;static/imgs/[hash:8][ext][query]&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h3 id="cache"><a href="#cache" class="header-anchor">#</a> cache</h3> <p>​        每次打包时 js 文件都要经过 Eslint 检查 和 Babel 编译，速度比较慢。我们可以缓存之前的 Eslint 检查 和 Babel 编译结果，这样第二次打包时速度就会更快了。</p> <p>​        Cache是对 Eslint 检查 和 Babel 编译结果进行缓存。</p> <h3 id="thread"><a href="#thread" class="header-anchor">#</a> Thread</h3> <p>​        当项目越来越庞大时，打包速度越来越慢，甚至于需要一个下午才能打包出来代码。这个速度是比较慢的。我们想要继续提升打包速度，其实就是要提升 js 的打包速度，因为其他文件都比较少。而对 js 文件处理主要就是 eslint 、babel、Terser 三个工具，所以我们要提升它们的运行速度。我们可以开启多进程同时处理 js 文件，这样速度就比之前的单进程打包更快了。</p> <p>​        thead是多进程打包：开启电脑的多个进程同时干一件事，速度更快。（注意：请仅在特别耗时的操作中使用，因为每个进程启动就有大约为 600ms 左右开销。）我们启动进程的数量就是我们 CPU 的核数。</p> <h2 id="plugins"><a href="#plugins" class="header-anchor">#</a> plugins</h2> <p>​       Plugin 是用来扩展 Webpack 功能的，通过在构建流程里注入钩子实现，它给 Webpack 带来了很大的灵活性。在 Webpack 构建流程中的特定时机会广播出对应的事件，插件可以监听这些事件的发生，在特定时机做对应的事情。plugins 配置项接受一个数组，数组里每一项都是一个要使用的 Plugin 的实例，Plugin 需要的参数通过构造函数传入。</p> <blockquote><p>​        由于webpack基于发布订阅模式，在运行的生命周期中会广播出许多事件，插件通过监听这些事件，就可以在特定的阶段执行自己的插件任务</p></blockquote> <p>​        要使用一个插件，只需要require() 它，然后把它添加到plugins数组中。使用 Plugin 的难点在于掌握 Plugin 本身提供的配置项，而不是如何在Webpack中接入Plugin。几乎所有 Webpack 无法直接实现的功能都能在社区找到开源的Plugin去解决，你需要善于使用搜索引擎去寻找解决问题的方法。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">const</span> CommonsChunkPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack/lib/optimize/CommonsChunkPlugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;mini-css-extract-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ExtractTextPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'extract-text-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  
  <span class="token comment">// ...其他配置项...  </span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>  
    <span class="token comment">//使用HtmlWebpackPlugin来生成一个HTML文件，并将其输出为index.html</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
      <span class="token comment">// 新的html文件有两个特点：1. 内容和源文件一致 2. 自动引入打包生成的js等资源</span>
      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">'src/index.html'</span><span class="token punctuation">,</span> <span class="token comment">// 指定模板文件,指向的html</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span> <span class="token comment">// 输出的文件名,被打包后的html文件名  </span>
      <span class="token literal-property property">inject</span><span class="token operator">:</span><span class="token string">'body'</span><span class="token comment">// js打包后的生成位置</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    <span class="token comment">// 所有页面都会用到的公共代码提取到 common 代码块中</span>
    <span class="token keyword">new</span> <span class="token class-name">CommonsChunkPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'common'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment">// 提取css成单独文件</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 定义输出文件名和目录</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;static/css/[name].css&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token string">&quot;static/css/[name].chunk.css&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">ExtractTextPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 将 CSS 样式从 JavaScript 文件中提取出来并生成单独的 CSS 文件</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[name]_[contenthash:8].css</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>  
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>​        通常，当webpack完成某个特定的任务或阶段后，会调用相应的钩子函数。插件可以注册这些钩子函数，以便在特定的事件发生时执行代码。例如，插件可以在编译开始时、编译结束时、打包开始时、打包结束时、资源发生变化时等时间节点上执行特定的任务。</p> <p>以下是一些常见的钩子函数和它们的使用场景：</p> <ul><li>entryOption: 当读取到入口文件时触发，可以修改入口文件的配置。</li> <li>afterPlugins: 在所有插件加载完毕后触发，可以执行一些与插件相关的操作。</li> <li>beforeRun: 在运行阶段开始前触发，可以执行一些预处理操作。</li> <li>run: 在运行阶段开始后触发，可以执行一些与构建无关的插件逻辑。</li> <li>watchRun: 在webpack开始监听文件变化时触发，可以执行一些与监听文件变化相关的操作。</li> <li>compilation: 在编译阶段开始时触发，可以修改或扩展全局*配置。（全局变量，可以在插件中访问和修改）</li> <li>make: 在编译阶段开始时触发，可以修改或扩展编译过程。</li> <li>thisCompilation: 在当前编译实例开始时触发，可以访问和修改当前编译实例的编译配置。（局部变量，只能在插件内部使用）</li> <li>shouldEmit: 在输出阶段开始前触发，可以决定是否进行输出。</li> <li>compilationParams: 在编译参数被优化前触发，可以修改编译参数。</li></ul> <p>​        通过注册这些钩子函数，插件可以在构建过程的各个阶段插入自定义的逻辑，实现各种不同的功能，如资源管理、性能优化、代码拆分、环境变量注入等。</p> <h2 id="devserver"><a href="#devserver" class="header-anchor">#</a> devServer</h2> <p>​         在Webpack中，webpack-dev-server是一个非常重要的工具，用于开发阶段提供服务器功能。DevServer 会启动一个 HTTP 服务器用于服务网页请求，同时会帮助启动 Webpack ，并接收 Webpack 发出的文件更变信号，通过 WebSocket 协议自动刷新网页做到实时预览。</p> <p>​        在使用webpack-dev-server时，需要先安装Webpack。同时，为了使服务器能够正确地访问和打包项目中的文件，需要配置正确的路径和端口号。使用dev-server的基本步骤：</p> <ul><li>①安装webpack-dev-server：在项目根目录下，运行npm i -D webpack-dev-server，将webpack-dev-server安装到本地开发环境中。安装成功后执行 webpack-dev-server 命令， DevServer 就启动了。</li> <li>②修改配置文件：在项目根目录下找到webpack.config.js文件，并添加devServer节点。这个节点用于配置服务器的相关参数，例如监听的端口号、文件输出路径等。</li> <li>③启动服务器：在项目根目录下，运行npx webpack serve --open命令，即可启动服务器并打开浏览器窗口显示页面。也可以使用 npm 运行： npm run serve。</li> <li>④修改代码：在开发过程中，当源代码发生变化时，webpack-dev-server会自动重新打包文件并更新浏览器中的页面，无需手动刷新页面。</li> <li>⑤开启监听模式、配置模块热替换、sourceMap等等。</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token comment">//devServer指的是用webpack开发服务器环境，需要注意，devServer的配置只能在开发环境中。</span>
  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 代理到后端服务接口，将特定的API请求代理到另一个服务器</span>
    <span class="token literal-property property">proxy</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">'/api'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token string">'http://localhost:3000'</span><span class="token punctuation">,</span> <span class="token comment">// 后端服务器地址  </span>
        <span class="token literal-property property">changeOrigin</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否改变主机头  </span>
        <span class="token literal-property property">pathRewrite</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string-property property">'^/api'</span><span class="token operator">:</span> <span class="token string">''</span> <span class="token comment">// 将/api路径重写为空字符串  </span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token literal-property property">contentBase</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 服务器的文件根目录  </span>
    <span class="token literal-property property">compress</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 启用gzip压缩</span>
    <span class="token literal-property property">historyApiFallback</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否开发 HTML5 History API 网页</span>
    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token comment">// 端口号  </span>
    <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 配置自动打开浏览器  </span>
    <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span> <span class="token comment">// 指定服务器绑定的主机名或IP地址，默认是localhost</span>
    <span class="token literal-property property">hot</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 启用热模块替换（HMR）</span>
    <span class="token literal-property property">https</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否开启 HTTPS 模式</span>
    <span class="token literal-property property">overlay</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 如果发生错误，显示一个覆盖层</span>
      <span class="token literal-property property">warnings</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">errors</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token literal-property property">profile</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 是否捕捉 Webpack 构建的性能信息，用于分析什么原因导致构建性能不佳</span>

    <span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否启用缓存提升构建速度</span>

    <span class="token comment">// 告知webpack-dev-server，将dist目录下的文件作为web服务的根目录,默认将文件打包输出到dist下,查看dist下文件情况就好了</span>
    <span class="token keyword">static</span><span class="token operator">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span>

    <span class="token comment">// 只有在开启监听模式时，watchOptions 才有意义</span>
    <span class="token comment">// 默认为 false，也就是不开启</span>
    <span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 每次需要手动刷新浏览器。</span>
    <span class="token comment">// 监听模式运行时的参数</span>
    <span class="token comment">// 在开启监听模式时，才有意义</span>
    <span class="token literal-property property">watchOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// 不监听的文件或文件夹，支持正则匹配</span>
      <span class="token comment">// 默认为空</span>
      <span class="token literal-property property">ignored</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token comment">// 监听到变化发生后会等300ms再去执行动作，防止文件更新太快导致重新编译频率太高</span>
      <span class="token comment">// 默认为 300ms  </span>
      <span class="token literal-property property">aggregateTimeout</span><span class="token operator">:</span> <span class="token number">300</span><span class="token punctuation">,</span>
      <span class="token comment">// 判断文件是否发生变化是通过不停的去询问系统指定文件有没有变化实现的</span>
      <span class="token comment">// 默认每隔1000毫秒询问一次</span>
      <span class="token literal-property property">poll</span><span class="token operator">:</span> <span class="token number">1000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token literal-property property">stats</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 控制台输出日志控制</span>
      <span class="token literal-property property">assets</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">colors</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">errors</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">errorDetails</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">hash</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br></div></div><h2 id="优化和生产配置"><a href="#优化和生产配置" class="header-anchor">#</a> 优化和生产配置</h2> <p><img src="/vivien-blog/assets/img/WebpackBook-6.e0d9a2ab.png" alt="img"></p> <h3 id="resolve"><a href="#resolve" class="header-anchor">#</a> resolve</h3> <p>​        resolve是用于配置模块解析规则的选项，主要影响非代码模块的解析。通过配置resolve，可以缩短Webpack的解析时间，提高打包速度。</p> <blockquote><p>在开发中我们会有各种各样的模块依赖，这些模块可能来自于自己编写的代码，也可能来自第三方库， resolve可以帮webpack从每个require/import语句中，找到需要引入到合适的模块代码</p></blockquote> <p>​        Webpack 在启动后会从配置的入口模块出发找出所有依赖的模块，Resolve 配置 Webpack 如何寻找模块所对应的文件。resolve.modules 用于配置 Webpack 去哪些目录下寻找第三方模块。resolve.modules 的默认值是 ['node_modules']，含义是先去当前目录下的 ./node_modules 目录下去找想找的模块，如果没找到就去上一级目录 ../node_modules 中找，再没有就去 ../../node_modules 中找，以此类推，这和 Node.js 的模块寻找机制很相似。</p> <p>​        当安装的第三方模块都放在项目根目录下的 ./node_modules 目录下时，没有必要按照默认的方式去一层层的寻找，可以指明存放第三方模块的绝对路径，以减少寻找，配置如下：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">resolve</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用绝对路径指明第三方模块存放的位置，以减少搜索步骤</span>
    <span class="token comment">// 其中 __dirname 表示当前工作目录，也就是项目根目录</span>
    <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'node_modules'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>合理使用resolve.extensions：解析到文件时自动添加拓展名</li> <li>优化resolve.modules：可以指明存放第三方模块的绝对路径，以减少寻找</li> <li>优化resolve.alias：给一些常用的路径起一个别名，以减少查找过程</li></ul> <h4 id="resolveloader"><a href="#resolveloader" class="header-anchor">#</a> resolveLoader</h4> <p>​        resolveLoader是用于配置解析loader时的resolve，主要影响代码模块的解析。通过配置resolveLoader，可以指定如何解析使用特定loader的模块。</p> <p>​        RresolveLoader 用来告诉 Webpack 如何去寻找 Loader，因为在使用 Loader 时是通过其包名称去引用的， Webpack 需要根据配置的 Loader 包名去找到 Loader 的实际代码，以调用 Loader 去处理源文件。ResolveLoader 的默认配置如下：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">resolveLoader</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token comment">// 去哪个目录下寻找 Loader</span>
    <span class="token literal-property property">modules</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'node_modules'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// 入口文件的后缀</span>
    <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'.js'</span><span class="token punctuation">,</span> <span class="token string">'.json'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// 指明入口文件位置的字段</span>
    <span class="token literal-property property">mainFields</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'loader'</span><span class="token punctuation">,</span> <span class="token string">'main'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>该配置项常用于加载本地的 Loader。</p> <h3 id="include-exclude"><a href="#include-exclude" class="header-anchor">#</a> include/exclude</h3> <p>​        用于缩小文件搜索范围。开发时我们需要使用第三方的库或插件，所有文件都下载到 node_modules 中了。而这些文件是不需要编译可以直接使用的。所以我们在对 js 文件处理时，要排除 node_modules 下面的文件。</p> <ul><li>include：包含，只处理 xxx 文件</li> <li>exclude：排除，除了 xxx 文件以外其他文件都处理</li></ul> <h3 id="sourcemap"><a href="#sourcemap" class="header-anchor">#</a> sourceMap</h3> <p>​        SourceMap（源代码映射）是一个用来生成源代码与构建后代码一一映射的文件的方案。</p> <p>​        它会生成一个 xxx.map 文件，里面包含源代码和构建后代码每一行、每一列的映射关系。当构建后代码出错了，会通过 xxx.map 文件，从构建后代码出错位置找到映射后源代码出错位置，从而让浏览器提示源代码文件出错位置，帮助我们更快的找到错误根源。</p> <p>它有两种使用方式：</p> <p>​         sourceMap: true和devtool: &quot;source-map&quot;都用于生成SourceMap，但它们在配置方式和使用场景上存在一些区别。总的来说，sourceMap: true是用于在特定的loader中生成SourceMap，而devtool: &quot;source-map&quot;是用于在webpack配置中指定SourceMap生成策略。在实际使用中，你应根据自己的需求选择合适的配置方式。</p> <ul><li>sourceMap: true是webpack配置中的一个选项，用于在编译过程中生成SourceMap。它需要在特定的loader中设置，如css-loader、sass-loader、less-loader和postcss-loader等。当你在这些loader的options中添加sourceMap: true时，它们会生成对应的SourceMap文件，以便在开发过程中进行调试。</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev source<span class="token operator">-</span>map<span class="token operator">-</span>loader sourcemaps<span class="token operator">-</span>loader
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  
  <span class="token comment">// ...其他配置项  </span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>  
      <span class="token punctuation">{</span>  
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// 这里可以根据需要修改正则表达式来匹配需要添加sourceMap的文件  </span>
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// 这里可以根据需要排除不需要添加sourceMap的文件夹  </span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'source-map-loader'</span><span class="token punctuation">,</span> <span class="token comment">// 或者 'sourcemaps-loader'  </span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
            <span class="token comment">// 这里可以配置其他选项，如devtool等  </span>
          <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>  
      <span class="token punctuation">}</span>  
    <span class="token punctuation">]</span>  
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>注意，如果你使用的是sourcemaps-loader插件，则需要在use字段中添加sourceMap参数，并将其设置为true。例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
  <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'sourcemaps-loader'</span><span class="token punctuation">,</span>  
  <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
    <span class="token literal-property property">sourceMap</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 设置为true以生成sourceMap  </span>
    <span class="token comment">// 其他选项...  </span>
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>devtool: &quot;source-map&quot;也是webpack配置中的一个选项，用于生成SourceMap，但它是一个更高级的选项。它允许你选择不同的SourceMap生成策略，如source-map、inline-source-map等。source-map策略会生成一个单独的SourceMap文件，而inline-source-map策略会将SourceMap数据内联到打包后的文件中。选择不同的策略会影响到SourceMap的生成方式和浏览器加载SourceMap的方式，进而影响到调试过程。</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span> <span class="token comment">// 指定入口文件  </span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'bundle.js'</span> <span class="token comment">// 指定输出文件名  </span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>  
  <span class="token comment">// 开发中推荐使用 'source-map'</span>
  <span class="token comment">// 生产环境一般不开启 sourcemap</span>
  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">'source-map'</span> <span class="token comment">// 指定使用source-map生成SourceMap  </span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="tree-shaking"><a href="#tree-shaking" class="header-anchor">#</a> Tree-shaking</h3> <p>​        被称为摇树优化或摇树，是一种通过消除JavaScript上下文中无用的代码来优化打包结果的技术。Webpack 已经默认开启了这个功能，无需其他配置。为了使tree shaking生效，还需要保证所有模块的导出都是具名的（即使用export关键字），否则Webpack无法准确判断哪些模块被使用。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span>
      <span class="token literal-property property">mode</span><span class="token operator">:</span><span class="token string">'development'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token literal-property property">usedExports</span><span class="token operator">:</span><span class="token boolean">true</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="sideeffects"><a href="#sideeffects" class="header-anchor">#</a> sideEffects</h4> <p>​        有些模块导入，只要被引入，就会对应用程序产生重要的影响。一个很好的例子就是全局样式表，或者设置全局配置的JavaScript 文件，Webpack 认为这样的文件有“副作用”，这样的文件不应该做 tree-shaking， 因为这将破坏整个应用程序。但是因为tree-shaking 会导致无差别删除代码，我们可以通过配置sideEffects来手动调节模块。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;sideEffects&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;*.css&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="core-js"><a href="#core-js" class="header-anchor">#</a> Core-js</h3> <p>​        过去我们使用 babel 对 js 代码进行了兼容性处理，其中使用@babel/preset-env 智能预设来处理兼容性问题。它能将 ES6 的一些语法进行编译转换，比如箭头函数、点点点运算符等。但是如果是 async 函数、promise 对象、数组的一些方法（includes）等，它没办法处理。所以此时我们 js 代码仍然存在兼容性问题，一旦遇到低版本浏览器会直接报错。所以我们想要将 js 兼容性问题彻底解决。</p> <p>​        core-js 是专门用来做 ES6 以及以上 API 的 polyfill。polyfill翻译过来叫做垫片/补丁。就是用社区上提供的一段代码，让我们在不兼容某些新特性的浏览器上，使用该新特性。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 智能预设：能够编译ES6语法</span>
  <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">// 按需加载core-js的polyfill</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">useBuiltIns</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">corejs</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">version</span><span class="token operator">:</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">proposals</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="polyfill"><a href="#polyfill" class="header-anchor">#</a> polyfill</h4> <p>Polyfill和core-js都是为了解决浏览器兼容性问题，使新的JavaScript特性能在旧版浏览器上运行。</p> <ul><li>Polyfill是一段代码，它为旧版浏览器提供了新特性的实现。这样，开发者就可以在代码中使用新的JavaScript特性，而不需要担心旧版浏览器的兼容性问题。</li> <li>Core-js则是一个提供了许多现代JavaScript特性的库。它包含了大量的polyfill，可以在不同的浏览器环境中提供一致的JavaScript API。通过使用core-js，开发者可以轻松地在现代和旧版浏览器上实现相同的JavaScript功能。</li></ul> <h3 id="paralleluglifyplugin"><a href="#paralleluglifyplugin" class="header-anchor">#</a> ParallelUglifyPlugin</h3> <p>​        ParallelUglifyPlugin是一个Webpack插件，用于并行压缩JS代码。默认情况下，Webpack使用UglifyJS插件来压缩JS代码，但它是单线程的，当 Webpack 有多个 JavaScript 文件需要输出和压缩时，它需要一个个文件进行压缩，导致压缩速度较慢。但是 ParallelUglifyPlugin 则会开启多个子进程，把对多个文件的压缩工作分配给多个子进程去完成，每个子进程其实还是通过 UglifyJS 去压缩代码，但是变成了并行执行。（多核并行） 所以 ParallelUglifyPlugin 能更快的完成对多个文件的压缩工作。</p> <p>​        ParallelUglifyPlugin 同时内置了 UglifyJS 和 UglifyES，也就是说 ParallelUglifyPlugin 支持并行压缩 ES6 代码。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> DefinePlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack/lib/DefinePlugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ParallelUglifyPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-parallel-uglify-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 使用 ParallelUglifyPlugin 并行压缩输出的 JS 代码</span>
    <span class="token keyword">new</span> <span class="token class-name">ParallelUglifyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 传递给 UglifyJS 的参数</span>
      <span class="token literal-property property">uglifyJS</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 最紧凑的输出</span>
          <span class="token literal-property property">beautify</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          <span class="token comment">// 删除所有的注释</span>
          <span class="token literal-property property">comments</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token comment">//compress选项用于指定是否压缩输出文件</span>
        <span class="token literal-property property">compress</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token comment">// 在UglifyJs删除没有用到的代码时不输出警告</span>
          <span class="token literal-property property">warnings</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          <span class="token comment">// 删除所有的 `console` 语句，可以兼容ie浏览器</span>
          <span class="token literal-property property">drop_console</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token comment">// 内嵌定义了但是只用到一次的变量</span>
          <span class="token literal-property property">collapse_vars</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token comment">// 提取出出现多次但是没有定义成变量去引用的静态值</span>
          <span class="token literal-property property">reduce_vars</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>​        UglifyJS和UglifyES是两个不同的JavaScript工具，它们用于压缩和美化JavaScript代码。它们的主要区别在于它们处理的JavaScript版本。</p> <h4 id="uglifyjs"><a href="#uglifyjs" class="header-anchor">#</a> UglifyJS</h4> <p>​        UglifyJS是一个流行的JavaScript压缩工具，它主要用于处理ECMAScript 5（ES5）版本的JavaScript。它能够压缩、美化、转换和混淆JavaScript代码，以便更小、更快、更安全地加载和运行。UglifyJS还支持一些高级功能，如变量和函数名称的替换、代码结构化等。</p> <h4 id="uglifyes"><a href="#uglifyes" class="header-anchor">#</a> UglifyES</h4> <p>​        UglifyES是UglifyJS的一个分支，它专注于处理ECMAScript 2015（ES2015）及更高版本的JavaScript。由于ES2015引入了许多新的语法和特性，UglifyES提供了一些额外的功能来支持这些新特性，例如模板字符串、默认参数、箭头函数等。</p> <h3 id="dllplugin-动态链接库"><a href="#dllplugin-动态链接库" class="header-anchor">#</a> DllPlugin-动态链接库</h3> <p>​         DllPlugin是一个Webpack插件，用于将第三方库这种无论怎么改业务代码构建结果都不会发生改变的模块单独拆出来构建，下次只要不改变第三方库就直接引用现成的构建结果。包含大量复用模块的动态链接库只需要编译一次，在之后的构建过程中被动态链接库包含的模块将不会在重新编译，而是直接使用动态链接库中的代码。可以用来预编译资源模块，通过DIIPlugin来对那些我们引用但是绝对不会修改的npm包进行预编译，再通过DLLReferencePlugin将预编译的模块加载进来。</p> <p>Webpack 已经内置了对动态链接库的支持，需要通过2个内置的插件接入，它们分别是：</p> <ul><li>DllPlugin 插件：用于打包出一个个单独的动态链接库文件。</li> <li>DllReferencePlugin 插件：用于在主要配置文件中去引入 DllPlugin 插件打包好的动态链接库文件。</li></ul> <p>​        需要注意的是，在使用DllPlugin时，需要将第三方库的依赖项单独拆出来构建，而不是将整个项目一起打包。这样可以减少最终打包文件的大小，提高加载速度。同时，使用DllPlugin需要配置额外的webpack配置文件，并且需要在主配置文件中引入DllReferencePlugin插件。</p> <h3 id="code-split-代码分割"><a href="#code-split-代码分割" class="header-anchor">#</a> Code Split-代码分割</h3> <p>​        打包代码时会将所有 js 文件打包到一个文件中，体积太大了。我们如果只要渲染首页，就应该只加载首页的 js 文件，其他文件不应该加载。所以我们需要将打包生成的文件进行代码分割，生成多个 js 文件，渲染哪个页面就只加载某个 js 文件，这样加载的资源就少，速度就更快。</p> <p>代码分割（Code Split）主要做了两件事：</p> <p>①分割文件：将打包生成的文件进行分割，生成多个 js 文件。</p> <p>②按需加载：需要哪个文件就加载哪个文件。</p> <p>代码分割实现方式有不同的方式，</p> <h4 id="单入口"><a href="#单入口" class="header-anchor">#</a> 单入口</h4> <p>​        开发时我们可能是单页面应用（SPA），只有一个入口（单入口）。那么我们需要这样配置：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 代码分割配置</span>
    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对所有模块都进行分割</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="多入口"><a href="#多入口" class="header-anchor">#</a> 多入口</h4> <p>SplitChunksPlugin可以将公共的依赖模块提取到已有的入口 chunk 中，或者提取到一个新生成的 chunk。在多入口情况下使用SplitChunksPlugin来提取公共代码。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>  <span class="token comment">// 多入口</span>
 module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
 <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">//将其他包命名在entry中</span>
     <span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
     <span class="token literal-property property">another</span><span class="token operator">:</span> <span class="token string">'./src/another-module.js'</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">//并在output输出端中直接配置[name]对应entry中的key</span>
     <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'[name].bundle.js'</span>
 <span class="token comment">//...</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token comment">//...}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>此时在 dist 目录我们能看到输出了两个 js 文件。总结：配置了几个入口，至少输出几个 js 文件。</p> <h4 id="提取公共代码"><a href="#提取公共代码" class="header-anchor">#</a> 提取公共代码</h4> <p><img src="/vivien-blog/assets/img/WebpackBook-7.0bb54ce1.png" alt="img"></p> <p>​        Webpack 内置了专门用于提取多个 Chunk 中公共部分的插件 CommonsChunkPlugin，CommonsChunkPlugin 大致使用方法如下：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> CommonsChunkPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack/lib/optimize/CommonsChunkPlugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">CommonsChunkPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 从哪些 Chunk 中提取</span>
  <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 提取出的公共部分形成一个新的 Chunk，这个新 Chunk 的名称</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'common'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>以上配置就能从网页 A 和网页 B 中抽离出公共部分，放到 common 中。</p> <p>​        每个 CommonsChunkPlugin 实例都会生成一个新的 Chunk，这个新 Chunk 中包含了被提取出的代码，在使用过程中必须指定 name 属性，以告诉插件新生成的 Chunk 的名称。 其中 chunks 属性指明从哪些已有的 Chunk 中提取，如果不填该属性，则默认会从所有已知的 Chunk 中提取。</p> <h4 id="按需加载-动态导入"><a href="#按需加载-动态导入" class="header-anchor">#</a> 按需加载，动态导入</h4> <p>方式一：也是推荐选择的方式</p> <p>​        使用符合ECMAScript提案的import()语法来实现动态导入，且不影响其他模块抽离方式。当需要加载特定模块时，你可以使用import()语法动态地导入它。</p> <p>例如，如果你有一个名为utils的模块，你可以这样导入它：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 动态导入 --&gt; 实现按需加载</span>
<span class="token comment">// 即使只被引用了一次，也会代码分割</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;utils&quot; */</span> <span class="token string">'./utils'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> utils <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这将告诉Webpack将这个模块拆分到一个单独的bundle中，并为其分配一个唯一的chunk name。</p> <p>方式二：webpack的遗留功能，使用 webpack 特定的 require.ensure</p> <p>​        require.ensure 是 Webpack 的一个功能，它用于代码拆分。使用 require.ensure 可以将代码拆分成多个块，并在需要时异步加载这些块。这对于按需加载或懒加载特定模块非常有用，可以提高应用程序的性能。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>require<span class="token punctuation">.</span><span class="token function">ensure</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">require</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
  <span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./module'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token comment">// 使用 module...  </span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>​        在上面的代码中，require.ensure 接受一个数组参数，该参数包含要加载的依赖项。第二个参数是一个回调函数，该函数在依赖项加载完成后被调用。在回调函数中，你可以使用 require 语句来导入依赖项，并使用它们进行进一步的操作。</p> <p>​        请注意，require.ensure 不会立即执行回调函数。它只是将回调函数添加到依赖项队列中，等待依赖项加载完成后再执行。这意味着你可以在代码的其他部分继续使用 require 语句导入其他模块，而不需要等待 require.ensure 回调函数的执行。</p> <h4 id="防止重复"><a href="#防止重复" class="header-anchor">#</a> 防止重复</h4> <p>​        Entry dependencies入口依赖，比如，但两个模块共有lodash时，会抽离出来并取名为shared。配置 dependOn option 选项，这样可以在多个 chunk 之间共享模块：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>    <span class="token literal-property property">entry</span><span class="token operator">:</span><span class="token punctuation">{</span>
          <span class="token literal-property property">index</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token keyword">import</span><span class="token operator">:</span><span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">dependOn</span><span class="token operator">:</span><span class="token string">'shared'</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">another</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token keyword">import</span><span class="token operator">:</span><span class="token string">'./src/another-module.js'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">dependOn</span><span class="token operator">:</span><span class="token string">'shared'</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token literal-property property">shared</span><span class="token operator">:</span><span class="token string">'lodash'</span>
          <span class="token literal-property property">index</span><span class="token operator">:</span><span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
          <span class="token literal-property property">another</span><span class="token operator">:</span><span class="token string">'./src/another-module.js'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="externals"><a href="#externals" class="header-anchor">#</a> Externals</h3> <p>​        告诉 Webpack在构建过程中哪些模块应该被视为外部依赖项，而不是包含在最终的打包文件中。通过将某些模块定义为外部依赖项，Webpack将不会将这些模块打包到最终的输出文件中，而是在运行时从外部环境中获取这些模块。通过 externals 可以告诉 Webpack，JS运行环境已经内置了哪些全局变量，针对这些全局变量不用打包进代码中，而是直接使用全局变量。可以用来配置提取常用库，例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>export <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在代码中使用这些模块时，Webpack将不会将其包含在打包文件中，而是将其视为全局变量。</span>
  <span class="token literal-property property">externals</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 把导入语句里的 jquery 替换成运行环境里的全局变量 jQuery</span>
    <span class="token literal-property property">jquery</span><span class="token operator">:</span> <span class="token string">'jQuery'</span><span class="token punctuation">,</span>
    <span class="token comment">// lodash将被替换为_</span>
    <span class="token literal-property property">lodash</span><span class="token operator">:</span> <span class="token string">'_'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>​        使用externals选项可以帮助减少最终打包文件的大小，因为不需要包含那些已经在外部环境中存在的依赖项。但是，需要注意的是，使用外部依赖项需要确保在运行时环境中存在这些依赖项，否则可能会导致运行时错误。</p> <h3 id="happypack"><a href="#happypack" class="header-anchor">#</a> happypack</h3> <p>​        分解任务和管理线程（并行处理和多线程的方式），将loader由单线程转为多线程加速编译。将Webpack的构建任务分解为多个子进程并行执行来加速构建速度。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ExtractTextPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'extract-text-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HappyPack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'happypack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token comment">// 把对 .js 文件的处理转交给 id 为 babel 的 HappyPack 实例</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'happypack/loader?id=babel'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token comment">// 排除 node_modules 目录下的文件，node_modules 目录下的文件都是采用的 ES5 语法，没必要再通过 Babel 去转换</span>
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'node_modules'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 把对 .css 文件的处理转交给 id 为 css 的 HappyPack 实例</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> ExtractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'happypack/loader?id=css'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HappyPack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 用唯一的标识符 id 来代表当前的 HappyPack 是用来处理一类特定的文件</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'babel'</span><span class="token punctuation">,</span>
      <span class="token comment">// 如何处理 .js 文件，用法和 Loader 配置中一样</span>
      <span class="token literal-property property">loaders</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel-loader?cacheDirectory'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token comment">// ... 其它配置项</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">HappyPack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'css'</span><span class="token punctuation">,</span>
      <span class="token comment">// 如何处理 .css 文件，用法和 Loader 配置中一样</span>
      <span class="token literal-property property">loaders</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'css-loader'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">ExtractTextPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">[name].css</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h3 id="postcss和css"><a href="#postcss和css" class="header-anchor">#</a> PostCSS和CSS</h3> <p>​        PostCSS是一个对CSS进行编译的工具，类似于Babel对JavaScript的处理。PostCSS并不扩展CSS语法，而是处理已经写好的CSS代码，使其更加健康。PostCSS支持下一代CSS语法，并可以自动补全浏览器前缀、自动将px单位转换为rem等。此外，PostCSS可以通过插件实现各种功能，例如自动压缩CSS代码等。</p> <p>​        比如可以使用 Autoprefixer  插件自动获取浏览器的流行度及支持的属性，并为css规则自动添加前缀，将最新的css语法转换为大多数浏览器所支持的语法。</p> <ul><li>安装postcss、autoprefixser：【npm install postcss-loader autoprefixser -D】</li> <li>新建文件postcss.config.js至根目录下，并配置</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'postcss-nested'</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>注意，还需在package.json中配置浏览器列表以实现兼容效果</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token operator">...</span>
    <span class="token string-property property">&quot;browserslist&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token string">&quot;&gt; 1%&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;last 2 versions&quot;</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
 
<span class="token comment">//last 2 versions:  每个浏览器中最新的两个版本。</span>
<span class="token comment">//&gt; 1% or &gt;= 1%:  全球浏览器使用率大于1%或大于等于1%。</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="babel-loader"><a href="#babel-loader" class="header-anchor">#</a> babel-loader</h3> <p>​        用于将ES6+代码转换为ES5代码，以便在老版本浏览器上运行。它是Babel 官方提供的 Webpack 加载器，可以使用最新的 JavaScript 语言特性，同时确保代码在生产环境中的兼容性。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// webpack.config.js,添加一个新的规则来使用 babel-loader</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>  
      <span class="token punctuation">{</span>  
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>  
      <span class="token punctuation">}</span><span class="token punctuation">,</span>  
    <span class="token punctuation">]</span><span class="token punctuation">,</span>  
  <span class="token punctuation">}</span><span class="token punctuation">,</span>  
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// .babelrc,添加 Babel 的预设和插件</span>
<span class="token punctuation">{</span>  
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="prefetch和preload"><a href="#prefetch和preload" class="header-anchor">#</a> prefetch和preload</h3> <p>​        我们前面已经做了代码分割，同时会使用 import 动态导入语法来进行代码按需加载（我们也叫懒加载，比如路由懒加载就是这样实现的）。但是加载速度还不够好，比如：是用户点击按钮时才加载这个资源的，如果资源体积很大，那么用户会感觉到明显卡顿效果。我们想在浏览器空闲时间，加载后续需要使用的资源。我们就需要用上 Preload 或 Prefetch 技术。</p> <p>​        在声明import时，使用下面这些内置指令，可以让webpack输出resource hint（资源提示），来告知浏览器：</p> <ul><li>prefetch（预获取）：告诉浏览器在空闲时才开始加载资源。将来某些导航下可能需要的资源 ，即在浏览器网络空闲时再获取资源。</li> <li>preload（预加载）：告诉浏览器立即加载资源。当前导航下可能需要资源，和懒加载效果类似。</li></ul> <p>它们的共同点：</p> <ul><li>都只会加载资源，并不执行。</li> <li>都有缓存。</li></ul> <p>不同之处：</p> <ul><li>preload chunk 会在父 chunk 加载时，以并行方式开始加载。prefetch chunk 会在父 chunk 加载结束后开始加载。</li> <li>Preload加载优先级高，Prefetch加载优先级低。</li> <li>preload chunk 具有中等优先级，并立即下载。prefetch chunk 在浏览器闲置时下载。</li> <li>preload chunk 会在父 chunk 中立即请求，用于当下时刻。prefetch chunk 会用于未来的某个时刻。</li> <li>Preload只能加载当前页面需要使用的资源，Prefetch可以加载当前页面资源，也可以加载下一个页面需要使用的资源。</li></ul> <p>总结：</p> <ul><li>当前页面优先级高的资源用 Preload 加载。</li> <li>下一个页面需要使用的资源用 Prefetch 加载。</li></ul> <p>它们的问题：兼容性较差。</p> <ul><li>我们可以去 Can I Useopen in new window 网站查询 API 的兼容性问题。</li> <li>Preload 相对于 Prefetch 兼容性好一点。</li></ul> <h3 id="network-cache"><a href="#network-cache" class="header-anchor">#</a> Network Cache</h3> <p>​        开发时我们对静态资源会使用缓存来优化，这样浏览器第二次请求资源就能读取缓存了，速度很快。但是这样的话就会有一个问题, 因为前后输出的文件名是一样的，都叫 main.js，一旦将来发布新版本，因为文件名没有变化导致浏览器会直接读取缓存，不会加载新资源，项目也就没法更新了。所以我们从文件名入手，确保更新前后文件名不一样，这样就可以做缓存了。它们都会生成一个唯一的 hash 值。</p> <ul><li>fullhash（webpack4 是 hash）：每次修改任何一个文件，所有文件名的 hash 至都将改变。所以一旦修改了任何一个文件，整个项目的文件缓存都将失效。</li> <li>chunkhash：根据不同的入口文件(Entry)进行依赖文件解析、构建对应的 chunk，生成对应的哈希值。我们 js 和 css 是同一个引入，会共享一个 hash 值。</li> <li>contenthash：根据文件内容生成 hash 值，只有文件内容变化了，hash 值才会变化。所有文件 hash 值是独享且不同的。</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;../dist&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 生产模式需要输出</span>
    <span class="token comment">// [contenthash:8]使用contenthash，取8位长度</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;static/js/[name].[contenthash:8].js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 入口文件打包输出资源命名方式</span>
    <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token string">&quot;static/js/[name].[contenthash:8].chunk.js&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 动态导入输出资源命名方式</span>
    <span class="token literal-property property">assetModuleFilename</span><span class="token operator">:</span> <span class="token string">&quot;static/media/[name].[hash][ext]&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 图片、字体等资源命名方式（注意用hash）</span>
    <span class="token literal-property property">clean</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="prepack"><a href="#prepack" class="header-anchor">#</a> Prepack</h3> <p>​        Prepack 由 Facebook 开源，它采用较为激进的方法：在保持运行结果一致的情况下，改变源代码的运行逻辑，输出性能更高的 JavaScript 代码。 实际上 Prepack 就是一个部分求值器，编译代码时提前将计算结果放到编译后的代码中，而不是在代码运行时才去求值。Prepack 需要在 Webpack 输出最终的代码之前，对这些代码进行优化，就像 UglifyJS 那样。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> PrepackWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'prepack-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">PrepackWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="pwa"><a href="#pwa" class="header-anchor">#</a> PWA</h3> <p>​        开发 Web App 项目，项目一旦处于网络离线情况，就没法访问了。我们希望给项目提供离线体验。渐进式网络应用程序(progressive web application - PWA)：是一种可以提供类似于 native app(原生应用程序) 体验的 Web App 的技术。其中最重要的是，在离线(offline) 时应用程序能够继续运行功能。内部通过 Service Workers 技术实现的。</p> <blockquote><p>​        Service Worker是一个运行在浏览器背后的脚本，它独立于网页，可以在不依赖任何网页的情况下响应各种网络请求。它提供了一种拦截和处理网络请求、管理缓存和离线资源的能力，从而提供更好的网络性能和离线体验。
​        Service Worker的主要功能包括：
拦截网络请求：Service Worker可以拦截从浏览器发出的所有网络请求，包括对资源的请求。
缓存管理：Service Worker可以缓存网络请求的响应，以便在离线时提供离线内容。它还可以根据需要对缓存进行更新和替换。
推送通知：Service Worker可以接收推送消息，并在接收到消息时显示通知。
离线体验：通过拦截网络请求并缓存响应，Service Worker 可以提供更好的离线体验，即使在网络不可用时也能提供部分功能。
请求处理：Service Worker可以修改网络请求的响应，例如通过代理或修改内容来优化性能。
运行环境：Service Worker运行在Service Worker线程中，不共享主线程的资源。因此，它不会阻塞页面的渲染，提供了更好的性能和稳定性。
​        要使用Service Worker，需要在HTML文件中注册它，并在Service Worker脚本中编写拦截和处理网络请求的逻辑。一旦Service Worker注册成功，它将在后台运行并拦截网络请求。你可以利用这些功能来优化网页的性能、提供离线支持、实现推送通知等功能。</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> WorkboxPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;workbox-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
   <span class="token keyword">new</span> <span class="token class-name">WorkboxPlugin<span class="token punctuation">.</span>GenerateSW</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 这些选项帮助快速启用 ServiceWorkers</span>
      <span class="token comment">// 不允许遗留任何“旧的” ServiceWorkers</span>
      <span class="token literal-property property">clientsClaim</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token literal-property property">skipWaiting</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>这样配置后，生成的PWA应用将具有离线访问、全屏体验、搜索引擎友好等特性。</p> <h2 id="git-hooks与husky"><a href="#git-hooks与husky" class="header-anchor">#</a> git-hooks与husky</h2> <p>​        为了保证团队里的开发人员提交的代码符合规范，我们可以在开发者上传代码时进行校验。 我们常用 husky 来协助进行代码提交时的 eslint 校验。husky使git hooks更易于管理，因为我们不必手动编写代码，我们只需要在husky提供的配置文件中添加想要执行的命令，例如提交之前运行ESLint，除此之外的一切都由husky处理。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token string-property property">&quot;sctript&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
 <span class="token comment">//...others</span>
 <span class="token string-property property">&quot;prepare&quot;</span><span class="token operator">:</span> <span class="token string">&quot;husky install&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>prepare是一个npm钩子，意思是安装依赖的时候，会先执行husky install命令。 这个命令就做了以下三件事：</p> <ol><li>新增任意名称文件夹以及文件pre-commit(这个文件名比如跟要使用的git hook名字一致)</li> <li>执行以下命令来移交git-hook的配置权限</li> <li>给这个文件添加可执行权限</li></ol> <h2 id="常见的minimizer"><a href="#常见的minimizer" class="header-anchor">#</a> 常见的minimizer</h2> <p>​        确保你已经安装了要使用的minimizer对应的npm包，然后在配置文件中导入它们。</p> <h3 id="image-minimizer"><a href="#image-minimizer" class="header-anchor">#</a> Image Minimizer</h3> <p>​        开发如果项目中引用了较多图片，那么图片体积会比较大，将来请求速度比较慢。我们可以对图片进行压缩，减少图片体积。注意：如果项目中图片都是在线链接，那么就不需要了。本地项目静态图片才需要进行压缩。</p> <h3 id="terserplugin"><a href="#terserplugin" class="header-anchor">#</a> TerserPlugin</h3> <p>​        用于JavaScript压缩的插件。通过移除未使用的代码、缩小变量名、删除未使用的代码注释等方式，减少文件大小并提高加载性能。这是UglifyJsPlugin的一个分支，它提供了更好的压缩和更安全的代码拆分功能。它还支持ES6+的语法。</p> <h3 id="cssminimizerplugin"><a href="#cssminimizerplugin" class="header-anchor">#</a> cssMinimizerPlugin</h3> <p>用于压缩CSS代码，移除未使用的样式和冗余的代码。css压缩也可以写optimization.minimizer里面，效果一样的。</p> <h3 id="htmlwebpackplugin"><a href="#htmlwebpackplugin" class="header-anchor">#</a> HtmlWebpackPlugin</h3> <p>​        用于HTML压缩的插件，通过简化HTML标签、移除未使用的HTML元素等方式，减少HTML文件大小并提高加载性能。可以帮助生成HTML文件，并将所有资源链接到生成的HTML文件中。</p> <h2 id="环境变量"><a href="#环境变量" class="header-anchor">#</a> 环境变量</h2> <p>​        想要消除 webpack.config.js 在开发环境和生产环境之间的差异，需要环境变量。webpack命令行环境配置的 --env 参数，可以允许传入任意数量的环境变量。而webpack.config.js 中可以访问到这些环境变量。例如，--env production 或--env goal=local。</p> <ul><li>npx webpack --env production 可以通过命令传入变量区分环境</li></ul> <p>​        通常，module.exports 指向配置对象。当你在 webpack.config.js 中使用环境变量时，你需要将 module.exports （抛出对象）转换为函数，以便能够动态地传递参数。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//...  </span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">env</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
  <span class="token keyword">return</span> <span class="token punctuation">{</span>  
    <span class="token comment">//...  </span>
    <span class="token comment">// 根据命令行参数 env 来设置不同环境的 mode  </span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> env<span class="token punctuation">.</span>production <span class="token operator">?</span> <span class="token string">'production'</span> <span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>  
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>    
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>    
      <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    
      <span class="token comment">//当 env.production 为真时, 设置为 'bundle.min.js'，否则设置为 'bundle.js'</span>
      <span class="token literal-property property">filename</span><span class="token operator">:</span> env<span class="token punctuation">.</span>production <span class="token operator">?</span> <span class="token string">'bundle.min.js'</span> <span class="token operator">:</span> <span class="token string">'bundle.js'</span>    
    <span class="token punctuation">}</span><span class="token punctuation">,</span>    
    <span class="token comment">// 其他配置...   </span>
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>在上面的示例中，我们通过将 module.exports 对象转换为函数，并传递一个名为 env 的参数，来访问环境变量。然后，我们根据环境变量的值来动态配置 webpack 的输出文件名和环境mode。</p> <h2 id="编写loader和plugin"><a href="#编写loader和plugin" class="header-anchor">#</a> 编写loader和plugin</h2> <ul><li>loader像一个翻译官，把读到的源文件内容转译成新的文件内容，并且每个loader通过链式操作，把源文件一步步翻译成我们想要的样子。①编写loader要遵循单一原则，每个loader只做一种转译工作，②每个loader拿到的是源文件内容，可以通过返回值的方式将处理后的内容输出，③也可以调用this.callback()方法，将内容返回给webpack，④还可以通过this.async()生成一个callback函数，再用它将处理后的内容输出去。</li></ul> <blockquote><p>在编写 loader 前，我们首先需要了解 loader 的本质
其本质为函数，函数中的 this 作为上下文会被 webpack 填充，因此我们不能将 loader设为一个箭头函数
函数接受一个参数，为 webpack 传递给 loader 的文件源内容
函数中 this 是由 webpack 提供的对象，能够获取当前 loader 所需要的各种信息
函数中有异步操作或同步操作，异步操作通过 this.callback 返回，返回值要求为 string 或者 Buffer</p></blockquote> <div class="language-JavaScript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 导出一个函数，source为webpack传递给loader的文件源内容</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token function">doSomeThing2JsString</span><span class="token punctuation">(</span>source<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 如果 loader 配置了 options 对象，那么this.query将指向 options</span>
    <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>query<span class="token punctuation">;</span>
    
    <span class="token comment">// 可以用作解析其他模块路径的上下文</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'this.context'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">/*
     * this.callback 参数：
     * error：Error | null，当 loader 出错时向外抛出一个 error
     * content：String | Buffer，经过 loader 编译后需要导出的内容
     * sourceMap：为方便调试生成的编译后内容的 source map
     * ast：本次编译生成的 AST 静态语法树，之后执行的 loader 可以直接使用这个 AST，进而省去重复生成 AST 的过程
     */</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 异步</span>
    <span class="token keyword">return</span> content<span class="token punctuation">;</span> <span class="token comment">// 同步</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><blockquote><p>一般在编写loader的过程中，保持功能单一，避免做多种功能
如less文件转换成 css文件也不是一步到位，而是 less-loader、css-loader、style-loader几个 loader的链式调用才能完成转换</p></blockquote> <p>编写 loader：</p> <p>①安装依赖：首先，确保你已经安装了 webpack 和 webpack-cli。然后，安装 loader 的相关依赖。例如，如果你想编写一个处理 JavaScript 文件的 loader，你可能需要安装 babel-loader。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack webpack-cli babel-loader @babel/core @babel/preset-env
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>②创建 loader 文件：在项目的根目录下创建一个新文件，例如 my-loader.js。</p> <p>③编写 loader 代码：在这个文件中，你需要实现一个函数，该函数接收一个参数（包含文件内容、文件路径等信息的对象），并返回一个处理后的文件内容。以下是一个简单的 JavaScript loader 示例：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 引入 @babel/core，它提供了 Babel 的核心功能。  </span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> addBabelPlugin<span class="token punctuation">,</span> addBabelPresets <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/core'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token comment">// 定义一个函数，该函数接收一个参数（包含文件内容、文件路径等信息的对象），并返回一个处理后的文件内容。  </span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
  <span class="token comment">// 标记该 loader 可以被缓存，以提高性能。  </span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cacheable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token comment">// 异步回调函数，用于在处理完文件后调用。  </span>
  <span class="token keyword">const</span> callback <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token comment">// 定义 Babel 配置选项。这里使用 @babel/preset-env 作为预设，并添加 transform-react-jsx 插件。  </span>
  <span class="token keyword">const</span> babelOptions <span class="token operator">=</span> <span class="token punctuation">{</span>  
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">addBabelPlugin</span><span class="token punctuation">(</span><span class="token string">'transform-react-jsx'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
    <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">addBabelPresets</span><span class="token punctuation">(</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
  <span class="token punctuation">}</span><span class="token punctuation">;</span>  
  <span class="token comment">// 使用 Babel 转换源代码，并返回转换后的代码。  </span>
  <span class="token keyword">return</span> babel<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>source<span class="token punctuation">,</span> babelOptions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> code <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
    <span class="token comment">// 在转换完成后，调用回调函数并传递结果。  </span>
    <span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>④导出 loader：在 webpack.config.js 文件中，使用 module.exports 导出你的 loader。例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>  
      <span class="token punctuation">{</span>  
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>  
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token string">'my-loader'</span><span class="token punctuation">,</span>  
      <span class="token punctuation">}</span><span class="token punctuation">,</span>  
    <span class="token punctuation">]</span><span class="token punctuation">,</span>  
  <span class="token punctuation">}</span><span class="token punctuation">,</span>  
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>plugin编写比较灵活。webpack在运行的生命周期中会广播出许多事件，plugin可以监听这些事件，在合适的时机通过webpack提供的API改变输出结果。</li></ul> <p>编写 plugin：</p> <blockquote><p>由于webpack基于发布订阅模式，在运行的生命周期中会广播出许多事件，插件通过监听这些事件，就可以在特定的阶段执行自己的插件任务
在之前也了解过，webpack编译会创建两个核心对象：
compiler：包含了 webpack 环境的所有的配置信息，包括 options，loader 和 plugin，和 webpack 整个生命周期相关的钩子
compilation：作为 plugin 内置事件回调函数的参数，包含了当前的模块资源、编译生成资源、变化的文件以及被跟踪依赖的状态信息。当检测到一个文件变化，一次新的 Compilation 将被创建
如果自己要实现plugin，也需要遵循一定的规范：
插件必须是一个函数或者是一个包含 apply 方法的对象，这样才能访问compiler实例
传给每个插件的 compiler 和 compilation 对象都是同一个引用，因此不建议修改
异步的事件需要在插件处理完任务时调用回调函数通知 Webpack 进入下一个流程，不然会卡住</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//实现plugin的模板如下：</span>
<span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token punctuation">{</span>
    <span class="token comment">// Webpack 会调用 MyPlugin 实例的 apply 方法给插件实例传入 compiler 对象</span>
  <span class="token function">apply</span> <span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 找到合适的事件钩子，实现自己的插件功能</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'MyPlugin'</span><span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// compilation: 当前打包构建流程的上下文</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>compilation<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// do something...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><blockquote><p>在emit事件发生时，代表源文件的转换和组装已经完成，可以读取到最终将输出的资源、代码块、模块及其依赖，并且可以修改输出资源的内容</p></blockquote> <p>①创建 plugin 文件：在项目的根目录下创建一个新文件，例如 my-plugin.js。</p> <p>②编写 plugin 代码：在这个文件中，你需要实现一个类，该类继承自 Plugin 类，并实现至少一个方法（如 apply）。以下是一个简单的 JavaScript plugin 示例：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 定义一个类，该类继承自 webpack 的 Plugin 类。  </span>
<span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token punctuation">{</span>  
  <span class="token comment">// 定义一个方法，该方法将在插件被应用时被调用。这里使用 tapAsync 方法在插件被应用时执行异步操作。  </span>
  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">'MyPlugin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>  
      <span class="token comment">// 在这里执行你想要的操作，例如修改文件内容或添加新的依赖项。  </span>
      <span class="token comment">// 在这里添加注释说明你的插件会做的事情。例如：修改文件内容或添加新的依赖项。  </span>
      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  <span class="token punctuation">}</span>  
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>③导出 plugin：在 webpack.config.js 文件中，使用 module.exports 导出你的 plugin。例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> MyPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./my-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  
  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">MyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2024/7/2 07:49:41</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/vivien-blog/books/深入浅出webpack/为什么要使用webpack.html" class="prev">
          为什么要使用webpack
        </a></span> <span class="next"><a href="/vivien-blog/books/深入浅出webpack/手动使用webpack.html">
          手动使用webpack
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-9f22dc18 data-v-222e0b9d><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#webpack-配置文件与核心概念" class="sidebar-link reco-side-webpack-配置文件与核心概念" data-v-9f22dc18>Webpack 配置文件与核心概念</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#webpack的使用步骤" class="sidebar-link reco-side-webpack的使用步骤" data-v-9f22dc18>webpack的使用步骤</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#loader" class="sidebar-link reco-side-loader" data-v-9f22dc18>loader</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#file-loader-和url-loader" class="sidebar-link reco-side-file-loader-和url-loader" data-v-9f22dc18>file-loader 和url-loader</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#parser和noparse" class="sidebar-link reco-side-parser和noparse" data-v-9f22dc18>parser和noParse</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#oneof" class="sidebar-link reco-side-oneof" data-v-9f22dc18>OneOf</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#cache" class="sidebar-link reco-side-cache" data-v-9f22dc18>cache</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#thread" class="sidebar-link reco-side-thread" data-v-9f22dc18>Thread</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#plugins" class="sidebar-link reco-side-plugins" data-v-9f22dc18>plugins</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#devserver" class="sidebar-link reco-side-devserver" data-v-9f22dc18>devServer</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#优化和生产配置" class="sidebar-link reco-side-优化和生产配置" data-v-9f22dc18>优化和生产配置</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#resolve" class="sidebar-link reco-side-resolve" data-v-9f22dc18>resolve</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#include-exclude" class="sidebar-link reco-side-include-exclude" data-v-9f22dc18>include/exclude</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#sourcemap" class="sidebar-link reco-side-sourcemap" data-v-9f22dc18>sourceMap</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#tree-shaking" class="sidebar-link reco-side-tree-shaking" data-v-9f22dc18>Tree-shaking</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#core-js" class="sidebar-link reco-side-core-js" data-v-9f22dc18>Core-js</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#paralleluglifyplugin" class="sidebar-link reco-side-paralleluglifyplugin" data-v-9f22dc18>ParallelUglifyPlugin</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#dllplugin-动态链接库" class="sidebar-link reco-side-dllplugin-动态链接库" data-v-9f22dc18>DllPlugin-动态链接库</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#code-split-代码分割" class="sidebar-link reco-side-code-split-代码分割" data-v-9f22dc18>Code Split-代码分割</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#externals" class="sidebar-link reco-side-externals" data-v-9f22dc18>Externals</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#happypack" class="sidebar-link reco-side-happypack" data-v-9f22dc18>happypack</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#postcss和css" class="sidebar-link reco-side-postcss和css" data-v-9f22dc18>PostCSS和CSS</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#babel-loader" class="sidebar-link reco-side-babel-loader" data-v-9f22dc18>babel-loader</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#prefetch和preload" class="sidebar-link reco-side-prefetch和preload" data-v-9f22dc18>prefetch和preload</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#network-cache" class="sidebar-link reco-side-network-cache" data-v-9f22dc18>Network Cache</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#prepack" class="sidebar-link reco-side-prepack" data-v-9f22dc18>Prepack</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#pwa" class="sidebar-link reco-side-pwa" data-v-9f22dc18>PWA</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#git-hooks与husky" class="sidebar-link reco-side-git-hooks与husky" data-v-9f22dc18>git-hooks与husky</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#常见的minimizer" class="sidebar-link reco-side-常见的minimizer" data-v-9f22dc18>常见的minimizer</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#image-minimizer" class="sidebar-link reco-side-image-minimizer" data-v-9f22dc18>Image Minimizer</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#terserplugin" class="sidebar-link reco-side-terserplugin" data-v-9f22dc18>TerserPlugin</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#cssminimizerplugin" class="sidebar-link reco-side-cssminimizerplugin" data-v-9f22dc18>cssMinimizerPlugin</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#htmlwebpackplugin" class="sidebar-link reco-side-htmlwebpackplugin" data-v-9f22dc18>HtmlWebpackPlugin</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#环境变量" class="sidebar-link reco-side-环境变量" data-v-9f22dc18>环境变量</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/books/%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAwebpack/webpack%E7%9A%84%E4%BD%BF%E7%94%A8.html#编写loader和plugin" class="sidebar-link reco-side-编写loader和plugin" data-v-9f22dc18>编写loader和plugin</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-2a01419c data-v-2a01419c><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-2a01419c><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-2a01419c></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-2a01419c></path></svg></div></div></div>
    <script src="/vivien-blog/assets/js/app.53ebd2d0.js" defer></script><script src="/vivien-blog/assets/js/7.210383a7.js" defer></script><script src="/vivien-blog/assets/js/2.00d63d32.js" defer></script><script src="/vivien-blog/assets/js/1.96251043.js" defer></script><script src="/vivien-blog/assets/js/64.edfb07df.js" defer></script>
  </body>
</html>
