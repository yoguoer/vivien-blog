<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>半自动化部署 | Vivien&#39;s Notebook</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/vivien-blog/logo.jpg">
    <script src="/vivien-blog/watermark.js"></script>
    <meta name="description" content="Vivien个人博客">
    
    <link rel="preload" href="/vivien-blog/assets/css/0.styles.4edee94f.css" as="style"><link rel="preload" href="/vivien-blog/assets/js/app.6cea8693.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/7.ec60f3e8.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/2.6744b811.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/1.4a3363c7.js" as="script"><link rel="preload" href="/vivien-blog/assets/js/77.7a8e0bfc.js" as="script"><link rel="prefetch" href="/vivien-blog/assets/js/10.4c4f923d.js"><link rel="prefetch" href="/vivien-blog/assets/js/100.23f6ee21.js"><link rel="prefetch" href="/vivien-blog/assets/js/101.27280ff0.js"><link rel="prefetch" href="/vivien-blog/assets/js/102.036dcfc2.js"><link rel="prefetch" href="/vivien-blog/assets/js/103.dd57924a.js"><link rel="prefetch" href="/vivien-blog/assets/js/104.c64926ce.js"><link rel="prefetch" href="/vivien-blog/assets/js/105.ae22082c.js"><link rel="prefetch" href="/vivien-blog/assets/js/106.407a6b6f.js"><link rel="prefetch" href="/vivien-blog/assets/js/107.c8a4dfa2.js"><link rel="prefetch" href="/vivien-blog/assets/js/108.9c61cc83.js"><link rel="prefetch" href="/vivien-blog/assets/js/109.c1172022.js"><link rel="prefetch" href="/vivien-blog/assets/js/11.c96b7ce6.js"><link rel="prefetch" href="/vivien-blog/assets/js/110.a8a43b83.js"><link rel="prefetch" href="/vivien-blog/assets/js/111.4c5d72c5.js"><link rel="prefetch" href="/vivien-blog/assets/js/112.31c468c6.js"><link rel="prefetch" href="/vivien-blog/assets/js/113.7c8ad5fd.js"><link rel="prefetch" href="/vivien-blog/assets/js/114.2919ddce.js"><link rel="prefetch" href="/vivien-blog/assets/js/115.9492e6b7.js"><link rel="prefetch" href="/vivien-blog/assets/js/116.da465a8b.js"><link rel="prefetch" href="/vivien-blog/assets/js/117.d5a69554.js"><link rel="prefetch" href="/vivien-blog/assets/js/118.4dae8780.js"><link rel="prefetch" href="/vivien-blog/assets/js/119.e61066ef.js"><link rel="prefetch" href="/vivien-blog/assets/js/120.95523cfb.js"><link rel="prefetch" href="/vivien-blog/assets/js/121.7279e08a.js"><link rel="prefetch" href="/vivien-blog/assets/js/122.1946f5d1.js"><link rel="prefetch" href="/vivien-blog/assets/js/123.1d46e7f2.js"><link rel="prefetch" href="/vivien-blog/assets/js/124.0e99b17d.js"><link rel="prefetch" href="/vivien-blog/assets/js/125.e4ce0029.js"><link rel="prefetch" href="/vivien-blog/assets/js/126.9e0257d6.js"><link rel="prefetch" href="/vivien-blog/assets/js/127.258e05ea.js"><link rel="prefetch" href="/vivien-blog/assets/js/128.19174f18.js"><link rel="prefetch" href="/vivien-blog/assets/js/129.a953a1b8.js"><link rel="prefetch" href="/vivien-blog/assets/js/130.cd9ca58a.js"><link rel="prefetch" href="/vivien-blog/assets/js/131.bf7582dc.js"><link rel="prefetch" href="/vivien-blog/assets/js/132.60d3ae71.js"><link rel="prefetch" href="/vivien-blog/assets/js/14.dac78458.js"><link rel="prefetch" href="/vivien-blog/assets/js/15.30ff7af8.js"><link rel="prefetch" href="/vivien-blog/assets/js/16.f5bca61b.js"><link rel="prefetch" href="/vivien-blog/assets/js/17.7fea8ba1.js"><link rel="prefetch" href="/vivien-blog/assets/js/18.8a66241c.js"><link rel="prefetch" href="/vivien-blog/assets/js/19.9f2773f4.js"><link rel="prefetch" href="/vivien-blog/assets/js/20.7b40b439.js"><link rel="prefetch" href="/vivien-blog/assets/js/21.53d462a3.js"><link rel="prefetch" href="/vivien-blog/assets/js/22.de88dfed.js"><link rel="prefetch" href="/vivien-blog/assets/js/23.f2b02a6d.js"><link rel="prefetch" href="/vivien-blog/assets/js/24.e9a7a488.js"><link rel="prefetch" href="/vivien-blog/assets/js/25.9f932c51.js"><link rel="prefetch" href="/vivien-blog/assets/js/26.bf9dc0fe.js"><link rel="prefetch" href="/vivien-blog/assets/js/27.806995a3.js"><link rel="prefetch" href="/vivien-blog/assets/js/28.42a6ae8d.js"><link rel="prefetch" href="/vivien-blog/assets/js/29.f3069a68.js"><link rel="prefetch" href="/vivien-blog/assets/js/3.7a6d346e.js"><link rel="prefetch" href="/vivien-blog/assets/js/30.a0c45895.js"><link rel="prefetch" href="/vivien-blog/assets/js/31.a10b30c7.js"><link rel="prefetch" href="/vivien-blog/assets/js/32.4c227bf7.js"><link rel="prefetch" href="/vivien-blog/assets/js/33.9873b2e4.js"><link rel="prefetch" href="/vivien-blog/assets/js/34.661b84b0.js"><link rel="prefetch" href="/vivien-blog/assets/js/35.e6dccfdc.js"><link rel="prefetch" href="/vivien-blog/assets/js/36.98205037.js"><link rel="prefetch" href="/vivien-blog/assets/js/37.4a9dc5bf.js"><link rel="prefetch" href="/vivien-blog/assets/js/38.dc9c4a51.js"><link rel="prefetch" href="/vivien-blog/assets/js/39.be23166d.js"><link rel="prefetch" href="/vivien-blog/assets/js/4.6d6477a3.js"><link rel="prefetch" href="/vivien-blog/assets/js/40.e5f670f0.js"><link rel="prefetch" href="/vivien-blog/assets/js/41.236d900a.js"><link rel="prefetch" href="/vivien-blog/assets/js/42.67482f69.js"><link rel="prefetch" href="/vivien-blog/assets/js/43.1de2024a.js"><link rel="prefetch" href="/vivien-blog/assets/js/44.7ddd9470.js"><link rel="prefetch" href="/vivien-blog/assets/js/45.31587bf5.js"><link rel="prefetch" href="/vivien-blog/assets/js/46.8616ff54.js"><link rel="prefetch" href="/vivien-blog/assets/js/47.d3d247b3.js"><link rel="prefetch" href="/vivien-blog/assets/js/48.927b0f38.js"><link rel="prefetch" href="/vivien-blog/assets/js/49.8e7e832e.js"><link rel="prefetch" href="/vivien-blog/assets/js/5.8f70aa2d.js"><link rel="prefetch" href="/vivien-blog/assets/js/50.e8d25d24.js"><link rel="prefetch" href="/vivien-blog/assets/js/51.e8251262.js"><link rel="prefetch" href="/vivien-blog/assets/js/52.fbef7aa0.js"><link rel="prefetch" href="/vivien-blog/assets/js/53.2b707def.js"><link rel="prefetch" href="/vivien-blog/assets/js/54.b5188815.js"><link rel="prefetch" href="/vivien-blog/assets/js/55.8b80c528.js"><link rel="prefetch" href="/vivien-blog/assets/js/56.ff6f8345.js"><link rel="prefetch" href="/vivien-blog/assets/js/57.ddbebf8b.js"><link rel="prefetch" href="/vivien-blog/assets/js/58.b4c57804.js"><link rel="prefetch" href="/vivien-blog/assets/js/59.a035b4e8.js"><link rel="prefetch" href="/vivien-blog/assets/js/6.892ce6e5.js"><link rel="prefetch" href="/vivien-blog/assets/js/60.b8bfb276.js"><link rel="prefetch" href="/vivien-blog/assets/js/61.843f60af.js"><link rel="prefetch" href="/vivien-blog/assets/js/62.51cffd1c.js"><link rel="prefetch" href="/vivien-blog/assets/js/63.91b00a61.js"><link rel="prefetch" href="/vivien-blog/assets/js/64.48a3a79a.js"><link rel="prefetch" href="/vivien-blog/assets/js/65.6c36e44e.js"><link rel="prefetch" href="/vivien-blog/assets/js/66.8e9ea32a.js"><link rel="prefetch" href="/vivien-blog/assets/js/67.18095c46.js"><link rel="prefetch" href="/vivien-blog/assets/js/68.f74a0870.js"><link rel="prefetch" href="/vivien-blog/assets/js/69.4e844f29.js"><link rel="prefetch" href="/vivien-blog/assets/js/70.41013b20.js"><link rel="prefetch" href="/vivien-blog/assets/js/71.26e44e39.js"><link rel="prefetch" href="/vivien-blog/assets/js/72.be7cf2c3.js"><link rel="prefetch" href="/vivien-blog/assets/js/73.1808562e.js"><link rel="prefetch" href="/vivien-blog/assets/js/74.d3cdb9ff.js"><link rel="prefetch" href="/vivien-blog/assets/js/75.56b600ce.js"><link rel="prefetch" href="/vivien-blog/assets/js/76.7bc9c5d1.js"><link rel="prefetch" href="/vivien-blog/assets/js/78.51f45190.js"><link rel="prefetch" href="/vivien-blog/assets/js/79.ff61e0ac.js"><link rel="prefetch" href="/vivien-blog/assets/js/8.b0ba342b.js"><link rel="prefetch" href="/vivien-blog/assets/js/80.baa5d407.js"><link rel="prefetch" href="/vivien-blog/assets/js/81.285bac2c.js"><link rel="prefetch" href="/vivien-blog/assets/js/82.f50cbf20.js"><link rel="prefetch" href="/vivien-blog/assets/js/83.6440b662.js"><link rel="prefetch" href="/vivien-blog/assets/js/84.bfd378d6.js"><link rel="prefetch" href="/vivien-blog/assets/js/85.563bf7c2.js"><link rel="prefetch" href="/vivien-blog/assets/js/86.3eab528c.js"><link rel="prefetch" href="/vivien-blog/assets/js/87.cc2933f4.js"><link rel="prefetch" href="/vivien-blog/assets/js/88.5ed12de4.js"><link rel="prefetch" href="/vivien-blog/assets/js/89.12e1a1e4.js"><link rel="prefetch" href="/vivien-blog/assets/js/9.524cff04.js"><link rel="prefetch" href="/vivien-blog/assets/js/90.e4e40c40.js"><link rel="prefetch" href="/vivien-blog/assets/js/91.d28d824d.js"><link rel="prefetch" href="/vivien-blog/assets/js/92.88c3e050.js"><link rel="prefetch" href="/vivien-blog/assets/js/93.45a553ea.js"><link rel="prefetch" href="/vivien-blog/assets/js/94.74a76eb1.js"><link rel="prefetch" href="/vivien-blog/assets/js/95.6314d68a.js"><link rel="prefetch" href="/vivien-blog/assets/js/96.0def9066.js"><link rel="prefetch" href="/vivien-blog/assets/js/97.1010a1a2.js"><link rel="prefetch" href="/vivien-blog/assets/js/98.5dd57b30.js"><link rel="prefetch" href="/vivien-blog/assets/js/99.b01b0c86.js"><link rel="prefetch" href="/vivien-blog/assets/js/vendors~docsearch.da1394aa.js">
    <link rel="stylesheet" href="/vivien-blog/assets/css/0.styles.4edee94f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-222e0b9d><div data-v-222e0b9d><div class="password-shadow password-wrapper-out" style="display:none;" data-v-15719524 data-v-222e0b9d data-v-222e0b9d><h3 class="title" data-v-15719524>Vivien's Notebook</h3> <p class="description" data-v-15719524>Vivien个人博客</p> <label id="box" class="inputBox" data-v-15719524><input type="password" value="" data-v-15719524> <span data-v-15719524>Konck! Knock!</span> <button data-v-15719524>OK</button></label> <div class="footer" data-v-15719524><span data-v-15719524><i class="iconfont reco-theme" data-v-15719524></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-15719524>vuePress-theme-reco</a></span> <span data-v-15719524><i class="iconfont reco-copyright" data-v-15719524></i> <a data-v-15719524><!---->
          
        <!---->
        2025
      </a></span></div></div> <div class="hide" data-v-222e0b9d><header class="navbar" data-v-222e0b9d><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vivien-blog/" class="home-link router-link-active"><img src="/vivien-blog/logo.jpg" alt="Vivien's Notebook" class="logo"> <span class="site-name">Vivien's Notebook</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vivien-blog/base/browser/输入URL到页面展示发生了什么/" class="nav-link"><i class="undefined"></i>
  前端基础
</a></div><div class="nav-item"><a href="/vivien-blog/Vue/Vue3学习笔记/Vue3与Vue2对比/" class="nav-link"><i class="undefined"></i>
  Vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      微前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端基础知识/" class="nav-link"><i class="undefined"></i>
  微前端基础知识
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端解决方案/" class="nav-link"><i class="undefined"></i>
  微前端解决方案
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/使用MicroApp重构旧项目/" class="nav-link"><i class="undefined"></i>
  使用MicroApp重构旧项目
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      前端工程化
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/代码规范/概述/" class="nav-link"><i class="undefined"></i>
  代码规范
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/webpack/webpack执行流程/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/CICD/半自动化部署/" class="nav-link"><i class="undefined"></i>
  CICD
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/渲染架构/前端渲染模式/" class="nav-link"><i class="undefined"></i>
  架构&amp;方案
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      书籍
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/books/深入浅出webpack/为什么要使用webpack/" class="nav-link"><i class="undefined"></i>
  深入浅出webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/ES6入门教程/ES6与JavaScript/" class="nav-link"><i class="undefined"></i>
  ES6入门教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/TypeScript教程/简介和基本用法/" class="nav-link"><i class="undefined"></i>
  TypeScript教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/Vue.js设计与实现/1.权衡的艺术/" class="nav-link"><i class="undefined"></i>
  Vue.js设计与实现
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      项目实践
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/project/权限控制/权限控制基础知识/" class="nav-link"><i class="undefined"></i>
  权限控制
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/project/项目搭建/搭建一个组件库/" class="nav-link"><i class="undefined"></i>
  项目搭建
</a></li></ul></div></div><div class="nav-item"><a href="/vivien-blog/React/React基础知识/" class="nav-link"><i class="undefined"></i>
  React
</a></div><div class="nav-item"><a href="/vivien-blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/vivien-blog/messageBoard/messageBoard.html" class="nav-link"><i class="iconfont reco-message"></i>
  留言板
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      contact Vivien
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/yoguoer" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Vivien_CC" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-222e0b9d></div> <aside class="sidebar" data-v-222e0b9d><div class="personal-info-wrapper" data-v-2710484f data-v-222e0b9d><img src="/vivien-blog/avator.jpg" alt="author-avatar" class="personal-img" data-v-2710484f> <!----> <div class="num" data-v-2710484f><div data-v-2710484f><h3 data-v-2710484f>92</h3> <h6 data-v-2710484f>文章</h6></div> <div data-v-2710484f><h3 data-v-2710484f>11</h3> <h6 data-v-2710484f>标签</h6></div></div> <ul class="social-links" data-v-2710484f><li class="social-item" data-v-2710484f><i class="iconfont reco-github" style="color:#f26d6d;" data-v-2710484f></i></li></ul> <hr data-v-2710484f></div> <nav class="nav-links"><div class="nav-item"><a href="/vivien-blog/base/browser/输入URL到页面展示发生了什么/" class="nav-link"><i class="undefined"></i>
  前端基础
</a></div><div class="nav-item"><a href="/vivien-blog/Vue/Vue3学习笔记/Vue3与Vue2对比/" class="nav-link"><i class="undefined"></i>
  Vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      微前端
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端基础知识/" class="nav-link"><i class="undefined"></i>
  微前端基础知识
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/微前端解决方案/" class="nav-link"><i class="undefined"></i>
  微前端解决方案
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/MicroFrontends/使用MicroApp重构旧项目/" class="nav-link"><i class="undefined"></i>
  使用MicroApp重构旧项目
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      前端工程化
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/代码规范/概述/" class="nav-link"><i class="undefined"></i>
  代码规范
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/webpack/webpack执行流程/" class="nav-link"><i class="undefined"></i>
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/CICD/半自动化部署/" class="nav-link"><i class="undefined"></i>
  CICD
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/devops/渲染架构/前端渲染模式/" class="nav-link"><i class="undefined"></i>
  架构&amp;方案
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      书籍
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/books/深入浅出webpack/为什么要使用webpack/" class="nav-link"><i class="undefined"></i>
  深入浅出webpack
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/ES6入门教程/ES6与JavaScript/" class="nav-link"><i class="undefined"></i>
  ES6入门教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/TypeScript教程/简介和基本用法/" class="nav-link"><i class="undefined"></i>
  TypeScript教程
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/books/Vue.js设计与实现/1.权衡的艺术/" class="nav-link"><i class="undefined"></i>
  Vue.js设计与实现
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="undefined"></i>
      项目实践
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vivien-blog/project/权限控制/权限控制基础知识/" class="nav-link"><i class="undefined"></i>
  权限控制
</a></li><li class="dropdown-item"><!----> <a href="/vivien-blog/project/项目搭建/搭建一个组件库/" class="nav-link"><i class="undefined"></i>
  项目搭建
</a></li></ul></div></div><div class="nav-item"><a href="/vivien-blog/React/React基础知识/" class="nav-link"><i class="undefined"></i>
  React
</a></div><div class="nav-item"><a href="/vivien-blog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><a href="/vivien-blog/messageBoard/messageBoard.html" class="nav-link"><i class="iconfont reco-message"></i>
  留言板
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      contact Vivien
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/yoguoer" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/Vivien_CC" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="undefined"></i>
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>代码规范</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vivien-blog/devops/代码规范/概述.html" class="sidebar-link">概述</a></li><li><a href="/vivien-blog/devops/代码规范/项目风格统一[.editorconfig].html" class="sidebar-link">项目风格统一[.editorconfig]</a></li><li><a href="/vivien-blog/devops/代码规范/CSS格式规范[.stylelintrc].html" class="sidebar-link">CSS格式规范[.stylelintrc]</a></li><li><a href="/vivien-blog/devops/代码规范/JS代码规范[.eslintrc+.prettierrc].html" class="sidebar-link">JS代码规范[.eslintrc+.prettierrc]</a></li><li><a href="/vivien-blog/devops/代码规范/Git提交信息规范[commitlint+cz-git].html" class="sidebar-link">Git提交信息规范[commitlint+cz-git]</a></li><li><a href="/vivien-blog/devops/代码规范/Git工作流规范[husky+lint-staged].html" class="sidebar-link">Git工作流规范[husky+lint-staged]</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>webpack</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vivien-blog/devops/webpack/webpack执行流程.html" class="sidebar-link">webpack执行流程</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>CICD</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vivien-blog/devops/CICD/半自动化部署.html" class="active sidebar-link">半自动化部署</a></li><li><a href="/vivien-blog/devops/CICD/gitlabCICD.html" class="sidebar-link">gitlab CICD</a></li><li><a href="/vivien-blog/devops/CICD/一次gitlab CICD实践.html" class="sidebar-link">一次gitlab CICD实践</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>架构&amp;方案</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vivien-blog/devops/渲染架构/前端渲染模式.html" class="sidebar-link">前端渲染模式</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-15719524 data-v-222e0b9d><h3 class="title" data-v-15719524>半自动化部署</h3> <!----> <label id="box" class="inputBox" data-v-15719524><input type="password" value="" data-v-15719524> <span data-v-15719524>Konck! Knock!</span> <button data-v-15719524>OK</button></label> <div class="footer" data-v-15719524><span data-v-15719524><i class="iconfont reco-theme" data-v-15719524></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-15719524>vuePress-theme-reco</a></span> <span data-v-15719524><i class="iconfont reco-copyright" data-v-15719524></i> <a data-v-15719524><!---->
          
        <!---->
        2025
      </a></span></div></div> <div data-v-222e0b9d><div data-v-222e0b9d><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">半自动化部署</h1> <div data-v-f31d237c><i class="iconfont reco-account" data-v-f31d237c><span data-v-f31d237c>vivien</span></i> <i class="iconfont reco-date" data-v-f31d237c><span data-v-f31d237c>2024/8/20</span></i> <i class="iconfont reco-eye" data-v-f31d237c><span id="/vivien-blog/devops/CICD/%E5%8D%8A%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-f31d237c><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-f31d237c><span class="tag-item" data-v-f31d237c>Devops</span></i></div></div> <div class="theme-reco-content content__default"><p>传统的前端部署往往需要经历几个阶段：</p> <p><img src="data:image/png;base64,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" alt="image-20240820090208460"></p> <p>​	对于这一过程我们往往可以通过CI/CD方法进行优化。在没有用 Gitlab 或者 Jenkins 等工具之前，我们也可以通过在项目中增加一些脚本来实现自动打包部署的过程。虽然需要手动执行一些指令，但还是大大减少了工作量，也减少了因手动上传而出现一些错误。</p> <h2 id="自动更新版本号"><a href="#自动更新版本号" class="header-anchor">#</a> 自动更新版本号</h2> <p>​	对于一些需要上传到私有 npm 镜像上的项目，每次发布时，我们都需要去更改 package.json 中的版本号，确保上传的版本号无重复。而一些 monorepo 项目里有很多个 package.json 文件，例如组件库项目，手动更改极其容易遗漏，无法保证版本号一致性，所以我们需要一个自动更新版本号的脚本。</p> <ul><li>changeVersion.ts</li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> chalk <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'chalk'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fsPromises <span class="token operator">=</span> fs<span class="token punctuation">.</span>promises<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">pathResolve</span> <span class="token operator">=</span> <span class="token punctuation">(</span>target<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../packages/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>target<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span>

<span class="token comment">/**
 * 修改所有packages的版本号
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">changeVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> version <span class="token operator">=</span> <span class="token function">getVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 输出提示信息</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">blue</span><span class="token punctuation">(</span><span class="token string">'正在更改版本号:version ...'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">// 获取项目根路径</span>
  <span class="token keyword">const</span> rootPackages <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../package.json'</span><span class="token punctuation">)</span>
  <span class="token comment">// 向项目根路径 package.json 文件写入版本号</span>
  <span class="token function">setPackagesVersion</span><span class="token punctuation">(</span>rootPackages<span class="token punctuation">,</span> version<span class="token punctuation">)</span>
  <span class="token comment">// 获取项目子项目路径</span>
  <span class="token keyword">const</span> projectPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../packages'</span><span class="token punctuation">)</span>

  <span class="token comment">// 读取项目路径下的所有文件/文件夹</span>
  <span class="token keyword">const</span> targets <span class="token operator">=</span> <span class="token keyword">await</span> fsPromises<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span>projectPath<span class="token punctuation">)</span>

  <span class="token comment">// 遍历每个文件/文件夹</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> target <span class="token keyword">of</span> targets<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建解析路径的函数</span>
    <span class="token keyword">const</span> resolve <span class="token operator">=</span> <span class="token function">pathResolve</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    <span class="token comment">// 获取 package.json 的路径</span>
    <span class="token keyword">const</span> packagePath <span class="token operator">=</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'package.json'</span><span class="token punctuation">)</span>
    <span class="token comment">// 向 package.json 文件写入版本号</span>
    <span class="token function">setPackagesVersion</span><span class="token punctuation">(</span>packagePath<span class="token punctuation">,</span> version<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">blue</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">完成版本号更改,当前把版本号为： </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 获取当前版本号并加1
 * @returns 
 */</span>
<span class="token keyword">function</span> <span class="token function">getVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> packagePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../package.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> packageJSON <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span>packagePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> versions <span class="token operator">=</span> packageJSON<span class="token punctuation">.</span>version<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> lastVer <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>versions<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  lastVer <span class="token operator">=</span> <span class="token operator">++</span>lastVer<span class="token punctuation">;</span> <span class="token comment">// 使用前缀形式加1</span>
  versions<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>lastVer<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> versions<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 向 package.json 文件写入版本号
 * @param packagePath 
 * @param version 
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">setPackagesVersion</span><span class="token punctuation">(</span>packagePath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> version<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 读取 package.json 文件内容</span>
  <span class="token keyword">const</span> packageJSON <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span>packagePath<span class="token punctuation">)</span>

  <span class="token comment">// 更新版本号</span>
  packageJSON<span class="token punctuation">.</span>version <span class="token operator">=</span> version
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// 将更新后的 package.json 文件内容写回文件</span>
    <span class="token keyword">await</span> fsPromises<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>packagePath<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>packageJSON<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chalk<span class="token punctuation">.</span><span class="token function">red</span><span class="token punctuation">(</span><span class="token string">'版本号文件写入失败,请检查文件权限'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>


<span class="token function">changeVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br></div></div><ul><li>在项目最外层的 package.json 中加入 script：</li></ul> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string-property property">&quot;changever&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ts-node scripts/changeVersion.ts&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="自动打包"><a href="#自动打包" class="header-anchor">#</a> 自动打包</h2> <p>​        想要自动打包哪些项目，我们可以在项目最外层的 package.json 中去配置：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm run build:elp &amp;&amp; pnpm run build:elu &amp;&amp; pnpm run build:permission &amp;&amp; pnpm run build:micro-app&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;build:elp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm run -C packages/element-plus build&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;build:elu&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm run -C packages/element-ui build&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;build:permission&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm run -C packages/permission build&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;build:micro-app&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm run -C packages/micro-app build&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>​        例如以上配置，执行<code>pnpm run build</code>命令时，就可以直接把 packages 中的 4 项目同时打包。对于组件库项目，打包完我们的项目后，还需要打包文档项目，配置步骤也是同样的，只不过 <code>build</code> 变成了 <code>docs:build</code> 而已。</p> <h2 id="自动上传ftp"><a href="#自动上传ftp" class="header-anchor">#</a> 自动上传FTP</h2> <p>​        打包完成后，我们需要将生成的 dist 文件夹上传到 FTP 上，这个过程我们也可以借助脚本来实现。</p> <h3 id="检查分支"><a href="#检查分支" class="header-anchor">#</a> 检查分支</h3> <p>​       为了确保测试服仅能上传测试分支代码，正式服仅能上传主分支代码，我们需要在上传前先对当前分支进行检查。（在这里，我们假设测试分支是 test，主分支是 main）</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">/**
 * 上传规范:
 * 正式服只能上传 prod 分支代码，测试服只能上传 test 分支代码。
 */</span>
<span class="token keyword">import</span> fs <span class="token keyword">from</span> <span class="token string">'fs'</span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">'path'</span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> utils <span class="token keyword">from</span> <span class="token string">'./utils.ts'</span>

<span class="token comment">// 获取当前 git 分支名称</span>
<span class="token keyword">function</span> <span class="token function">getCurrentBranchName</span><span class="token punctuation">(</span>p <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> gitHeadPath <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>p<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/.git/HEAD</span><span class="token template-punctuation string">`</span></span>

    <span class="token keyword">return</span> fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
        <span class="token operator">?</span> fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>gitHeadPath<span class="token punctuation">)</span>
            <span class="token operator">?</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>gitHeadPath<span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
            <span class="token operator">:</span> <span class="token function">getCurrentBranchName</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * git 分支检查
 * @returns 
 */</span>
<span class="token keyword">function</span> <span class="token function">getCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取当前 git 分支名称</span>
    <span class="token keyword">const</span> currentBranchName <span class="token operator">=</span> <span class="token function">getCurrentBranchName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 上传的服务器环境与 git 分支对应表: key 为上传的服务器环境, value 对应的 git 分支代码</span>
    <span class="token keyword">const</span> envtoGitbranchMap <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string-property property">'test'</span><span class="token operator">:</span> <span class="token string">'test'</span><span class="token punctuation">,</span> 
        <span class="token string-property property">'production'</span><span class="token operator">:</span> <span class="token string">'prod'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>envtoGitbranchMap<span class="token punctuation">[</span>utils<span class="token punctuation">.</span><span class="token function">getNodeEnv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">!==</span> currentBranchName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'💥请检查分支代码!!! 测试服仅能上传 test 分支代码，正式服仅能上传 prod 分支代码！💥'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> getCheck
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h3 id="配置-ftp-相关信息"><a href="#配置-ftp-相关信息" class="header-anchor">#</a> 配置 FTP 相关信息</h3> <h4 id="获取执行脚本的-node-env-值"><a href="#获取执行脚本的-node-env-值" class="header-anchor">#</a> 获取执行脚本的 NODE_ENV 值</h4> <p>​        首先，我们需要一个工具函数，用于获取执行脚本的 <code>NODE_ENV</code> 值，可以将其放在 <code>utils.ts</code> 文件中：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 获取执行脚本的 NODE_ENV值</span>
<span class="token keyword">function</span> <span class="token function">getNodeEnv</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> script <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>npm_lifecycle_script<span class="token punctuation">;</span>
    <span class="token keyword">const</span> reg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&quot;NODE_ENV=([a-z_\\d]+)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> reg<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    getNodeEnv
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="配置用户信息"><a href="#配置用户信息" class="header-anchor">#</a> 配置用户信息</h4> <p>​        我们还需要配置上传 FTP 的账号密码、地址、文件夹等信息，可以将其放在 <code>users.ts</code> 文件中（为了避免信息泄露，记得要将它加入 <code>.gitignore</code> 中 ）：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">'path'</span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> <span class="token punctuation">{</span> fileURLToPath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'url'</span><span class="token punctuation">;</span>  
  
<span class="token keyword">const</span> __filename <span class="token operator">=</span> <span class="token function">fileURLToPath</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">const</span> __dirname <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span><span class="token punctuation">;</span>  
  
<span class="token keyword">const</span> userConfig <span class="token operator">=</span> <span class="token punctuation">{</span>  
    test<span class="token operator">:</span><span class="token punctuation">{</span>
        user<span class="token operator">:</span> <span class="token string">'测试服用户名'</span><span class="token punctuation">,</span>  
        password<span class="token operator">:</span> <span class="token string">'测试服用户密码'</span><span class="token punctuation">,</span>  
        host<span class="token operator">:</span><span class="token string">'测试服服务器地址'</span><span class="token punctuation">,</span>
        port<span class="token operator">:</span><span class="token number">2021</span><span class="token punctuation">,</span> <span class="token comment">// 测试服端口</span>
        localRoot<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist/test'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        remoteRoot<span class="token operator">:</span> <span class="token string">'/test'</span> <span class="token comment">// 测试服文件夹 </span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    production<span class="token operator">:</span><span class="token punctuation">{</span>
        user<span class="token operator">:</span> <span class="token string">'正式服用户名'</span><span class="token punctuation">,</span>  
        password<span class="token operator">:</span> <span class="token string">'正式服用户密码'</span><span class="token punctuation">,</span>  
        host<span class="token operator">:</span><span class="token string">'正式服服务器地址'</span><span class="token punctuation">,</span>
        port<span class="token operator">:</span><span class="token number">2021</span><span class="token punctuation">,</span> <span class="token comment">// 正式服端口</span>
        localRoot<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist/prod'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
        remoteRoot<span class="token operator">:</span> <span class="token string">'/prod'</span> <span class="token comment">// 正式服文件夹   </span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>  
  
<span class="token keyword">export</span> <span class="token keyword">default</span> userConfig<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h4 id="整合"><a href="#整合" class="header-anchor">#</a> 整合</h4> <p>​        有了前面的这些文件后，我们可以整合一下，写在一个 <code>serverConfig.ts</code> 文件中：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">'path'</span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> inquirer <span class="token keyword">from</span> <span class="token string">&quot;inquirer&quot;</span>
<span class="token keyword">import</span> userConfig <span class="token keyword">from</span> <span class="token string">&quot;./users.ts&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fileURLToPath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'url'</span><span class="token punctuation">;</span>  
<span class="token keyword">import</span> utils <span class="token keyword">from</span> <span class="token string">&quot;./utils.ts&quot;</span><span class="token punctuation">;</span>
 
<span class="token keyword">const</span> __filename <span class="token operator">=</span> <span class="token function">fileURLToPath</span><span class="token punctuation">(</span><span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">const</span> __dirname <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">await</span> inquirer
    <span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">'user'</span><span class="token punctuation">,</span>
        message<span class="token operator">:</span> <span class="token string">'请输入用户名,按回车确认：'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">validate</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> val <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token string">&quot;请输入非空字符串&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        type<span class="token operator">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token string">'password'</span><span class="token punctuation">,</span>
        message<span class="token operator">:</span> <span class="token string">'请输入密码,按回车确认：'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">validate</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> val <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token string">&quot;请输入非空字符串&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>answers<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      info<span class="token punctuation">.</span>user <span class="token operator">=</span> answers<span class="token punctuation">.</span>user
      info<span class="token punctuation">.</span>password <span class="token operator">=</span> answers<span class="token punctuation">.</span>password
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> info
<span class="token punctuation">}</span>

<span class="token comment">//获取上传配置信息</span>
<span class="token keyword">const</span> <span class="token function-variable function">getConfig</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">let</span> users <span class="token operator">=</span> <span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    password<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    test<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    production<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    host<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    port<span class="token operator">:</span> <span class="token number">2021</span><span class="token punctuation">,</span>
    localRoot<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'../dist/test'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    remoteRoot<span class="token operator">:</span> <span class="token string">'/test'</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    users <span class="token operator">=</span> userConfig<span class="token punctuation">[</span>utils<span class="token punctuation">.</span><span class="token function">getNodeEnv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'用户信息文件不存在 '</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>users<span class="token punctuation">.</span>user <span class="token operator">||</span> <span class="token operator">!</span>users<span class="token punctuation">.</span>password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      users <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> users<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> getConfig
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><h3 id="入口文件"><a href="#入口文件" class="header-anchor">#</a> 入口文件</h3> <p>​        配置完 FTP 相关信息后，我们就可以写入口文件了，在一个 <code>index.ts</code> 文件中，写入以下内容：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> getFtpDeployConfig <span class="token keyword">from</span> <span class="token string">&quot;./config.ts&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> gitCheck <span class="token keyword">from</span> <span class="token string">&quot;./gitCheck.ts&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> FtpDeploy <span class="token keyword">from</span> <span class="token string">&quot;ftp-deploy&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ftpDeploy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FtpDeploy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/**
 * 上传文件函数
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getFtpDeployConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ftpDeploy
    <span class="token punctuation">.</span><span class="token function">deploy</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'finished:'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">)</span>

  ftpDeploy<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'uploading'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'total file count being transferred: '</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>totalFilesCount<span class="token punctuation">)</span> <span class="token comment">// total file count being transferred</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>transferredFileCount<span class="token punctuation">,</span> <span class="token string">' of files transferred'</span><span class="token punctuation">)</span> <span class="token comment">// number of files transferred</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'partial path with filename being uploaded:'</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>filename<span class="token punctuation">)</span> <span class="token comment">// partial path with filename being uploaded</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  ftpDeploy<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'uploaded'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'uploaded: '</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token comment">// same data as uploading event</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  ftpDeploy<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'upload-error'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'upload error: '</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>err<span class="token punctuation">)</span> <span class="token comment">// data will also include filename, relativePath, and other goodies</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>


<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">gitCheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h3 id="修改-package-json"><a href="#修改-package-json" class="header-anchor">#</a> 修改 package.json</h3> <p>​       完成以上一系列操作后，我们就可以在 <code>package.json</code> 中添加 <code>script</code> 了：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;upload:test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=test node --loader ts-node/esm ./deploy/index.ts&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;upload:prod&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=production node --loader ts-node/esm ./deploy/index.ts&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="集成"><a href="#集成" class="header-anchor">#</a> 集成</h2> <p>​        可以通过一个命令，直接自动更新版本号，然后自动打包，再自动上传 FTP：</p> <div class="language-typescript line-numbers-mode"><pre class="language-typescript"><code>  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;release&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm run changever &amp;&amp; pnpm run build &amp;&amp; pnpm run docs:build &amp;&amp; pnpm run upload:test&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2024/8/20 02:18:47</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/vivien-blog/devops/webpack/webpack执行流程.html" class="prev">
          webpack执行流程
        </a></span> <span class="next"><a href="/vivien-blog/devops/CICD/gitlabCICD.html">
          gitlab CICD
        </a></span></p></div> <div class="comments-wrapper"><!----></div></main></div> <!----></div> <ul class="sub-sidebar sub-sidebar-wrapper" style="width:12rem;" data-v-9f22dc18 data-v-222e0b9d><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/devops/CICD/%E5%8D%8A%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2.html#自动更新版本号" class="sidebar-link reco-side-自动更新版本号" data-v-9f22dc18>自动更新版本号</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/devops/CICD/%E5%8D%8A%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2.html#自动打包" class="sidebar-link reco-side-自动打包" data-v-9f22dc18>自动打包</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/devops/CICD/%E5%8D%8A%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2.html#自动上传ftp" class="sidebar-link reco-side-自动上传ftp" data-v-9f22dc18>自动上传FTP</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/devops/CICD/%E5%8D%8A%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2.html#检查分支" class="sidebar-link reco-side-检查分支" data-v-9f22dc18>检查分支</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/devops/CICD/%E5%8D%8A%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2.html#配置-ftp-相关信息" class="sidebar-link reco-side-配置-ftp-相关信息" data-v-9f22dc18>配置 FTP 相关信息</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/devops/CICD/%E5%8D%8A%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2.html#入口文件" class="sidebar-link reco-side-入口文件" data-v-9f22dc18>入口文件</a></li><li class="level-3" data-v-9f22dc18><a href="/vivien-blog/devops/CICD/%E5%8D%8A%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2.html#修改-package-json" class="sidebar-link reco-side-修改-package-json" data-v-9f22dc18>修改 package.json</a></li><li class="level-2" data-v-9f22dc18><a href="/vivien-blog/devops/CICD/%E5%8D%8A%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2.html#集成" class="sidebar-link reco-side-集成" data-v-9f22dc18>集成</a></li></ul></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-2a01419c data-v-2a01419c><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-2a01419c><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-2a01419c></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-2a01419c></path></svg></div></div></div>
    <script src="/vivien-blog/assets/js/app.6cea8693.js" defer></script><script src="/vivien-blog/assets/js/7.ec60f3e8.js" defer></script><script src="/vivien-blog/assets/js/2.6744b811.js" defer></script><script src="/vivien-blog/assets/js/1.4a3363c7.js" defer></script><script src="/vivien-blog/assets/js/77.7a8e0bfc.js" defer></script>
  </body>
</html>
